<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract spectra associated with chromatographic peaks — chromPeakSpectra • xcms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract spectra associated with chromatographic peaks — chromPeakSpectra"><meta property="og:description" content="Extract (MS1 or MS2) spectra from an XCMSnExp object for each identified
chromatographic peak. The function returns by default spectra for
chromatographic peaks of all MS levels, but parameter peaks allows to
restrict the result to selected chromatographic peaks.
For msLevel = 1L (only supported for return.type = &quot;Spectra&quot; or
return.type = &quot;List&quot;) MS1 spectra within the retention time boundaries
(in the file in which the peak was detected) are returned. For
msLevel = 2L MS2 spectra are returned for a chromatographic
peak if their precursor m/z is within the retention time and m/z range of
the chromatographic peak. Parameter method allows to define whether all
or a single spectrum should be returned:
method = &quot;all&quot;: (default): return all spectra for each peak.
method = &quot;closest_rt&quot;: return the spectrum with the retention time
closest to the peak's retention time (at apex).
method = &quot;closest_mz&quot;: return the spectrum with the precursor m/z
closest to the peaks's m/z (at apex); only supported for msLevel = 2L.
method = &quot;signal&quot;: return the spectrum with the sum of intensities most
similar to the peak's apex signal (&quot;maxo&quot;); only supported for
msLevel = 2L.
method = &quot;largest_tic&quot;: return the spectrum with the largest total
signal (sum of peaks intensities).
method = &quot;largest_bpi&quot;: return the spectrum with the largest peak
intensity (maximal peak intensity).


Parameter return.type allows to specify the type of the result object.
Please use return.type = &quot;Spectra&quot; or return.type = &quot;List&quot;,
return.type = &quot;list&quot; or the default return.type = &quot;MSpectra&quot; will be
deprecated (also, they do not support extracting MS1 spectra).
See also the LC-MS/MS data analysis vignette for more details and examples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.17.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract spectra associated with chromatographic peaks</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-XCMSnExp.R" class="external-link"><code>R/functions-XCMSnExp.R</code></a></small>
    <div class="hidden name"><code>chromPeakSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract (MS1 or MS2) spectra from an <a href="XCMSnExp-class.html">XCMSnExp</a> object for each identified
chromatographic peak. The function returns by default spectra for
chromatographic peaks of <strong>all</strong> MS levels, but parameter <code>peaks</code> allows to
restrict the result to selected chromatographic peaks.
For <code>msLevel = 1L</code> (only supported for <code>return.type = "Spectra"</code> or
<code>return.type = "List"</code>) MS1 spectra within the retention time boundaries
(in the file in which the peak was detected) are returned. For
<code>msLevel = 2L</code> MS2 spectra are returned for a chromatographic
peak if their precursor m/z is within the retention time and m/z range of
the chromatographic peak. Parameter <code>method</code> allows to define whether all
or a single spectrum should be returned:</p><ul><li><p><code>method = "all"</code>: (default): return all spectra for each peak.</p></li>
<li><p><code>method = "closest_rt"</code>: return the spectrum with the retention time
closest to the peak's retention time (at apex).</p></li>
<li><p><code>method = "closest_mz"</code>: return the spectrum with the precursor m/z
closest to the peaks's m/z (at apex); only supported for <code>msLevel = 2L</code>.</p></li>
<li><p><code>method = "signal"</code>: return the spectrum with the sum of intensities most
similar to the peak's apex signal (<code>"maxo"</code>); only supported for
<code>msLevel = 2L</code>.</p></li>
<li><p><code>method = "largest_tic"</code>: return the spectrum with the largest total
signal (sum of peaks intensities).</p></li>
<li><p><code>method = "largest_bpi"</code>: return the spectrum with the largest peak
intensity (maximal peak intensity).</p></li>
</ul><p>Parameter <code>return.type</code> allows to specify the <em>type</em> of the result object.
Please use <code>return.type = "Spectra"</code> or <code>return.type = "List"</code>,
<code>return.type = "list"</code> or the default <code>return.type = "MSpectra"</code> will be
deprecated (also, they do not support extracting MS1 spectra).</p>
<p>See also the <em>LC-MS/MS data analysis</em> vignette for more details and examples.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">chromPeakSpectra</span><span class="op">(</span>
  <span class="va">x</span>,
  msLevel <span class="op">=</span> <span class="fl">2L</span>,
  expandRt <span class="op">=</span> <span class="fl">0</span>,
  expandMz <span class="op">=</span> <span class="fl">0</span>,
  ppm <span class="op">=</span> <span class="fl">0</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"closest_rt"</span>, <span class="st">"closest_mz"</span>, <span class="st">"signal"</span>, <span class="st">"largest_tic"</span>, <span class="st">"largest_bpi"</span><span class="op">)</span>,
  skipFilled <span class="op">=</span> <span class="cn">FALSE</span>,
  return.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSpectra"</span>, <span class="st">"Spectra"</span>, <span class="st">"list"</span>, <span class="st">"List"</span><span class="op">)</span>,
  peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><a href="XCMSnExp-class.html">XCMSnExp</a> object with identified chromatographic peaks.</p></dd>
<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining whether MS1 or MS2 spectra should be
returned. <code>msLevel = 1</code> is currently only supported for <code>return.type</code>
being <code>"Spectra"</code> or <code>"List"</code>.</p></dd>
<dt>expandRt</dt>
<dd><p><code>numeric(1)</code> to expand the retention time range of each
peak by a constant value on each side.</p></dd>
<dt>expandMz</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak by a
constant value on each side.</p></dd>
<dt>ppm</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak (on each side)
by a value dependent on the peak's m/z.</p></dd>
<dt>method</dt>
<dd><p><code>character(1)</code> specifying which spectra to include in the
result. Defaults to <code>method = "all"</code>. See function description for
details.</p></dd>
<dt>skipFilled</dt>
<dd><p><code>logical(1)</code> whether spectra for filled-in peaks should
be reported or not.</p></dd>
<dt>return.type</dt>
<dd><p><code>character(1)</code> defining the result type. Defaults to
<code>return.type = "MSpectra"</code> but <code>return.type = "Spectra"</code> or
<code>return.type = "List"</code> are preferred. See below for more information.</p></dd>
<dt>peaks</dt>
<dd><p><code>character</code>, <code>logical</code> or <code>integer</code> allowing to specify a
subset of chromatographic peaks in <code>chromPeaks</code> for which spectra should
be returned (providing either their ID, a logical vector same length
than <code>nrow(chromPeaks(x))</code> or their index in <code>chromPeaks(x)</code>). This
parameter overrides <code>skipFilled</code> and is only supported for <code>return.type</code>
being either <code>"Spectra"</code> or <code>"List"</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>parameter <code>return.type</code> allow to specify the type of the returned object:</p><ul><li><p><code>return.type = "MSpectra"</code>: a <a href="https://lgatto.github.io/MSnbase/reference/MSpectra.html" class="external-link">MSpectra</a> object with elements being
<a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">Spectrum</a> objects. The result objects contains all spectra
for all peaks. Metadata column <code>"peak_id"</code> provides the ID of the
respective peak (i.e. its rowname in <code><a href="XCMSnExp-class.html">chromPeaks()</a></code>).</p></li>
<li><p><code>return.type = "Spectra"</code>: a <code>Spectra</code> object (defined in the <code>Spectra</code>
package). The result contains all spectra for all peaks. Metadata column
<code>"peak_id"</code> provides the ID of the respective peak (i.e. its rowname in
<code><a href="XCMSnExp-class.html">chromPeaks()</a></code> and <code>"peak_index"</code> its index in the object's <code>chromPeaks</code>
matrix.</p></li>
<li><p><code>return.type = "list"</code>: <code>list</code> of <code>list</code>s that are either of length
0 or contain <a href="https://lgatto.github.io/MSnbase/reference/Spectrum2-class.html" class="external-link">Spectrum2</a> object(s) within the m/z-rt range. The
length of the list matches the number of peaks.</p></li>
<li><p><code>return.type = "List"</code>: <code>List</code> of length equal to the number of
chromatographic peaks is returned with elements being either <code>NULL</code> (no
spectrum found) or a <code>Spectra</code> object.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Johannes Rainer</p>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Read a file with DDA LC-MS/MS data</span></span>
<span class="r-in"><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"TripleTOF-SWATH/PestMix1_DDA.mzML"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span><span class="va">fl</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Subset the object to reduce runtime of the example</span></span>
<span class="r-in"><span class="va">dda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">filterRt</a></span><span class="op">(</span><span class="va">dda</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Perform MS1 peak detection</span></span>
<span class="r-in"><span class="va">dda</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatographic-peak-detection.html">findChromPeaks</a></span><span class="op">(</span><span class="va">dda</span>, <span class="fu"><a href="findChromPeaks-centWave.html">CentWaveParam</a></span><span class="op">(</span>peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting mass traces at 25 ppm ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting chromatographic peaks in 7 regions of interest ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  OK: 8 found.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Load the required Spectra package and return all MS2 spectro for each</span></span>
<span class="r-in"><span class="co">## chromatographic peaks as a Spectra object</span></span>
<span class="r-in"><span class="va">ms2_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, return.type <span class="op">=</span> <span class="st">"Spectra"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ms2_sps</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 25 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1812         2   237.869      1812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1842         2   240.759      1842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1846         2   241.299      1846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2391         2   318.444      2391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2729         2   354.271      2729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...            ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S3119         2   386.669      3119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S3133         2   387.569      3133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S3146         2   388.269      3146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2591         2   342.552      2591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2601         2   343.322      2601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 38 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## columns peak_id or peak_index assign spectra to the chromatographic peaks</span></span>
<span class="r-in"><span class="va">ms2_sps</span><span class="op">$</span><span class="va">peak_id</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CP1" "CP1" "CP1" "CP2" "CP3" "CP3" "CP3" "CP3" "CP4" "CP4" "CP4" "CP6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "CP6" "CP6" "CP6" "CP6" "CP6" "CP7" "CP7" "CP7" "CP7" "CP7" "CP7" "CP8"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "CP8"</span>
<span class="r-in"><span class="va">ms2_sps</span><span class="op">$</span><span class="va">peak_index</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 2 3 3 3 3 4 4 4 6 6 6 6 6 6 7 7 7 7 7 7 8 8</span>
<span class="r-in"><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">dda</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mz    mzmin    mzmax      rt   rtmin   rtmax        into        intb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP1 219.0961 219.0948 219.0996 240.897 235.892 246.984 15914.63661 15903.28137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP2 219.0947 219.0936 219.0963 319.236 313.164 324.145    78.36274    67.09277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP3 227.9913 227.9908 227.9921 357.929 351.649 365.748  5698.72930  5684.55178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP4 300.0312 300.0296 300.0321 366.158 360.029 373.638 12468.01035 12454.28834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP5 302.0284 302.0273 302.0295 366.158 360.449 373.638  7825.51188  7812.11153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP6 224.0836 224.0831 224.0843 388.587 380.747 395.966  9401.70901  9386.10954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP7 256.1102 256.1098 256.1109 388.167 380.330 395.556  8176.23790  8160.63125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP8 298.2750 298.2739 298.2765 345.590 339.830 353.309 38318.95237 38305.30263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           maxo   sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP1 4877.11621 4876      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP2   19.35541   18      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP3 1459.38428 1458      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP4 3156.89258 3156      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP5 1974.66846 1974      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP6 2268.62915 2268      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP7 1836.12695 1835      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP8 8060.13037 8059      1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Alternatively, return the result as a List of Spectra objects. This list</span></span>
<span class="r-in"><span class="co">## is parallel to chromPeaks hence the mapping between chromatographic peaks</span></span>
<span class="r-in"><span class="co">## and MS2 spectra is easier.</span></span>
<span class="r-in"><span class="va">ms2_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, return.type <span class="op">=</span> <span class="st">"List"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ms2_sps</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 3 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1812         2   237.869      1812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1842         2   240.759      1842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1846         2   241.299      1846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 38 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-in"><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ms2_sps</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## In addition to MS2 spectra we could also return the MS1 spectrum for each</span></span>
<span class="r-in"><span class="co">## chromatographic peak which is closest to the peak's apex position.</span></span>
<span class="r-in"><span class="va">ms1_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, method <span class="op">=</span> <span class="st">"closest_rt"</span>,</span>
<span class="r-in">    return.type <span class="op">=</span> <span class="st">"Spectra"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ms1_sps</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 8 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S1843         1   240.897      1843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2396         1   319.236      2396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2804         1   357.929      2804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2920         1   366.158      2920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2920         1   366.158      2920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S3153         1   388.587      3153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S3144         1   388.167      3144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S2620         1   345.590      2620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 38 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Parameter peaks would allow to extract spectra for specific peaks only</span></span>
<span class="r-in"><span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, method <span class="op">=</span> <span class="st">"closest_rt"</span>, peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring parameter 'peaks' which is only supported for 'return.type = "Spectra"' and 'return.type = "List"'.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>msLevel = 1 is currently not supported forreturn.type = "MSpectra" or return.type = "list".</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSpectra with 0 spectra and 1 metadata column(s):</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

