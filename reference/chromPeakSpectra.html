<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extract (MS1 or MS2) spectra from an XcmsExperiment or XCMSnExp object
for identified chromatographic peaks. To return spectra for selected
chromatographic peaks, their peak ID (i.e., row name in the chromPeaks
matrix) can be provided with parameter peaks.
For msLevel = 1L (only supported for return.type = &quot;Spectra&quot; or
return.type = &quot;List&quot;) MS1 spectra within the retention time boundaries
(in the file in which the peak was detected) are returned. For
msLevel = 2L MS2 spectra are returned for a chromatographic
peak if their precursor m/z is within the retention time and m/z range of
the chromatographic peak. Parameter method allows to define whether all
or a single spectrum should be returned:
method = &quot;all&quot;: (default): return all spectra for each chromatographic
peak.
method = &quot;closest_rt&quot;: return the spectrum with the retention time
closest to the peak's retention time (at apex).
method = &quot;closest_mz&quot;: return the spectrum with the precursor m/z
closest to the peaks's m/z (at apex); only supported for msLevel &amp;gt; 1.
method = &quot;largest_tic&quot;: return the spectrum with the largest total
signal (sum of peaks intensities).
method = &quot;largest_bpi&quot;: return the spectrum with the largest peak
intensity (maximal peak intensity).
method = &quot;signal&quot;: only for object being a XCMSnExp: return the
spectrum with the sum of intensities most similar to the peak's apex
signal (&quot;maxo&quot;); only supported for msLevel = 2L.


Parameter return.type allows to specify the type of the result object.
With return.type = &quot;Spectra&quot; (the default) a Spectra object with all
matching spectra is returned. The spectra variable &quot;peak_id&quot; of the
returned Spectra contains the ID of the chromatographic peak (i.e., the
rowname of the peak in the chromPeaks matrix) for each spectrum.
With return.type = &quot;Spectra&quot; a List of Spectra is returned. The
length of the list is equal to the number of rows of chromPeaks. Each
element of the list contains thus a Spectra with all spectra for one
chromatographic peak (or a Spectra of length 0 if no spectrum was found
for the respective chromatographic peak).
See also the LC-MS/MS data analysis vignette for more details and examples."><title>Extract spectra associated with chromatographic peaks — chromPeakSpectra • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract spectra associated with chromatographic peaks — chromPeakSpectra"><meta property="og:description" content="Extract (MS1 or MS2) spectra from an XcmsExperiment or XCMSnExp object
for identified chromatographic peaks. To return spectra for selected
chromatographic peaks, their peak ID (i.e., row name in the chromPeaks
matrix) can be provided with parameter peaks.
For msLevel = 1L (only supported for return.type = &quot;Spectra&quot; or
return.type = &quot;List&quot;) MS1 spectra within the retention time boundaries
(in the file in which the peak was detected) are returned. For
msLevel = 2L MS2 spectra are returned for a chromatographic
peak if their precursor m/z is within the retention time and m/z range of
the chromatographic peak. Parameter method allows to define whether all
or a single spectrum should be returned:
method = &quot;all&quot;: (default): return all spectra for each chromatographic
peak.
method = &quot;closest_rt&quot;: return the spectrum with the retention time
closest to the peak's retention time (at apex).
method = &quot;closest_mz&quot;: return the spectrum with the precursor m/z
closest to the peaks's m/z (at apex); only supported for msLevel &amp;gt; 1.
method = &quot;largest_tic&quot;: return the spectrum with the largest total
signal (sum of peaks intensities).
method = &quot;largest_bpi&quot;: return the spectrum with the largest peak
intensity (maximal peak intensity).
method = &quot;signal&quot;: only for object being a XCMSnExp: return the
spectrum with the sum of intensities most similar to the peak's apex
signal (&quot;maxo&quot;); only supported for msLevel = 2L.


Parameter return.type allows to specify the type of the result object.
With return.type = &quot;Spectra&quot; (the default) a Spectra object with all
matching spectra is returned. The spectra variable &quot;peak_id&quot; of the
returned Spectra contains the ID of the chromatographic peak (i.e., the
rowname of the peak in the chromPeaks matrix) for each spectrum.
With return.type = &quot;Spectra&quot; a List of Spectra is returned. The
length of the list is equal to the number of rows of chromPeaks. Each
element of the list contains thus a Spectra with all spectra for one
chromatographic peak (or a Spectra of length 0 if no spectrum was found
for the respective chromatographic peak).
See also the LC-MS/MS data analysis vignette for more details and examples."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract spectra associated with chromatographic peaks</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/XcmsExperiment.R" class="external-link"><code>R/XcmsExperiment.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-XCMSnExp.R" class="external-link"><code>R/methods-XCMSnExp.R</code></a></small>
      <div class="d-none name"><code>chromPeakSpectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract (MS1 or MS2) spectra from an <a href="XcmsExperiment.html">XcmsExperiment</a> or <a href="XCMSnExp-class.html">XCMSnExp</a> object
for identified chromatographic peaks. To return spectra for selected
chromatographic peaks, their <em>peak ID</em> (i.e., row name in the <code>chromPeaks</code>
matrix) can be provided with parameter <code>peaks</code>.
For <code>msLevel = 1L</code> (only supported for <code>return.type = "Spectra"</code> or
<code>return.type = "List"</code>) MS1 spectra within the retention time boundaries
(in the file in which the peak was detected) are returned. For
<code>msLevel = 2L</code> MS2 spectra are returned for a chromatographic
peak if their precursor m/z is within the retention time and m/z range of
the chromatographic peak. Parameter <code>method</code> allows to define whether all
or a single spectrum should be returned:</p><ul><li><p><code>method = "all"</code>: (default): return all spectra for each chromatographic
peak.</p></li>
<li><p><code>method = "closest_rt"</code>: return the spectrum with the retention time
closest to the peak's retention time (at apex).</p></li>
<li><p><code>method = "closest_mz"</code>: return the spectrum with the precursor m/z
closest to the peaks's m/z (at apex); only supported for <code>msLevel &gt; 1</code>.</p></li>
<li><p><code>method = "largest_tic"</code>: return the spectrum with the largest total
signal (sum of peaks intensities).</p></li>
<li><p><code>method = "largest_bpi"</code>: return the spectrum with the largest peak
intensity (maximal peak intensity).</p></li>
<li><p><code>method = "signal"</code>: only for <code>object</code> being a <code>XCMSnExp</code>: return the
spectrum with the sum of intensities most similar to the peak's apex
signal (<code>"maxo"</code>); only supported for <code>msLevel = 2L</code>.</p></li>
</ul><p>Parameter <code>return.type</code> allows to specify the <em>type</em> of the result object.
With <code>return.type = "Spectra"</code> (the default) a Spectra object with all
matching spectra is returned. The spectra variable <code>"peak_id"</code> of the
returned <code>Spectra</code> contains the ID of the chromatographic peak (i.e., the
rowname of the peak in the <code>chromPeaks</code> matrix) for each spectrum.
With <code>return.type = "Spectra"</code> a <code>List</code> of <code>Spectra</code> is returned. The
length of the list is equal to the number of rows of <code>chromPeaks</code>. Each
element of the list contains thus a <code>Spectra</code> with all spectra for one
chromatographic peak (or a <code>Spectra</code> of length 0 if no spectrum was found
for the respective chromatographic peak).</p>
<p>See also the <em>LC-MS/MS data analysis</em> vignette for more details and examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XcmsExperiment</span></span>
<span><span class="fu">chromPeakSpectra</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"closest_rt"</span>, <span class="st">"closest_mz"</span>, <span class="st">"largest_tic"</span>, <span class="st">"largest_bpi"</span><span class="op">)</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  expandRt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  expandMz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  skipFilled <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spectra"</span>, <span class="st">"List"</span><span class="op">)</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">chromPeakSpectra</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  expandRt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  expandMz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"closest_rt"</span>, <span class="st">"closest_mz"</span>, <span class="st">"signal"</span>, <span class="st">"largest_tic"</span>, <span class="st">"largest_bpi"</span><span class="op">)</span>,</span>
<span>  skipFilled <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spectra"</span>, <span class="st">"MSpectra"</span>, <span class="st">"List"</span>, <span class="st">"list"</span><span class="op">)</span>,</span>
<span>  peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><a href="XcmsExperiment.html">XcmsExperiment</a> or <a href="XCMSnExp-class.html">XCMSnExp</a> object with identified
chromatographic peaks for which spectra should be returned.</p></dd>


<dt>...</dt>
<dd><p>ignored.</p></dd>


<dt>method</dt>
<dd><p><code>character(1)</code> specifying which spectra to include in the
result. Defaults to <code>method = "all"</code>. See function description for
details.</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level of the spectra that
should be returned.</p></dd>


<dt>expandRt</dt>
<dd><p><code>numeric(1)</code> to expand the retention time range of each
peak by a constant value on each side.</p></dd>


<dt>expandMz</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak by a
constant value on each side.</p></dd>


<dt>ppm</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak (on each side)
by a value dependent on the peak's m/z.</p></dd>


<dt>skipFilled</dt>
<dd><p><code>logical(1)</code> whether spectra for filled-in peaks should
be reported or not.</p></dd>


<dt>peaks</dt>
<dd><p><code>character</code>, <code>logical</code> or <code>integer</code> allowing to specify a
subset of chromatographic peaks in <code>chromPeaks</code> for which spectra should
be returned (providing either their ID, a logical vector same length
than <code>nrow(chromPeaks(x))</code> or their index in <code>chromPeaks(x)</code>). This
parameter overrides <code>skipFilled</code>.</p></dd>


<dt>return.type</dt>
<dd><p><code>character(1)</code> defining the type of result object that
should be returned.</p></dd>


<dt>BPPARAM</dt>
<dd><p>parallel processing setup. Defaults to <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>parameter <code>return.type</code> allow to specify the type of the returned object:</p><ul><li><p><code>return.type = "Spectra"</code> (default): a <code>Spectra</code> object (defined in the
<code>Spectra</code> package). The result contains all spectra for all peaks.
Metadata column <code>"peak_id"</code> provides the ID of the respective peak
(i.e. its rowname in <code><a href="XCMSnExp-class.html">chromPeaks()</a></code>.</p></li>
<li><p><code>return.type = "List"</code>: <code>List</code> of length equal to the number of
chromatographic peaks is returned, each element being a <code>Spectra</code> with
the spectra for one chromatographic peak.</p></li>
</ul><p>For backward compatibility options <code>"MSpectra"</code> and <code>"list"</code> are also
supported but are not suggested.</p><ul><li><p><code>return.type = "MSpectra"</code> (deprecated): a <a href="https://lgatto.github.io/MSnbase/reference/MSpectra.html" class="external-link">MSpectra</a> object with elements being
<a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">Spectrum</a> objects. The result objects contains all spectra
for all peaks. Metadata column <code>"peak_id"</code> provides the ID of the
respective peak (i.e. its rowname in <code><a href="XCMSnExp-class.html">chromPeaks()</a></code>).</p></li>
<li><p><code>return.type = "list"</code>: <code>list</code> of <code>list</code>s that are either of length
0 or contain <a href="https://lgatto.github.io/MSnbase/reference/Spectrum2-class.html" class="external-link">Spectrum2</a> object(s) within the m/z-rt range. The
length of the list matches the number of peaks.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Read a file with DDA LC-MS/MS data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"TripleTOF-SWATH/PestMix1_DDA.mzML"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform MS1 peak detection</span></span></span>
<span class="r-in"><span><span class="va">dda</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span><span class="va">dda</span>, <span class="fu"><a href="findChromPeaks-centWave.html">CentWaveParam</a></span><span class="op">(</span>peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Return all MS2 spectro for each chromatographic peaks as a Spectra object</span></span></span>
<span class="r-in"><span><span class="va">ms2_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ms2_sps</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 93 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           2   237.460      1810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2   237.869      1812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           2   240.759      1842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           2   241.299      1846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           2   318.444      2391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89          2   552.147      4948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90          2   570.506      5077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91          2   574.435      5108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92          2   574.725      5110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93          2   575.255      5115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 34 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Filter: select MS level(s) 2 [Fri Feb 23 22:05:18 2024]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Merge 1 Spectra into one [Fri Feb 23 22:05:18 2024] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## spectra variable *peak_id* contain the row names of the peaks in the</span></span></span>
<span class="r-in"><span><span class="co">## chromPeak matrix and allow thus to map chromatographic peaks to the</span></span></span>
<span class="r-in"><span><span class="co">## returned MS2 spectra</span></span></span>
<span class="r-in"><span><span class="va">ms2_sps</span><span class="op">$</span><span class="va">peak_id</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CP01" "CP01" "CP01" "CP01" "CP02" "CP03" "CP03" "CP03" "CP03" "CP04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "CP04" "CP04" "CP04" "CP06" "CP06" "CP06" "CP06" "CP06" "CP06" "CP07"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "CP07" "CP07" "CP07" "CP07" "CP07" "CP07" "CP08" "CP08" "CP09" "CP09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "CP10" "CP10" "CP11" "CP11" "CP11" "CP11" "CP11" "CP12" "CP12" "CP12"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "CP12" "CP12" "CP12" "CP13" "CP13" "CP13" "CP13" "CP13" "CP14" "CP14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] "CP14" "CP15" "CP15" "CP15" "CP15" "CP15" "CP15" "CP17" "CP17" "CP17"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] "CP17" "CP17" "CP18" "CP18" "CP18" "CP18" "CP18" "CP19" "CP19" "CP19"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [71] "CP19" "CP19" "CP19" "CP20" "CP20" "CP20" "CP21" "CP21" "CP21" "CP22"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [81] "CP22" "CP22" "CP23" "CP23" "CP23" "CP23" "CP25" "CP25" "CP25" "CP27"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [91] "CP27" "CP27" "CP27"</span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">dda</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            mz    mzmin    mzmax      rt   rtmin   rtmax        into        intb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP01 219.0961 219.0933 219.0996 240.897 233.595 247.874 15236.49207 15222.54500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP02 219.0947 219.0926 219.0963 319.236 311.979 324.874    76.97947    63.82131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP03 227.9913 227.9902 227.9921 358.349 351.649 367.218  5511.96730  5496.32244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP04 300.0312 300.0289 300.0321 366.568 360.029 375.738 12659.45398 12643.63044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP05 302.0284 302.0273 302.0295 366.568 360.449 375.738  7953.70018  7938.19680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP06 256.1102 256.1095 256.1109 388.167 379.097 397.326  7879.79234  7861.19876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP07 224.0836 224.0831 224.0843 388.587 379.517 397.446  8904.69865  8886.41107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP08 309.9980 309.9962 309.9987 405.715 399.527 415.525  5381.59741  5365.38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP09 378.0356 378.0341 378.0364 405.715 399.527 415.525  5117.90702  5101.66617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP10 298.2751 298.2739 298.2781 345.711 339.830 354.979 39574.83769 39559.51278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP11 308.0012 307.9983 308.0018 405.715 399.527 415.525  5630.65430  5614.25375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP12 376.0385 376.0359 376.0391 405.715 399.527 415.525  5198.61440  5182.23188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP13 292.1216 292.1204 292.1223 410.555 403.625 420.035 15783.11419 15766.32540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP14 289.1217 289.1202 289.1229 425.434 415.525 433.478 10049.05516 10031.22736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP15 304.1141 304.1119 304.1192 424.614 417.985 434.313 14704.14891 14687.51150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP16 384.9700 384.9684 384.9706 440.533 433.893 449.312  8075.24022  8059.47631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP17 382.9727 382.9715 382.9739 440.533 433.478 449.312  8307.76833  8291.81980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP18 231.0144 231.0134 231.0151 450.992 444.342 460.691  5612.28545  5595.90874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP19 306.1659 306.1624 306.1694 463.786 453.922 471.431 31273.95023 31256.40745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP20 205.0970 205.0956 205.0976 459.421 453.092 466.461  5609.65542  5596.09130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP21 230.9875 230.9862 230.9879 495.109 486.210 502.807  8036.59181  8019.64904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP22 216.1414 216.1398 216.1418 508.678 502.680 516.408  4406.91863  4392.98419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP23 330.2065 330.2008 330.2078 422.514 416.754 431.858   614.91821   599.73617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP24 330.2059 330.2036 330.2081 474.408 460.261 479.107   248.31997   229.20853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP25 330.2067 330.2054 330.2077 552.815 541.355 561.837  5890.30116  5869.52232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP26 330.2057 330.2038 330.2076 505.738 495.519 515.868   315.87230   295.17246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP27 373.0416 373.0406 373.0430 576.468 569.174 580.636  6184.87790  6173.40597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            maxo   sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP01 4877.11621 4876      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP02   19.35541   18      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP03 1459.38428 1458      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP04 3156.89258 3156      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP05 1974.66846 1974      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP06 1836.12695 1835      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP07 2268.62915 2268      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP08 1345.32336 1344      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP09 1300.64075 1300      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP10 8060.13037 8059      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP11 1450.15808 1449      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP12 1350.63330 1350      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP13 3203.84229 3203      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP14 2972.63916 2972      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP15 5009.70654 5009      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP16 2224.37622 2223      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP17 2361.33594 2360      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP18 1671.33203 1670      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP19 6300.43652 6299      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP20 1717.72607 1717      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP21 2244.02979 2243      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP22 1576.85681 1576      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP23  135.81871  135      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP24   19.64630   19      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP25 2102.92871 2102      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP26   27.88095   27      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP27 2511.13501 2510      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, return the result as a List of Spectra objects. This list</span></span></span>
<span class="r-in"><span><span class="co">## is parallel to chromPeaks hence the mapping between chromatographic peaks</span></span></span>
<span class="r-in"><span><span class="co">## and MS2 spectra is easier.</span></span></span>
<span class="r-in"><span><span class="va">ms2_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, return.type <span class="op">=</span> <span class="st">"List"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ms2_sps</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CP01" "CP02" "CP03" "CP04" "CP05" "CP06" "CP07" "CP08" "CP09" "CP10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "CP11" "CP12" "CP13" "CP14" "CP15" "CP16" "CP17" "CP18" "CP19" "CP20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "CP21" "CP22" "CP23" "CP24" "CP25" "CP26" "CP27"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">dda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CP01" "CP02" "CP03" "CP04" "CP05" "CP06" "CP07" "CP08" "CP09" "CP10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "CP11" "CP12" "CP13" "CP14" "CP15" "CP16" "CP17" "CP18" "CP19" "CP20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "CP21" "CP22" "CP23" "CP24" "CP25" "CP26" "CP27"</span>
<span class="r-in"><span><span class="va">ms2_sps</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 4 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         2   237.460      1810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2   237.869      1812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         2   240.759      1842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2   241.299      1846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 34 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Filter: select MS level(s) 2 [Fri Feb 23 22:05:18 2024]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Merge 1 Spectra into one [Fri Feb 23 22:05:18 2024] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parameter `msLevel` allows to define from which MS level spectra should</span></span></span>
<span class="r-in"><span><span class="co">## be returned. By default `msLevel = 2L` but with `msLevel = 1L` all</span></span></span>
<span class="r-in"><span><span class="co">## MS1 spectra with a retention time within the retention time range of</span></span></span>
<span class="r-in"><span><span class="co">## a chromatographic peak can be returned. Alternatively, selected</span></span></span>
<span class="r-in"><span><span class="co">## spectra can be returned by specifying the selection criteria/method</span></span></span>
<span class="r-in"><span><span class="co">## with the `method` parameter. Below we extract for each chromatographic</span></span></span>
<span class="r-in"><span><span class="co">## peak the MS1 spectra with a retention time closest to the</span></span></span>
<span class="r-in"><span><span class="co">## chromatographic peak's apex position. Alternatively it would also be</span></span></span>
<span class="r-in"><span><span class="co">## possible to select the spectrum with the highest total signal or</span></span></span>
<span class="r-in"><span><span class="co">## highest (maximal) intensity.</span></span></span>
<span class="r-in"><span><span class="va">ms1_sps</span> <span class="op">&lt;-</span> <span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, method <span class="op">=</span> <span class="st">"closest_rt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ms1_sps</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 27 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1   240.897      1843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1   319.236      2396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1   358.349      2813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1   366.568      2924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1   366.568      2924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23          1   422.514      3571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          1   474.408      4266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25          1   552.815      4958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26          1   505.738      4549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27          1   576.468      5122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 34 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PestMix1_DDA.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Filter: select MS level(s) 1 [Fri Feb 23 22:05:18 2024]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Merge 1 Spectra into one [Fri Feb 23 22:05:18 2024] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parameter peaks would allow to extract spectra for specific peaks only.</span></span></span>
<span class="r-in"><span><span class="co">## Peaks can be defined with parameter `peaks` which can be either an</span></span></span>
<span class="r-in"><span><span class="co">## `integer` with the index of the peak in the `chromPeaks` matrix or a</span></span></span>
<span class="r-in"><span><span class="co">## `character` with its rowname in `chromPeaks`.</span></span></span>
<span class="r-in"><span><span class="fu">chromPeakSpectra</span><span class="op">(</span><span class="va">dda</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, method <span class="op">=</span> <span class="st">"closest_rt"</span>, peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

