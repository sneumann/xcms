<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The XChromatogram object allows to store chromatographic data (e.g.
an extracted ion chromatogram) along with identified chromatographic peaks
within that data. The object inherits all functions from the Chromatogram()
object in the MSnbase package.
Multiple XChromatogram objects can be stored in a XChromatograms object.
This class extends MChromatograms() from the MSnbase package and allows
thus to arrange chromatograms in a matrix-like structure, columns
representing samples and rows m/z-retention time ranges.
All functions are described (grouped into topic-related sections) after the
Arguments section."><title>Containers for chromatographic and peak detection data — XChromatograms • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Containers for chromatographic and peak detection data — XChromatograms"><meta property="og:description" content="The XChromatogram object allows to store chromatographic data (e.g.
an extracted ion chromatogram) along with identified chromatographic peaks
within that data. The object inherits all functions from the Chromatogram()
object in the MSnbase package.
Multiple XChromatogram objects can be stored in a XChromatograms object.
This class extends MChromatograms() from the MSnbase package and allows
thus to arrange chromatograms in a matrix-like structure, columns
representing samples and rows m/z-retention time ranges.
All functions are described (grouped into topic-related sections) after the
Arguments section."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Containers for chromatographic and peak detection data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-XChromatograms.R" class="external-link"><code>R/functions-XChromatograms.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-XChromatogram.R" class="external-link"><code>R/functions-XChromatogram.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-XChromatogram.R" class="external-link"><code>R/methods-XChromatogram.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>XChromatogram.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>XChromatogram</code> object allows to store chromatographic data (e.g.
an extracted ion chromatogram) along with identified chromatographic peaks
within that data. The object inherits all functions from the <code><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram()</a></code>
object in the <code>MSnbase</code> package.</p>
<p>Multiple <code>XChromatogram</code> objects can be stored in a <code>XChromatograms</code> object.
This class extends <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> from the <code>MSnbase</code> package and allows
thus to arrange chromatograms in a matrix-like structure, columns
representing samples and rows m/z-retention time ranges.</p>
<p>All functions are described (grouped into topic-related sections) after the
<strong>Arguments</strong> section.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>XChromatograms(data, phenoData, featureData, chromPeaks, chromPeakData, ...)

XChromatogram(
  rtime = numeric(),
  intensity = numeric(),
  mz = c(NA_real_, NA_real_),
  filterMz = c(NA_real_, NA_real_),
  precursorMz = c(NA_real_, NA_real_),
  productMz = c(NA_real_, NA_real_),
  fromFile = integer(),
  aggregationFun = character(),
  msLevel = 1L,
  chromPeaks,
  chromPeakData
)

# S4 method for XChromatogram
show(object)

# S4 method for XChromatogram
chromPeaks(
  object,
  rt = numeric(),
  mz = numeric(),
  ppm = 0,
  type = c("any", "within", "apex_within"),
  msLevel
)

# S4 method for XChromatogram
chromPeaks(object) &lt;- value

# S4 method for XChromatogram,ANY
plot(
  x,
  col = "#00000060",
  lty = 1,
  type = "l",
  xlab = "retention time",
  ylab = "intensity",
  main = NULL,
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  ...
)

# S4 method for XChromatogram
filterMz(object, mz, ...)

# S4 method for XChromatogram
filterRt(object, rt, ...)

# S4 method for XChromatogram
hasChromPeaks(object)

# S4 method for XChromatogram
dropFilledChromPeaks(object)

# S4 method for XChromatogram
chromPeakData(object)

# S4 method for XChromatogram
chromPeakData(object) &lt;- value

# S4 method for XChromatogram,MergeNeighboringPeaksParam
refineChromPeaks(object, param = MergeNeighboringPeaksParam())

# S4 method for XChromatogram
filterChromPeaks(object, method = c("keepTop"), ...)

# S4 method for XChromatogram
transformIntensity(object, FUN = identity)

# S4 method for XChromatograms
show(object)

# S4 method for XChromatograms
hasChromPeaks(object)

# S4 method for XChromatograms
hasFilledChromPeaks(object)

# S4 method for XChromatograms
chromPeaks(
  object,
  rt = numeric(),
  mz = numeric(),
  ppm = 0,
  type = c("any", "within", "apex_within"),
  msLevel
)

# S4 method for XChromatograms
chromPeakData(object)

# S4 method for XChromatograms
filterMz(object, mz, ...)

# S4 method for XChromatograms
filterRt(object, rt, ...)

# S4 method for XChromatograms,ANY
plot(
  x,
  col = "#00000060",
  lty = 1,
  type = "l",
  xlab = "retention time",
  ylab = "intensity",
  main = NULL,
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  ...
)

# S4 method for XChromatograms
processHistory(object, fileIndex, type)

# S4 method for XChromatograms
hasFeatures(object, ...)

# S4 method for XChromatograms
dropFeatureDefinitions(object, ...)

# S4 method for XChromatograms,PeakDensityParam
groupChromPeaks(object, param)

# S4 method for XChromatograms
featureDefinitions(
  object,
  mz = numeric(),
  rt = numeric(),
  ppm = 0,
  type = c("any", "within", "apex_within")
)

# S4 method for XChromatograms,ANY,ANY,ANY
[(x, i, j, drop = TRUE)

# S4 method for XChromatograms
featureValues(
  object,
  method = c("medret", "maxint", "sum"),
  value = "into",
  intensity = "into",
  missing = NA,
  ...
)

# S4 method for XChromatograms
plotChromPeakDensity(
  object,
  param,
  col = "#00000060",
  xlab = "retention time",
  main = NULL,
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  simulate = TRUE,
  ...
)

# S4 method for XChromatograms
dropFilledChromPeaks(object)

# S4 method for XChromatograms,MergeNeighboringPeaksParam
refineChromPeaks(object, param = MergeNeighboringPeaksParam())

# S4 method for XChromatograms
filterChromPeaks(object, method = c("keepTop"), ...)

# S4 method for XChromatograms
transformIntensity(object, FUN = identity)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>For <code>XChromatograms</code>: <code>list</code> of <code>Chromatogram</code> or
<code>XChromatogram</code> objects.</p></dd>


<dt>phenoData</dt>
<dd><p>For <code>XChromatograms</code>: either a <code>data.frame</code>,
<code>AnnotatedDataFrame</code> or <code>NAnnotatedDataFrame</code> describing the
phenotypical information of the samples.</p></dd>


<dt>featureData</dt>
<dd><p>For <code>XChromatograms</code>: either a <code>data.frame</code> or
<code>AnnotatedDataFrame</code> with additional information for each row of
chromatograms.</p></dd>


<dt>chromPeaks</dt>
<dd><p>For <code>XChromatogram</code>: <code>matrix</code> with required columns
<code>"rt"</code>, <code>"rtmin"</code>, <code>"rtmax"</code>, <code>"into"</code>, <code>"maxo"</code> and <code>"sn"</code>.
For <code>XChromatograms</code>: <code>list</code>, same length than <code>data</code>, with the
chromatographic peaks for each chromatogram. Each element has to be
a <code>matrix</code>, the ordering has to match the order of the chromatograms
in <code>data</code>.</p></dd>


<dt>chromPeakData</dt>
<dd><p>For <code>XChromatogram</code>: <code>DataFrame</code> with optional
additional annotations for each chromatographic peak. The number of rows
has to match the number of chromatographic peaks.</p></dd>


<dt>...</dt>
<dd><p>For <code>filterChromPeaks</code>: additional parameters defining how to
filter chromatographic peaks. See function description below for details.</p></dd>


<dt>rtime</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric</code> with the retention times
(length has to be equal to the length of <code>intensity</code>).</p></dd>


<dt>intensity</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric</code> with the intensity values
(length has to be equal to the length of <code>rtime</code>).</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>For <span class="st">`</span><span class="at">featureValues</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span> specifying the name</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>of the column <span class="cf">in</span> <span class="st">`</span><span class="at">chromPeaks(object)</span><span class="st">`</span> containing the intensity value</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>of the peak that should be used <span class="cf">for</span> the <span class="st">`</span><span class="at">method = "maxint"</span><span class="st">`</span> conflict</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>resolution if.</span></code></pre><p></p></div></dd>


<dt>mz</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric(2)</code> representing the m/z value
range (min, max) on which the chromatogram was created. This is
supposed to contain the <em>real</em> range of m/z values in contrast
to the <code>filterMz</code> below.
For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>numeric(2)</code> defining the
m/z range for which chromatographic peaks or features should be returned.
For <code>filterMz</code>: <code>numeric(2)</code> defining the m/z range for which
chromatographic peaks should be retained.#'</p></dd>


<dt>filterMz</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric(2)</code> representing the m/z
value range (min, max) that was used to filter the original object
on m/z dimension. If not applicable use <code>filterMz = c(0, 0)</code>.</p></dd>


<dt>precursorMz</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric(2)</code> for SRM/MRM transitions.
Represents the mz of the precursor ion. See details for more information.</p></dd>


<dt>productMz</dt>
<dd><p>For <code>XChromatogram</code>: <code>numeric(2)</code> for SRM/MRM transitions.
Represents the mz of the product. See details for more information.</p></dd>


<dt>fromFile</dt>
<dd><p>For <code>XChromatogram</code>: <code>integer(1)</code> the index of the file
within the <code>OnDiskMSnExp</code> or <code>MSnExp</code> object from which the chromatogram
was extracted.</p></dd>


<dt>aggregationFun</dt>
<dd><p>For <code>XChromatogram</code>: <code>character(1)</code> specifying the
function that was used to aggregate intensity values for the same
retention time across the m/z range.</p></dd>


<dt>msLevel</dt>
<dd><p>For <code>XChromatogram</code>: <code>integer</code> with the MS level from which
the chromatogram was extracted.
For <code>chromPeaks</code> and <code>chromPeakData</code>: extract chromatographic peaks of a
certain MS level.</p></dd>


<dt>object</dt>
<dd><p>An <code>XChromatogram</code> or <code>XChromatograms</code> object.</p></dd>


<dt>rt</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>numeric(2)</code> defining
the retention time range for which chromatographic peaks or features
should be returned.
For <code>filterRt</code>: <code>numeric(2)</code> defining the retention time range to
reduce <code>object</code> to.</p></dd>


<dt>ppm</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>numeric(1)</code> defining
a ppm to expand the provided m/z range.</p></dd>


<dt>type</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>character(1)</code>
defining which peaks or features to return if <code>rt</code> or <code>mz</code> is provided:
<code>"any"</code> (default) return all peaks that are even
partially overlapping with <code>rt</code>, <code>"within"</code> return peaks that are
completely within <code>rt</code> and <code>"apex_within"</code> return peaks which apex
is within <code>rt</code>.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>For <span class="st">`</span><span class="at">plot</span><span class="st">`</span><span class="sc">:</span> what type of plot should be used <span class="cf">for</span> the</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">chromatogram</span> (such as <span class="st">`</span><span class="at">"l"</span><span class="st">`</span> <span class="cf">for</span> lines, <span class="st">`</span><span class="at">"p"</span><span class="st">`</span> <span class="cf">for</span> points etc), see help</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>of [<span class="fu">plot</span>()] <span class="cf">in</span> the <span class="st">`</span><span class="at">graphics</span><span class="st">`</span> package <span class="cf">for</span> more details.</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>For <span class="st">`</span><span class="at">processHistory</span><span class="st">`</span><span class="sc">:</span> restrict returned processing steps to specific</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>types. Use [<span class="fu">processHistoryTypes</span>()] to list all supported values.</span></code></pre><p></p></div></dd>


<dt>value</dt>
<dd><p>For <code>chromPeaks&lt;-</code>: a numeric <code>matrix</code> with required columns
<code>"rt"</code>, <code>"rtmin"</code>, <code>"rtmax"</code>, <code>"into"</code> and <code>"maxo"</code>.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>For <span class="st">`</span><span class="at">featureValues</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span> specifying the name of the column <span class="cf">in</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="st">`</span><span class="at">chromPeaks(object)</span><span class="st">`</span> that should be returned or <span class="st">`</span><span class="at">"index"</span><span class="st">`</span> (default) to</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>return the index of the peak associated with the feature <span class="cf">in</span> each sample.</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>To return the integrated peak area instead of the index use</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="st">`</span><span class="at">value = "into"</span><span class="st">`</span>.</span></code></pre><p></p></div></dd>


<dt>x</dt>
<dd><p>For <code>plot</code>: an <code>XChromatogram</code> or <code>XChromatograms</code> object.</p></dd>


<dt>col</dt>
<dd><p>For <code>plot</code>: the color to be used to draw the chromatogram.</p></dd>


<dt>lty</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: the line type.</p></dd>


<dt>xlab</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: the x axis label.</p></dd>


<dt>ylab</dt>
<dd><p>For <code>plot</code>: the y axis label.</p></dd>


<dt>main</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: an optional title for
the plot.</p></dd>


<dt>peakType</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>:
<code>character(1)</code> defining how (and if) identified chromatographic peak
within the chromatogram should be plotted. Options
are <code>"polygon"</code> (default): draw the peak borders with the <code>peakCol</code> color
and fill the peak area with the <code>peakBg</code> color, <code>"point"</code>: indicate the
peak's apex with a point, <code>"rectangle"</code>: draw a rectangle around the
identified peak and <code>"none"</code>: don't draw peaks.</p></dd>


<dt>peakCol</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: the foreground color
for the peaks. For <code>peakType = "polygon"</code> and <code>peakType = "rectangle"</code>
this is the color for the border. Use <code>NA</code> to not use a foreground
color. This should either be a single color or a vector of colors with
the same length than <code>chromPeaks(x)</code> has rows.</p></dd>


<dt>peakBg</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: the background color
for the peaks. For <code>peakType = "polygon"</code> and <code>peakType = "rectangle"</code>
the peak are or rectangle will be filled with this color. Use <code>NA</code> to
skip. This should be either a single color or a vector of colors with
the same length than <code>chromPeaks(x)</code> has rows.</p></dd>


<dt>peakPch</dt>
<dd><p>For <code>plot</code> and <code>plotChromPeakDensity</code>: the point character
to be used for <code>peakType = "point"</code>. See <code><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot()</a></code> in the <code>graphics</code>
package for more details.</p></dd>


<dt>param</dt>
<dd><p>For <code>groupChromPeaks</code> and <code>plotChromPeakDensity</code>: a
<code><a href="groupChromPeaks.html">PeakDensityParam()</a></code> object with the settings for the <em>peak density</em>
correspondence analysis algorithm.</p></dd>


<dt>method</dt>
<dd><p>For <code>featureValues</code>: <code>character(1)</code> specifying the method to
resolve multi-peak mappings within the sample sample, i.e. to select
the <em>representative</em> peak for a feature for which more than one peak
was assigned in one sample. Options are <code>"medret"</code> (default): select the
peak closest to the median retention time of the feature, <code>"maxint"</code>:
select the peak with the largest signal and <code>"sum"</code>: sum the values
of all peaks (only if <code>value</code> is <code>"into"</code> or <code>"maxo"</code>).
For <code>filterChromPeaks</code>: <code>character(1)</code> defining the method that should
be used to filter chromatographic peaks. See help on <code>filterChromPeaks</code>
below for details.</p></dd>


<dt>FUN</dt>
<dd><p>For <code>transformIntensity</code>: a function to transform the intensity
values of <code>object</code>.</p></dd>


<dt>fileIndex</dt>
<dd><p>For <code>processHistory</code>: optional <code>integer</code> specifying the
index of the files/samples for which the <a href="ProcessHistory-class.html">ProcessHistory</a> objects should
be returned.</p></dd>


<dt>i</dt>
<dd><p>For <code>[</code>: <code>integer</code> with the row indices to subset the
<code>XChromatograms</code> object.</p></dd>


<dt>j</dt>
<dd><p>For <code>[</code>: <code>integer</code> with the column indices to subset the
<code>XChromatograms</code> object.</p></dd>


<dt>drop</dt>
<dd><p>For <code>[</code>: <code>logical(1)</code> whether the dimensionality should be
dropped (if possible). Defaults to <code>drop = TRUE</code>, thus, if length of <code>i</code>
and <code>j</code> is 1 a <code>XChromatogram</code> is returned. Note that <code>drop</code> is ignored
if length of <code>i</code> or <code>j</code> is larger than 1, thus a <code>XChromatograms</code> is
returned.</p></dd>


<dt>missing</dt>
<dd><p>For <code>featureValues</code>: how missing values should be reported.
Allowed values are <code>NA</code> (default), a <code>numeric(1)</code> to replace <code>NA</code>s with
that value or <code>missing = "rowmin_half"</code> to replace <code>NA</code>s with half
of the row's minimal (non-missing) value.</p></dd>


<dt>simulate</dt>
<dd><p>For <code>plotChromPeakDensity</code>: <code>logical(1)</code> whether a
correspondence analysis should be <em>simulated</em> based on the available
data and the provided <code><a href="groupChromPeaks.html">PeakDensityParam()</a></code> <code>param</code> argument. See
section <em>Correspondence analysis</em> for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>See help of the individual functions.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Highlighting the peak area(s) in an <code>XChromatogram</code> or <code>XChromatograms</code>
object (<code>plot</code> with <code>peakType = "polygon"</code>) draws a polygon representing
the displayed chromatogram from the peak's minimal retention time to the
maximal retention time. If the <code>XChromatograms</code> was extracted from an
<code><a href="XCMSnExp-class.html">XCMSnExp()</a></code> object with the <code><a href="chromatogram-method.html">chromatogram()</a></code> function this might not
represent the actual identified peak area if the m/z range that was
used to extract the chromatogram was larger than the peak's m/z.</p>
    </div>
    <div class="section level2">
    <h2 id="creation-of-objects">Creation of objects<a class="anchor" aria-label="anchor" href="#creation-of-objects"></a></h2>
    


<p>Objects can be created with the contructor function <code>XChromatogram</code> and
<code>XChromatograms</code>, respectively. Also, they can be coerced from
<a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a> or <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> objects using
<code>as(object, "XChromatogram")</code> or <code>as(object, "XChromatograms")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="filtering-and-subsetting">Filtering and subsetting<a class="anchor" aria-label="anchor" href="#filtering-and-subsetting"></a></h2>
    


<p>Besides classical subsetting with <code>[</code> specific filter operations on
<code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> and <code>XChromatograms</code> objects are available. See
<code><a href="filter-MChromatograms.html">filterColumnsIntensityAbove()</a></code> for more details.</p>

<ul><li><p><code>[</code> allows to subset a <code>XChromatograms</code> object by row (<code>i</code>) and column
(<code>j</code>), with <code>i</code> and <code>j</code> being of type <code>integer</code>. The <code>featureDefinitions</code>
will also be subsetted accordingly and the <code>peakidx</code> column updated.</p></li>
<li><p><code>filterMz</code> filters the chromatographic peaks within an <code>XChromatogram</code> or
<code>XChromatograms</code>, if a column <code>"mz"</code> is present in the <code>chromPeaks</code> matrix.
This would be the case if the <code>XChromatogram</code> was extracted from an
<code><a href="XCMSnExp-class.html">XCMSnExp()</a></code> object with the <code><a href="chromatogram-method.html">chromatogram()</a></code> function. All
chromatographic peaks with their m/z within the m/z range defined by <code>mz</code>
will be retained. Also feature definitions (if present) will be subset
accordingly. The function returns a filtered <code>XChromatogram</code> or
<code>XChromatograms</code> object.</p></li>
<li><p><code>filterRt</code> filters chromatogram(s) by the provided retention time range.
All eventually present chromatographic peaks with their apex within the
retention time range specified with <code>rt</code> will be retained. Also feature
definitions, if present, will be filtered accordingly. The function
returns a filtered <code>XChromatogram</code> or <code>XChromatograms</code> object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="accessing-data">Accessing data<a class="anchor" aria-label="anchor" href="#accessing-data"></a></h2>
    


<p>See also help of <a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a> in the <code>MSnbase</code> package for general
information and data access. The methods listed here are specific for
<code>XChromatogram</code> and <code>XChromatograms</code> objects.</p><ul><li><p><code>chromPeaks</code>, <code>chromPeaks&lt;-</code>: extract or set the matrix with the
chromatographic peak definitions. Parameter <code>rt</code> allows to specify a
retention time range for which peaks should be returned along with
parameter <code>type</code> that defines how <em>overlapping</em> is defined (parameter
description for details). For <code>XChromatogram</code> objects the function returns
a <code>matrix</code> with columns <code>"rt"</code> (retention time of the peak apex),
<code>"rtmin"</code> (the lower peak boundary), <code>"rtmax"</code> (the upper peak boundary),
<code>"into"</code> (the ingegrated peak signal/area of the peak), <code>"maxo"</code> (the
maximum instensity of the peak and <code>"sn"</code> (the signal to noise ratio).
Note that, depending on the peak detection algorithm, the matrix may
contain additional columns.
For <code>XChromatograms</code> objects the <code>matrix</code> contains also columns <code>"row"</code>
and <code>"column"</code> specifying in which chromatogram of <code>object</code> the peak was
identified. Chromatographic peaks are ordered by row.</p></li>
<li><p><code>chromPeakData</code>, <code>chromPeakData&lt;-</code>: extract or set the <code>DataFrame()</code> with
optional chromatographic peak annotations.</p></li>
<li><p><code>hasChromPeaks</code>: infer whether a <code>XChromatogram</code> (or <code>XChromatograms</code>)
has chromatographic peaks. For <code>XChromatogram</code>: returns a <code>logical(1)</code>,
for <code>XChromatograms</code>: returns a <code>matrix</code>, same dimensions than <code>object</code>
with either <code>TRUE</code> or <code>FALSE</code> if chromatographic peaks are available in
the chromatogram at the respective position.</p></li>
<li><p><code>hasFilledChromPeaks</code>: whether a <code>XChromatogram</code> (or a <code>XChromatogram</code> in
a <code>XChromatograms</code>) has filled-in chromatographic peaks.
For <code>XChromatogram</code>: returns a <code>logical(1)</code>,
for <code>XChromatograms</code>: returns a <code>matrix</code>, same dimensions than <code>object</code>
with either <code>TRUE</code> or <code>FALSE</code> if chromatographic peaks are available in
the chromatogram at the respective position.</p></li>
<li><p><code>dropFilledChromPeaks</code>: removes filled-in chromatographic peaks. See
<code><a href="XCMSnExp-class.html">dropFilledChromPeaks()</a></code> help for <code><a href="XCMSnExp-class.html">XCMSnExp()</a></code> objects for more
information.</p></li>
<li><p><code>hasFeatures</code>: for <code>XChromatograms</code> objects only: if correspondence
analysis has been performed and m/z-rt feature definitions are present.
Returns a <code>logical(1)</code>.</p></li>
<li><p><code>dropFeatureDefinitions</code>: for <code>XChrmomatograms</code> objects only: delete any
correspondence analysis results (and related process history).</p></li>
<li><p><code>featureDefinitions</code>: for <code>XChromatograms</code> objects only. Extract the
results from the correspondence analysis (performed with
<code>groupChromPeaks</code>). Returns a <code>DataFrame</code> with the properties of the
defined m/z-rt features: their m/z and retention time range. Columns
<code>peakidx</code> and <code>row</code> contain the index of the chromatographic peaks in the
<code>chromPeaks</code> matrix associated with the feature and the row in the
<code>XChromatograms</code> object in which the feature was defined. Similar to the
<code>chromPeaks</code> method it is possible to filter the returned feature matrix
with the <code>mz</code>, <code>rt</code> and <code>ppm</code> parameters.</p></li>
<li><p><code>featureValues</code>: for <code>XChromatograms</code> objects only. Extract the abundance
estimates for the individuals features. Note that by default (with
parameter <code>value = "index"</code> a <code>matrix</code> of indices of the peaks in the
<code>chromPeaks</code> matrix associated to the feature is returned. To extract the
integrated peak area use <code>value = "into"</code>. The function returns a <code>matrix</code>
with one row per feature (in <code>featureDefinitions</code>) and each column being
a sample (i.e. column of <code>object</code>). For features without a peak associated
in a certain sample <code>NA</code> is returned. This can be changed with the
<code>missing</code> argument of the function.</p></li>
<li><p><code>filterChromPeaks</code>: <em>filters</em> chromatographic peaks in <code>object</code> depending
on parameter <code>method</code> and method-specific parameters passed as additional
arguments with <code>...</code>. Available methods are:</p><ul><li><p><code>method = "keepTop"</code>: keep top <code>n</code> (default <code>n = 1L</code>) peaks in each
chromatogram ordered by column <code>order</code> (defaults to <code>order = "maxo"</code>).
Parameter <code>decreasing</code> (default <code>decreasing = TRUE</code>) can be used to
order peaks in descending (<code>decreasing = TRUE</code>) or ascending (
<code>decreasing = FALSE</code>) order to keep the top <code>n</code> peaks with largest or
smallest values, respectively.</p></li>
</ul></li>
<li><p><code>processHistory</code>: returns a <code>list</code> of <a href="ProcessHistory-class.html">ProcessHistory</a> objects representing
the individual performed processing steps. Optional parameters <code>type</code> and
<code>fileIndex</code> allow to further specify which processing steps to return.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="manipulating-data">Manipulating data<a class="anchor" aria-label="anchor" href="#manipulating-data"></a></h2>
    

<ul><li><p><code>transformIntensity</code>: transforms the intensity values of the chromatograms
with provided function <code>FUN</code>. See <code><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">transformIntensity()</a></code> in the <code>MSnbase</code>
package for details. For <code>XChromatogram</code> and <code>XChromatograms</code> in addition
to the intensity values also columns <code>"into"</code> and <code>"maxo"</code> in the object's
<code>chromPeaks</code> matrix are transformed by the same function.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="plotting-and-visualizing">Plotting and visualizing<a class="anchor" aria-label="anchor" href="#plotting-and-visualizing"></a></h2>
    

<ul><li><p><code>plot</code> draws the chromatogram and highlights in addition any
chromatographic peaks present in the <code>XChromatogram</code> or <code>XChromatograms</code>
(unless <code>peakType = "none"</code> was specified). To draw peaks in different
colors a vector of color definitions with length equal to
<code>nrow(chromPeaks(x))</code> has to be submitted  with <code>peakCol</code> and/or <code>peakBg</code>
defining one color for each peak (in the order as peaks are in
<code>chromPeaks(x))</code>. For base peak chromatograms or total ion chromatograms
it might be better to set <code>peakType = "none"</code> to avoid generating busy
plots.</p></li>
<li><p><code>plotChromPeakDensity</code>: visualize <em>peak density</em>-based correspondence
analysis results. See section <em>Correspondence analysis</em> for more details.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="chromatographic-peak-detection">Chromatographic peak detection<a class="anchor" aria-label="anchor" href="#chromatographic-peak-detection"></a></h2>
    


<p>See <a href="findChromPeaks-Chromatogram-CentWaveParam.html">findChromPeaks-Chromatogram-CentWaveParam</a> for information.</p>
<p>After chromatographic peak detection it is also possible to <em>refine</em>
identified chromatographic peaks with the <code>refineChromPeaks</code> method (e.g. to
reduce peak detection artifacts). Currently, only peak refinement using the
<em>merge neighboring peaks</em> method is available (see
<code><a href="refineChromPeaks.html">MergeNeighboringPeaksParam()</a></code> for a detailed description of the approach.</p>
    </div>
    <div class="section level2">
    <h2 id="correspondence-analysis">Correspondence analysis<a class="anchor" aria-label="anchor" href="#correspondence-analysis"></a></h2>
    


<p>Identified chromatographic peaks in an <code>XChromatograms</code> object can be grouped
into <em>features</em> with the <code>groupChromPeaks</code> function. Currently, such a
correspondence analysis can be performed with the <em>peak density</em> method
(see <a href="groupChromPeaks.html">groupChromPeaks</a> for more details) specifying the algorithm settings
with a <code><a href="groupChromPeaks.html">PeakDensityParam()</a></code> object. A correspondence analysis is performed
separately for each row in the <code>XChromatograms</code> object grouping
chromatographic peaks across samples (columns).</p>
<p>The analysis results are stored in the returned <code>XChromatograms</code> object
and can be accessed with the <code>featureDefinitions</code> method which returns a
<code>DataFrame</code> with one row for each feature. Column <code>"row"</code> specifies in
which row of the <code>XChromatograms</code> object the feature was identified.</p>
<p>The <code>plotChromPeakDensity</code> method can be used to visualize <em>peak density</em>
correspondence results, or to <em>simulate</em> a peak density correspondence
analysis on chromatographic data. The resulting plot consists of two panels,
the upper panel showing the chromatographic data as well as the identified
chromatographic peaks, the lower panel the distribution of peaks (the peak
density) along the retention time axis. This plot shows each peak as a point
with it's peak's retention time on the x-axis, and the sample in which it
was found on the y-axis. The distribution of peaks along the retention time
axis is visualized with a density estimate. Grouped chromatographic peaks
are indicated with grey shaded rectangles. Parameter <code>simulate</code> allows to
define whether the correspondence analysis should be simulated (
<code>simulate=TRUE</code>, based on the available data and the provided
<code><a href="groupChromPeaks.html">PeakDensityParam()</a></code> parameter class) or not (<code>simulate=FALSE</code>). For the
latter it is assumed that a correspondence analysis has been performed with
the <em>peak density</em> method on the <code>object</code>.
See examples below.</p>
<p>Abundance estimates for each feature can be extracted with the
<code>featureValues</code> function using parameter <code>value = "into"</code> to extract the
integrated peak area for each feature. The result is a <code>matrix</code>, columns
being samples and rows features.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="findChromPeaks-Chromatogram-CentWaveParam.html">findChromPeaks-centWave</a> for peak
detection on <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> objects.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ---- Creation of XChromatograms ----</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Create a XChromatograms from Chromatogram objects</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">13</span>, <span class="fl">43</span>, <span class="fl">34</span>, <span class="fl">23</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an XChromatograms without peak data</span></span></span>
<span class="r-in"><span><span class="va">xchrs</span> <span class="op">&lt;-</span> <span class="fu">XChromatograms</span><span class="op">(</span><span class="va">dta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an XChromatograms with peaks data</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">30</span>, <span class="fl">12</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rtmin"</span>, <span class="st">"rtmax"</span>, <span class="st">"into"</span>, <span class="st">"maxo"</span>, <span class="st">"sn"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchrs</span> <span class="op">&lt;-</span> <span class="fu">XChromatograms</span><span class="op">(</span><span class="va">dta</span>, chromPeaks <span class="op">=</span> <span class="va">pks</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an XChromatograms from XChromatogram objects</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dta</span>, <span class="va">as</span>, <span class="st">"XChromatogram"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">dta</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pks</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xchrs</span> <span class="op">&lt;-</span> <span class="fu">XChromatograms</span><span class="op">(</span><span class="va">dta</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">hasChromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 TRUE FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Loading a test data set with identified chromatographic peaks</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadXcmsData.html">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Subset the dataset to the first and third file.</span></span></span>
<span class="r-in"><span><span class="va">xod_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">filterFile</a></span><span class="op">(</span><span class="va">faahko_sub</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">xod_sub</span>, <span class="st">"MsExperiment"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract chromatograms for a m/z - retention time slice</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">od</span>, mz <span class="op">=</span> <span class="fl">344</span>, rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">3500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 1 row and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   1              2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt; &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    length: 639    length: 639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 2 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 4 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## --------------------------------------------------- ##</span></span></span>
<span class="r-in"><span><span class="co">##       Chromatographic peak detection                ##</span></span></span>
<span class="r-in"><span><span class="co">## --------------------------------------------------- ##</span></span></span>
<span class="r-in"><span><span class="co">## Perform peak detection using CentWave</span></span></span>
<span class="r-in"><span><span class="va">xchrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span><span class="va">chrs</span>, param <span class="op">=</span> <span class="fu"><a href="findChromPeaks-centWave.html">CentWaveParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> XChromatograms with 1 row and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    1               2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;XChromatogram&gt; &lt;XChromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        peaks: 2        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 2 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 4 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Do we have chromatographic peaks?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">hasChromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 TRUE TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Process history</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">processHistory</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak detection </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Mon Feb 19 14:04:37 2024 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The chromatographic peaks, columns "row" and "column" provide information</span></span></span>
<span class="r-in"><span><span class="co">## in which sample the peak was identified.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            rt    rtmin    rtmax      into      intb   maxo sn row column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2589.015 2571.801 2612.490  592297.3  554533.9  27600 14   1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2679.783 2646.919 2709.517 5210015.9 5071346.6 152320 30   1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 2682.914 2643.790 2731.427 5255689.5 4983388.9 125632 28   1      2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Spectifically extract chromatographic peaks for one sample/chromatogram</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            rt   rtmin    rtmax    into    intb   maxo sn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2682.914 2643.79 2731.427 5255689 4983389 125632 28</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the results using a different color for each sample</span></span></span>
<span class="r-in"><span><span class="va">sample_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">sample_colors</span><span class="op">[</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span><span class="op">)</span><span class="op">[</span>, <span class="st">"column"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchrs</span>, col <span class="op">=</span> <span class="va">sample_colors</span>, peakBg <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Indicate the peaks with a rectangle</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchrs</span>, col <span class="op">=</span> <span class="va">sample_colors</span>, peakCol <span class="op">=</span> <span class="va">cols</span>, peakType <span class="op">=</span> <span class="st">"rectangle"</span>,</span></span>
<span class="r-in"><span>    peakBg <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## --------------------------------------------------- ##</span></span></span>
<span class="r-in"><span><span class="co">##       Correspondence analysis                       ##</span></span></span>
<span class="r-in"><span><span class="co">## --------------------------------------------------- ##</span></span></span>
<span class="r-in"><span><span class="co">## Group chromatographic peaks across samples</span></span></span>
<span class="r-in"><span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">PeakDensityParam</a></span><span class="op">(</span>sampleGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">xchrs</span>, param <span class="op">=</span> <span class="va">prm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">hasFeatures</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 10 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT1        NA        NA        NA   2681.35   2679.78   2682.91         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT2        NA        NA        NA   2589.01   2589.01   2589.01         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            X1 peakidx       row</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;numeric&gt;  &lt;list&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT1         2     2,3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT2         1       1         1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the correspondence results. Use simulate = FALSE to show the</span></span></span>
<span class="r-in"><span><span class="co">## actual results. Grouped chromatographic peaks are indicated with</span></span></span>
<span class="r-in"><span><span class="co">## grey shaded rectangles.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotChromPeakDensity.html">plotChromPeakDensity</a></span><span class="op">(</span><span class="va">res</span>, simulate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate a correspondence analysis based on different settings. Larger</span></span></span>
<span class="r-in"><span><span class="co">## bw will increase the smoothing of the density estimate hence grouping</span></span></span>
<span class="r-in"><span><span class="co">## chromatographic peaks that are more apart on the retention time axis.</span></span></span>
<span class="r-in"><span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">PeakDensityParam</a></span><span class="op">(</span>sampleGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, bw <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotChromPeakDensity.html">plotChromPeakDensity</a></span><span class="op">(</span><span class="va">res</span>, param <span class="op">=</span> <span class="va">prm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Delete the identified feature definitions</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="XCMSnExp-class.html">dropFeatureDefinitions</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">hasFeatures</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a XChromatogram object</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pks</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rtmin"</span>, <span class="st">"rtmax"</span>, <span class="st">"into"</span>, <span class="st">"maxo"</span>, <span class="st">"sn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[</span>, <span class="st">"rtmin"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[</span>, <span class="st">"rtmax"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">9</span></span></span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[</span>, <span class="st">"rt"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[</span>, <span class="st">"maxo"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">19</span></span></span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[</span>, <span class="st">"into"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">93</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xchr</span> <span class="op">&lt;-</span> <span class="fu">XChromatogram</span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">18</span>, <span class="fl">12</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chromPeaks <span class="op">=</span> <span class="va">pks</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class: XChromatogram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> length of object: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from file: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mz range: [NA, NA]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rt range: [1, 10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MS level: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identified chromatographic peaks (1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rt	rtmin	rtmax	into	maxo	sn </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4	2	9	93	19	NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add arbitrary peak annotations</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span>peak_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchr</span> <span class="op">&lt;-</span> <span class="fu">XChromatogram</span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">18</span>, <span class="fl">12</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chromPeaks <span class="op">=</span> <span class="va">pks</span>, chromPeakData <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class: XChromatogram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> length of object: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from file: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mz range: [NA, NA]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rt range: [1, 10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MS level: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identified chromatographic peaks (1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rt	rtmin	rtmax	into	maxo	sn </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4	2	9	93	19	NA</span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeakData</a></span><span class="op">(</span><span class="va">xchr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 1 row and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       peak_id  ms_level is_filled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;integer&gt; &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           a         1     FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the chromatographic peaks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rt rtmin rtmax into maxo sn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4     2     9   93   19 NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plotting of a single XChromatogram object</span></span></span>
<span class="r-in"><span><span class="co">## o Don't highlight chromatographic peaks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchr</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## o Indicate peaks with a polygon</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchr</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add a second peak to the data.</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="cn">NA</span>, <span class="fl">15</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xchr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pks</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the peaks in different colors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchr</span>, peakCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000080"</span>, <span class="st">"#0000ff80"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    peakBg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000020"</span>, <span class="st">"#0000ff20"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Indicate the peaks as rectangles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchr</span>, peakCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000060"</span>, <span class="st">"#0000ff60"</span><span class="op">)</span>, peakBg <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    peakType <span class="op">=</span> <span class="st">"rectangle"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Filter the XChromatogram by retention time</span></span></span>
<span class="r-in"><span><span class="va">xchr_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterRt</a></span><span class="op">(</span><span class="va">xchr</span>, rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xchr_sub</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class: XChromatogram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> length of object: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from file: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mz range: [NA, NA]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rt range: [4, 6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MS level: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identified chromatographic peaks (1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rt	rtmin	rtmax	into	maxo	sn </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4	2	9	93	19	NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xchr_sub</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XChromatogram-8.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

