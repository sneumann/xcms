<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='These functions allow to filter (subset) MChromatograms() or
XChromatograms() objects, i.e. sets of chromatographic data, without
changing the data (intensity and retention times) within the individual
chromatograms (Chromatogram() objects).
filterColumnsIntensityAbove: subsets a MChromatograms objects keeping
only columns (samples) for which value is larger than the provided
threshold in which rows (i.e. if which = "any" a
column is kept if any of the chromatograms in that column have a
value larger than threshold or with which = "all" all
chromatograms in that column fulfill this criteria). Parameter value
allows to define on which value the comparison should be performed, with
value = "bpi" the maximum intensity of each chromatogram is compared to
threshold, with value = "tic" the total sum of intensities of each chromatogram is compared to threshold. For XChromatogramsobject,value = "maxo"andvalue = "into"are supported which compares the largest intensity of all identified chromatographic peaks in the chromatogram withthreshold`, or the integrated peak area, respectively.
filterColumnsKeepTop: subsets a MChromatograms object keeping the top
n columns sorted by the value specified with sortBy. In detail, for
each column the value defined by sortBy is extracted from each
chromatogram and aggregated using the aggregationFun. Thus, by default,
for each chromatogram the maximum intensity is determined
(sortBy = "bpi") and these values are summed up for chromatograms in the
same column (aggregationFun = sum). The columns are then sorted by these
values and the top n columns are retained in the returned
MChromatograms. Similar to the filterColumnsIntensityAbove function,
this function allows to use for XChromatograms objects to sort the
columns by column sortBy = "maxo" or sortBy = "into" of the
chromPeaks matrix.

'><title>Filtering sets of chromatographic data — filterColumnsIntensityAbove,MChromatograms-method • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filtering sets of chromatographic data — filterColumnsIntensityAbove,MChromatograms-method"><meta property="og:description" content='These functions allow to filter (subset) MChromatograms() or
XChromatograms() objects, i.e. sets of chromatographic data, without
changing the data (intensity and retention times) within the individual
chromatograms (Chromatogram() objects).
filterColumnsIntensityAbove: subsets a MChromatograms objects keeping
only columns (samples) for which value is larger than the provided
threshold in which rows (i.e. if which = "any" a
column is kept if any of the chromatograms in that column have a
value larger than threshold or with which = "all" all
chromatograms in that column fulfill this criteria). Parameter value
allows to define on which value the comparison should be performed, with
value = "bpi" the maximum intensity of each chromatogram is compared to
threshold, with value = "tic" the total sum of intensities of each chromatogram is compared to threshold. For XChromatogramsobject,value = "maxo"andvalue = "into"are supported which compares the largest intensity of all identified chromatographic peaks in the chromatogram withthreshold`, or the integrated peak area, respectively.
filterColumnsKeepTop: subsets a MChromatograms object keeping the top
n columns sorted by the value specified with sortBy. In detail, for
each column the value defined by sortBy is extracted from each
chromatogram and aggregated using the aggregationFun. Thus, by default,
for each chromatogram the maximum intensity is determined
(sortBy = "bpi") and these values are summed up for chromatograms in the
same column (aggregationFun = sum). The columns are then sorted by these
values and the top n columns are retained in the returned
MChromatograms. Similar to the filterColumnsIntensityAbove function,
this function allows to use for XChromatograms objects to sort the
columns by column sortBy = "maxo" or sortBy = "into" of the
chromPeaks matrix.

'><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filtering sets of chromatographic data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-MChromatograms.R" class="external-link"><code>R/methods-MChromatograms.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-XChromatograms.R" class="external-link"><code>R/methods-XChromatograms.R</code></a></small>
      <div class="d-none name"><code>filter-MChromatograms.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions allow to filter (subset) <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> or
<code><a href="XChromatogram.html">XChromatograms()</a></code> objects, i.e. sets of chromatographic data, without
changing the data (intensity and retention times) within the individual
chromatograms (<code><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram()</a></code> objects).</p><ul><li><p><code>filterColumnsIntensityAbove</code>: subsets a <code>MChromatograms</code> objects keeping
only columns (samples) for which <code>value</code> is larger than the provided
<code>threshold</code> in <code>which</code> rows (i.e. if <code>which = "any"</code> a
column is kept if <strong>any</strong> of the chromatograms in that column have a
<code>value</code> larger than <code>threshold</code> or with <code>which = "all"</code> <strong>all</strong>
chromatograms in that column fulfill this criteria). Parameter <code>value</code>
allows to define on which value the comparison should be performed, with
<code>value = "bpi"</code> the maximum intensity of each chromatogram is compared to
<code>threshold</code>, with <code>value = "tic" the total sum of intensities of each chromatogram is compared to </code>threshold<code>. For </code>XChromatograms<code>object,</code>value = "maxo"<code>and</code>value = "into"<code>are supported which compares the largest intensity of all identified chromatographic peaks in the chromatogram with</code>threshold`, or the integrated peak area, respectively.</p></li>
<li><p><code>filterColumnsKeepTop</code>: subsets a <code>MChromatograms</code> object keeping the top
<code>n</code> columns sorted by the value specified with <code>sortBy</code>. In detail, for
each column the value defined by <code>sortBy</code> is extracted from each
chromatogram and aggregated using the <code>aggregationFun</code>. Thus, by default,
for each chromatogram the maximum intensity is determined
(<code>sortBy = "bpi"</code>) and these values are summed up for chromatograms in the
same column (<code>aggregationFun = sum</code>). The columns are then sorted by these
values and the top <code>n</code> columns are retained in the returned
<code>MChromatograms</code>. Similar to the <code>filterColumnsIntensityAbove</code> function,
this function allows to use for <code>XChromatograms</code> objects to sort the
columns by column <code>sortBy = "maxo"</code> or <code>sortBy = "into"</code> of the
<code>chromPeaks</code> matrix.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for MChromatograms</span></span>
<span><span class="fu">filterColumnsIntensityAbove</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bpi"</span>, <span class="st">"tic"</span><span class="op">)</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"any"</span>, <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MChromatograms</span></span>
<span><span class="fu">filterColumnsKeepTop</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  sortBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bpi"</span>, <span class="st">"tic"</span><span class="op">)</span>,</span>
<span>  aggregationFun <span class="op">=</span> <span class="va">sum</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XChromatograms</span></span>
<span><span class="fu">filterColumnsIntensityAbove</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bpi"</span>, <span class="st">"tic"</span>, <span class="st">"maxo"</span>, <span class="st">"into"</span><span class="op">)</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"any"</span>, <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XChromatograms</span></span>
<span><span class="fu">filterColumnsKeepTop</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  sortBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bpi"</span>, <span class="st">"tic"</span>, <span class="st">"maxo"</span>, <span class="st">"into"</span><span class="op">)</span>,</span>
<span>  aggregationFun <span class="op">=</span> <span class="va">sum</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> or <code><a href="XChromatogram.html">XChromatograms()</a></code> object.</p></dd>


<dt>threshold</dt>
<dd><p>for <code>filterColumnsIntensityAbove</code>: <code>numeric(1)</code> with the
threshold value to compare against.</p></dd>


<dt>value</dt>
<dd><p><code>character(1)</code> defining which value should be used in the
comparison or sorting. Can be <code>value = "bpi"</code> (default) to use the
maximum intensity per chromatogram or <code>value = "tic"</code> to use the sum
of intensities per chromatogram. For <code><a href="XChromatogram.html">XChromatograms()</a></code> objects also
<code>value = "maxo"</code> and <code>value = "into"</code> is supported to use the maximum
intensity or the integrated area of identified chromatographic peaks
in each chromatogram.</p></dd>


<dt>which</dt>
<dd><p>for <code>filterColumnsIntensityAbove</code>: <code>character(1)</code> defining
whether <strong>any</strong> (<code>which = "any"</code>, default) or <strong>all</strong> (<code>which = "all"</code>)
chromatograms in a column have to fulfill the criteria for the column
to be kept.</p></dd>


<dt>n</dt>
<dd><p>for <code>filterColumnsKeepTop</code>: <code>integer(1)</code> specifying the number of
columns that should be returned. <code>n</code> will be rounded to the closest
(larger) integer value.</p></dd>


<dt>sortBy</dt>
<dd><p>for <code>filterColumnsKeepTop</code>: the value by which columns should
be ordered to determine the top n columns. Can be either <code>sortBy = "bpi"</code>
(the default), in which case the maximum intensity of each column's
chromatograms is used, or <code>sortBy = "tic"</code> to use the total intensity
sum of all chromatograms. For <code><a href="XChromatogram.html">XChromatograms()</a></code> objects also
<code>value = "maxo"</code> and <code>value = "into"</code> is supported to use the maximum
intensity or the integrated area of identified chromatographic peaks
in each chromatogram.</p></dd>


<dt>aggregationFun</dt>
<dd><p>for <code>filterColumnsKeepTop</code>: function to be used to
aggregate (combine) the values from all chromatograms in each column.
Defaults to <code>aggregationFun = sum</code> in which case the sum of the values
is used to rank the columns. Alternatively the <code>mean</code>, <code>median</code> or
similar function can be used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a filtered <code>MChromatograms</code> (or <code>XChromatograms</code>) object with the
same number of rows (EICs) but eventually a lower number of columns
(samples).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">29</span>, <span class="fl">50</span>, <span class="cn">NA</span>, <span class="fl">100</span>, <span class="fl">12</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">50</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">9</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">53</span>, <span class="fl">80</span>, <span class="fl">130</span>, <span class="fl">15</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">chr1</span>, <span class="va">chr2</span>, <span class="va">chr1</span>, <span class="va">chr3</span>, <span class="va">chr2</span>, <span class="va">chr3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   1              2              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt; &lt;Chromatogram&gt; &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     length: 10     length: 10     length: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     length: 10      length: 7      length: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### filterColumnsIntensityAbove</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Keep all columns with for which the maximum intensity of any of its</span></span></span>
<span class="r-in"><span><span class="co">## chromatograms is larger 90</span></span></span>
<span class="r-in"><span><span class="fu">filterColumnsIntensityAbove</span><span class="op">(</span><span class="va">chrs</span>, threshold <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   1              2              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt; &lt;Chromatogram&gt; &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     length: 10     length: 10     length: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     length: 10      length: 7      length: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Require that ALL chromatograms in a column have a value larger 90</span></span></span>
<span class="r-in"><span><span class="fu">filterColumnsIntensityAbove</span><span class="op">(</span><span class="va">chrs</span>, threshold <span class="op">=</span> <span class="fl">90</span>, which <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     length: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      length: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If none of the columns fulfills the criteria no columns are returned</span></span></span>
<span class="r-in"><span><span class="fu">filterColumnsIntensityAbove</span><span class="op">(</span><span class="va">chrs</span>, threshold <span class="op">=</span> <span class="fl">900</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 0 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Filtering XChromatograms allow in addition to filter on the columns</span></span></span>
<span class="r-in"><span><span class="co">## "maxo" or "into" of the identified chromatographic peaks within each</span></span></span>
<span class="r-in"><span><span class="co">## chromatogram.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### filterColumnsKeepTop</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Keep the 2 columns with the highest sum of maximal intensities in their</span></span></span>
<span class="r-in"><span><span class="co">## chromatograms</span></span></span>
<span class="r-in"><span><span class="fu">filterColumnsKeepTop</span><span class="op">(</span><span class="va">chrs</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     length: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      length: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Keep the 50 percent of columns with the highest total sum of signal. Note</span></span></span>
<span class="r-in"><span><span class="co">## that n will be rounded to the next larger integer value</span></span></span>
<span class="r-in"><span><span class="fu">filterColumnsKeepTop</span><span class="op">(</span><span class="va">chrs</span>, n <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">)</span>, sortBy <span class="op">=</span> <span class="st">"tic"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MChromatograms with 2 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   2              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;Chromatogram&gt; &lt;Chromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     length: 10     length: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      length: 7      length: 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 0 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 0 variables</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

