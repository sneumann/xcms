<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fixes gaps in data due to calibration scans or lock mass. Automatically detects file type
  and calls the relevant method. The mzXML file keeps the data the same length in time but
  overwrites the lock mass scans. The netCDF version adds the scans back into the data thereby
  increasing the length of the data and correcting for the unseen gap."><title>Correct gaps in data — stitch-methods • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correct gaps in data — stitch-methods"><meta property="og:description" content="Fixes gaps in data due to calibration scans or lock mass. Automatically detects file type
  and calls the relevant method. The mzXML file keeps the data the same length in time but
  overwrites the lock mass scans. The netCDF version adds the scans back into the data thereby
  increasing the length of the data and correcting for the unseen gap."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Correct gaps in data</h1>
      
      <div class="d-none name"><code>stitch-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fixes gaps in data due to calibration scans or lock mass. Automatically detects file type
  and calls the relevant method. The mzXML file keeps the data the same length in time but
  overwrites the lock mass scans. The netCDF version adds the scans back into the data thereby
  increasing the length of the data and correcting for the unseen gap.</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    <p></p><dl><dt>object = "xcmsRaw"</dt>
<dd><p><code>
		stitch(object, lockMass=numeric())
		</code></p></dd>

	
</dl><p></p><dl><dt>object = "xcmsRaw"</dt>
<dd><p><code>
	makeacqNum(object, freq=numeric(), start=1)
		</code></p></dd>

	
</dl></div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code><a href="xcmsRaw-class.html">xcmsRaw-class</a></code> object</p></dd>

  <dt>lockMass</dt>
<dd><p>A dataframe of locations of the gaps</p></dd>

  <dt>freq</dt>
<dd><p>The intervals of the lock mass scans</p></dd>

  <dt>start</dt>
<dd><p>The starting lock mass scan location, default is 1</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>makeacqNum</code> takes locates the gap using the starting lock mass scan and it's intervals. This data frame is then used in
	<code>stitch</code> to correct for the gap caused by the lock mass. Correction works by using scans from either side of the gap to fill it in.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>stitch</code> A corrected <code>xcmsRaw-class</code> object</p>
<p></p>
<p><code>makeacqNum</code> A numeric vector of scan locations corresponding to lock Mass scans</p>


    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul Benton, <a href="mailto:hpaul.benton08@imperial.ac.uk">hpaul.benton08@imperial.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## These files do not have this problem to correct for but just</span></span></span>
<span class="r-in"><span>    <span class="co">## for an example</span></span></span>
<span class="r-in"><span>    <span class="va">cdfpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cdffiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">cdfpath</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">xr</span><span class="op">&lt;-</span><span class="fu"><a href="xcmsRaw.html">xcmsRaw</a></span><span class="op">(</span><span class="va">cdffiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Create profile matrix with method 'bin' and step 1 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-in"><span>    <span class="va">xr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An "xcmsRaw" object with 1278 mass spectra</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time range: 2501.4-4499.8 seconds (41.7-75 minutes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mass range: 200-600 m/z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intensity range: 70-1373180 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data on  0  mass(es)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	with  0  MSn spectra</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile method: bin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile step: 1 m/z (401 grid points from 200 to 600 m/z)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Memory usage: 10.8 MB</span>
<span class="r-in"><span>    <span class="co">##Lets assume that the lockmass starts at 1 and is every 100 scans</span></span></span>
<span class="r-in"><span>    <span class="va">lockMass</span><span class="op">&lt;-</span><span class="fu">xcms</span><span class="fu">:::</span><span class="fu">makeacqNum</span><span class="op">(</span><span class="va">xr</span>, freq<span class="op">=</span><span class="fl">100</span>, start<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## these are equcal</span></span></span>
<span class="r-in"><span>    <span class="va">lockmass</span><span class="op">&lt;-</span><span class="fu"><a href="AutoLockMass-methods.html">AutoLockMass</a></span><span class="op">(</span><span class="va">xr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Lock mass frequency wasn't detected</span>
<span class="r-in"><span>    <span class="va">ob</span><span class="op">&lt;-</span><span class="fu">stitch</span><span class="op">(</span><span class="va">xr</span>, <span class="va">lockMass</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ob</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An "xcmsRaw" object with 1304 mass spectra</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time range: 1.6-2040.7 seconds (0-34 minutes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mass range: 200-600 m/z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intensity range: 70-1373180 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data on  0  mass(es)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	with  0  MSn spectra</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile method: bin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile step: no profile data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Memory usage: 6.96 MB</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## plot the old data before correction</span></span></span>
<span class="r-in"><span>    <span class="va">foo</span><span class="op">&lt;-</span><span class="fu"><a href="rawEIC-methods.html">rawEIC</a></span><span class="op">(</span><span class="va">xr</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">210</span><span class="op">)</span>, scan<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">140</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">foo</span><span class="op">$</span><span class="va">scan</span>, <span class="va">foo</span><span class="op">$</span><span class="va">intensity</span>, type<span class="op">=</span><span class="st">"h"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stitch-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## plot the new corrected data to see what changed</span></span></span>
<span class="r-in"><span>    <span class="va">foo</span><span class="op">&lt;-</span><span class="fu"><a href="rawEIC-methods.html">rawEIC</a></span><span class="op">(</span><span class="va">ob</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">210</span><span class="op">)</span>, scan<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">140</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">foo</span><span class="op">$</span><span class="va">scan</span>, <span class="va">foo</span><span class="op">$</span><span class="va">intensity</span>, type<span class="op">=</span><span class="st">"h"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stitch-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

