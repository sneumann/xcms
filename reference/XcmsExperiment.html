<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The XcmsExperiment is a data container for xcms preprocessing results
(i.e. results from chromatographic peak detection, alignment and
correspondence analysis).
It provides the same functionality than the XCMSnExp object, but uses the
more advanced and modern MS infrastructure provided by the MsExperiment
and Spectra Bioconductor packages. With this comes a higher flexibility on
how and where to store the data.
Documentation of the various functions for XcmsExperiment objects are
grouped by topic and provided in the sections below.
The default xcms workflow is to perform
chromatographic peak detection using findChromPeaks()
optionally refine identified chromatographic peaks using
refineChromPeaks()
perform an alignment (retention time adjustment) using adjustRtime().
Depending on the method used this requires to run a correspondence
analysis first
perform a correspondence analysis using the groupChromPeaks() function
to group chromatographic peaks across samples to define the LC-MS
features.
optionally perform a gap-filling to rescue signal in samples in which
no chromatographic peak was identified and hence a missing value would
be reported. This can be performed using the fillChromPeaks() function.

"><title>Next Generation xcms Result Object — filterFeatureDefinitions • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Next Generation xcms Result Object — filterFeatureDefinitions"><meta property="og:description" content="The XcmsExperiment is a data container for xcms preprocessing results
(i.e. results from chromatographic peak detection, alignment and
correspondence analysis).
It provides the same functionality than the XCMSnExp object, but uses the
more advanced and modern MS infrastructure provided by the MsExperiment
and Spectra Bioconductor packages. With this comes a higher flexibility on
how and where to store the data.
Documentation of the various functions for XcmsExperiment objects are
grouped by topic and provided in the sections below.
The default xcms workflow is to perform
chromatographic peak detection using findChromPeaks()
optionally refine identified chromatographic peaks using
refineChromPeaks()
perform an alignment (retention time adjustment) using adjustRtime().
Depending on the method used this requires to run a correspondence
analysis first
perform a correspondence analysis using the groupChromPeaks() function
to group chromatographic peaks across samples to define the LC-MS
features.
optionally perform a gap-filling to rescue signal in samples in which
no chromatographic peak was identified and hence a missing value would
be reported. This can be performed using the fillChromPeaks() function.

"><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Next Generation <code>xcms</code> Result Object</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/MsExperiment.R" class="external-link"><code>R/MsExperiment.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/XcmsExperiment-functions.R" class="external-link"><code>R/XcmsExperiment-functions.R</code></a>, and 3 more</small>
      <div class="d-none name"><code>XcmsExperiment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>XcmsExperiment</code> is a data container for <code>xcms</code> preprocessing results
(i.e. results from chromatographic peak detection, alignment and
correspondence analysis).</p>
<p>It provides the same functionality than the <a href="XCMSnExp-class.html">XCMSnExp</a> object, but uses the
more advanced and modern MS infrastructure provided by the <code>MsExperiment</code>
and <code>Spectra</code> Bioconductor packages. With this comes a higher flexibility on
how and where to store the data.</p>
<p>Documentation of the various functions for <code>XcmsExperiment</code> objects are
grouped by topic and provided in the sections below.</p>
<p>The default <code>xcms</code> workflow is to perform</p><ul><li><p>chromatographic peak detection using <code><a href="findChromPeaks.html">findChromPeaks()</a></code></p></li>
<li><p>optionally refine identified chromatographic peaks using
<code><a href="refineChromPeaks.html">refineChromPeaks()</a></code></p></li>
<li><p>perform an alignment (retention time adjustment) using <code><a href="adjustRtime.html">adjustRtime()</a></code>.
Depending on the method used this requires to run a correspondence
analysis first</p></li>
<li><p>perform a correspondence analysis using the <code><a href="groupChromPeaks.html">groupChromPeaks()</a></code> function
to group chromatographic peaks across samples to define the LC-MS
features.</p></li>
<li><p>optionally perform a gap-filling to <em>rescue</em> signal in samples in which
no chromatographic peak was identified and hence a missing value would
be reported. This can be performed using the <code><a href="fillChromPeaks.html">fillChromPeaks()</a></code> function.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>filterFeatureDefinitions(object, ...)

# S4 method for MsExperiment
filterRt(object, rt = numeric(), ...)

# S4 method for MsExperiment
filterMzRange(object, mz = numeric(), msLevel. = uniqueMsLevels(object))

# S4 method for MsExperiment
filterMz(object, mz = numeric(), msLevel. = uniqueMsLevels(object))

# S4 method for MsExperiment
filterMsLevel(object, msLevel. = uniqueMsLevels(object))

# S4 method for MsExperiment
uniqueMsLevels(object)

# S4 method for MsExperiment
filterFile(object, file = integer(), ...)

# S4 method for MsExperiment
rtime(object)

# S4 method for MsExperiment
fromFile(object)

# S4 method for MsExperiment
fileNames(object)

# S4 method for MsExperiment
polarity(object)

# S4 method for MsExperiment
filterIsolationWindow(object, mz = numeric())

# S4 method for MsExperiment
chromatogram(
  object,
  rt = matrix(nrow = 0, ncol = 2),
  mz = matrix(nrow = 0, ncol = 2),
  aggregationFun = "sum",
  msLevel = 1L,
  isolationWindowTargetMz = NULL,
  chunkSize = 2L,
  return.type = "MChromatograms",
  BPPARAM = bpparam()
)

featureArea(
  object,
  mzmin = min,
  mzmax = max,
  rtmin = min,
  rtmax = max,
  features = character()
)

# S4 method for MsExperiment,missing
plot(x, y, msLevel = 1L, peakCol = "#ff000060", ...)

# S4 method for XcmsExperiment,ANY,ANY,ANY
[(x, i, j, ..., drop = TRUE)

# S4 method for XcmsExperiment
filterIsolationWindow(object, mz = numeric())

# S4 method for XcmsExperiment
filterRt(object, rt, msLevel.)

# S4 method for XcmsExperiment
filterMzRange(object, mz = numeric(), msLevel. = uniqueMsLevels(object))

# S4 method for XcmsExperiment
filterMsLevel(object, msLevel. = uniqueMsLevels(object))

# S4 method for XcmsExperiment
hasChromPeaks(object, msLevel = integer())

# S4 method for XcmsExperiment
dropChromPeaks(object, keepAdjustedRtime = FALSE)

# S4 method for XcmsExperiment
chromPeaks(object) &lt;- value

# S4 method for XcmsExperiment
chromPeaks(
  object,
  rt = numeric(),
  mz = numeric(),
  ppm = 0,
  msLevel = integer(),
  type = c("any", "within", "apex_within"),
  isFilledColumn = FALSE
)

# S4 method for XcmsExperiment
chromPeakData(object) &lt;- value

# S4 method for XcmsExperiment
chromPeakData(
  object,
  msLevel = integer(),
  return.type = c("DataFrame", "data.frame")
)

# S4 method for XcmsExperiment
filterChromPeaks(
  object,
  keep = rep(TRUE, nrow(.chromPeaks(object))),
  method = "keep",
  ...
)

# S4 method for XcmsExperiment
dropAdjustedRtime(object)

# S4 method for MsExperiment
hasAdjustedRtime(object)

# S4 method for XcmsExperiment
rtime(object, adjusted = hasAdjustedRtime(object))

# S4 method for XcmsExperiment
adjustedRtime(object)

# S4 method for XcmsExperiment
hasFeatures(object, msLevel = integer())

# S4 method for XcmsExperiment
featureDefinitions(object) &lt;- value

# S4 method for XcmsExperiment
featureDefinitions(
  object,
  mz = numeric(),
  rt = numeric(),
  ppm = 0,
  type = c("any", "within", "apex_within"),
  msLevel = integer()
)

# S4 method for XcmsExperiment
dropFeatureDefinitions(object, keepAdjustedRtime = FALSE)

# S4 method for XcmsExperiment
filterFeatureDefinitions(object, features = integer())

# S4 method for XcmsExperiment
hasFilledChromPeaks(object)

# S4 method for XcmsExperiment
dropFilledChromPeaks(object)

# S4 method for XcmsExperiment
quantify(object, ...)

# S4 method for XcmsExperiment
featureValues(
  object,
  method = c("medret", "maxint", "sum"),
  value = "into",
  intensity = "into",
  filled = TRUE,
  missing = NA_real_,
  msLevel = integer()
)

# S4 method for XcmsExperiment
chromatogram(
  object,
  rt = matrix(nrow = 0, ncol = 2),
  mz = matrix(nrow = 0, ncol = 2),
  aggregationFun = "sum",
  msLevel = 1L,
  chunkSize = 2L,
  isolationWindowTargetMz = NULL,
  return.type = c("XChromatograms", "MChromatograms"),
  include = character(),
  chromPeaks = c("apex_within", "any", "none"),
  BPPARAM = bpparam()
)

# S4 method for XcmsExperiment
processHistory(object, type)

# S4 method for XcmsExperiment
filterFile(
  object,
  file,
  keepAdjustedRtime = hasAdjustedRtime(object),
  keepFeatures = FALSE,
  ...
)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code>XcmsExperiment</code> object.</p></dd>


<dt>...</dt>
<dd><p>Additional optional parameters. For <code>quantify</code>: any parameter
for the <code>featureValues</code> call used to extract the feature value matrix.</p></dd>


<dt>rt</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>numeric(2)</code> defining
the retention time range for which chromatographic peaks or features
should be returned. The full range is used by default.
For <code>chromatogram</code>: two column numerical <code>matrix</code> with each row
representing the lower and upper retention time window(s) for the
chromatograms. If not provided the full retention time range is used.</p></dd>


<dt>mz</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: <code>numeric(2)</code> optionally
defining the m/z range for which chromatographic peaks or feature
definitions should be returned. The full m/z range is used by default.
For <code>chromatogram</code>: two-column numerical <code>matrix</code> with each row
representing m/z range that should be aggregated into a chromatogram.
If not provided the full m/z range of the data will be used (and hence
a total ion chromatogram will be returned if <code>aggregationFun = "sum"</code>
is used). For <code>filterIsolationWindow</code>: <code>numeric(1)</code> defining the m/z
that should be contained within the spectra's isolation window.</p></dd>


<dt>msLevel.</dt>
<dd><p>For <code>filterRt</code>: ignored. <code>filterRt</code> will always filter
by retention times on all MS levels regardless of this parameter.
For <code>chromatogram</code>: <code>integer</code> with the MS level from which the
chromatogram(s) should be extracted. Has to be either of length 1 or
length equal to the numer of rows of the parameters <code>mz</code> and <code>rt</code>
defining the m/z and rt regions from which the chromatograms should
be created. Defaults to <code>msLevel = 1L</code>.
for <code>filterMsLevel</code>: <code>integer</code> defining the MS level(s) to which the
data should be subset.</p></dd>


<dt>file</dt>
<dd><p>For <code>filterFile</code>: <code>integer</code> with the indices of the samples
(files) to which the data should be subsetted.</p></dd>


<dt>aggregationFun</dt>
<dd><p>For <code>chromatogram</code>: <code>character(1)</code> defining the
function that should be used to <em>aggregate</em> intensities for retention
time (i.e. each spectrum) along the specified m/z range (parameter
<code>mz</code>). Defaults to <code>aggregationFun = "sum"</code> and hence all intensities
will be summed up. Alternatively, use <code>aggregationFun = "max"</code> to use
the maximal intensity per m/z range to create a base peak
chromatogram (BPC).</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer</code> defining the MS level (or multiple MS level if the
function supports it).</p></dd>


<dt>isolationWindowTargetMz</dt>
<dd><p>For <code>chromatogram</code>: <code>numeric</code> (of length
equal to the number of rows of <code>rt</code> and <code>mz</code>) with the isolation window
target m/z of the MS2 spectra from which the chromatgrom should be
generated. For MS1 data (<code>msLevel = 1L</code>, the default), this parameter
is ignored. See examples on <code>chromatogram</code> below for further
information.</p></dd>


<dt>chunkSize</dt>
<dd><p>For <code>chromatogram</code>: <code>integer(1)</code> defining the number of
files from which the data should be loaded at a time into memory.
Defaults to <code>chunkSize = 2L</code>.</p></dd>


<dt>return.type</dt>
<dd><p>For <code>chromPeakData</code>: <code>character(1)</code> defining the
class of the returned object. Can be either <code>"DataFrame"</code> (the default)
or <code>"data.frame"</code>. For <code>chromatogram</code>: <code>character(1)</code> defining the
type of the returned object. Currently only
<code>return.type = "MChromatograms"</code> is supported.</p></dd>


<dt>BPPARAM</dt>
<dd><p>For <code>chromatogram</code>: parallel processing setup. Defaults
to <code>BPPARAM = bpparam()</code>. See <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam()</a></code> for more information.</p></dd>


<dt>mzmin</dt>
<dd><p>For <code>featureArea</code>: function to calculate the <code>"mzmin"</code> of
a feature based on the <code>"mzmin"</code> values of the individual
chromatographic peaks assigned to that feature. Defaults to
<code>mzmin = min</code>.</p></dd>


<dt>mzmax</dt>
<dd><p>For <code>featureArea</code>: function to calculate the <code>"mzmax"</code> of
a feature based on the <code>"mzmax"</code> values of the individual
chromatographic peaks assigned to that feature. Defaults to
<code>mzmax = max</code>.</p></dd>


<dt>rtmin</dt>
<dd><p>For <code>featureArea</code>: function to calculate the <code>"rtmin"</code> of
a feature based on the <code>"rtmin"</code> values of the individual
chromatographic peaks assigned to that feature. Defaults to
<code>rtmin = min</code>.</p></dd>


<dt>rtmax</dt>
<dd><p>For <code>featureArea</code>: function to calculate the <code>"rtmax"</code> of
a feature based on the <code>"rtmax"</code> values of the individual
chromatographic peaks assigned to that feature. Defaults to
<code>rtmax = max</code>.</p></dd>


<dt>features</dt>
<dd><p>For <code>filterFeatureDefinitions</code> and <code>featureArea</code>: <code>logical</code>,
<code>integer</code> or <code>character</code> defining the features to keep or from which
to extract the feature area, respectively. See function description
for more information.</p></dd>


<dt>x</dt>
<dd><p>An <code>XcmsExperiment</code> object.</p></dd>


<dt>y</dt>
<dd><p>For <code>plot</code>: should not be defined as it is not supported.</p></dd>


<dt>peakCol</dt>
<dd><p>For <code>plot</code>: defines the border color of the rectangles
indicating the identified chromatographic peaks. Only a single color
is supported. Defaults to `peakCol = "#ff000060".</p></dd>


<dt>i</dt>
<dd><p>For <code>[</code>: <code>integer</code> or <code>logical</code> defining the samples/files to
subset.</p></dd>


<dt>j</dt>
<dd><p>For <code>[</code>: not supported.</p></dd>


<dt>drop</dt>
<dd><p>For <code>[</code>: ignored.</p></dd>


<dt>keepAdjustedRtime</dt>
<dd><p><code>logical(1)</code>: whether adjusted retention times (if
present) should be retained.</p></dd>


<dt>value</dt>
<dd><p>For <code>featureValues</code>: <code>character(1)</code> defining which value should
be reported for each feature in each sample. Can be any column of the
<code>chromPeaks</code> matrix or <code>"index"</code> if simply the index of the assigned
peak should be returned. Defaults to <code>value = "into"</code> thus the
integrated peak area is reported.</p></dd>


<dt>ppm</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code>: optional <code>numeric(1)</code>
specifying the ppm by which the m/z range (defined by <code>mz</code> should be
extended. For a value of <code>ppm = 10</code>, all peaks within <code>mz[1] - ppm / 1e6</code>
and <code>mz[2] + ppm / 1e6</code> are returned.</p></dd>


<dt>type</dt>
<dd><p>For <code>chromPeaks</code> and <code>featureDefinitions</code> and only if either
<code>mz</code> and <code>rt</code> are defined too: <code>character(1)</code>: defining which peaks
(or features) should be returned. For <code>type = "any"</code>: returns all
chromatographic peaks or features also only partially overlapping any of
the provided ranges. For <code>type = "within"</code>: returns only peaks or
features completely within the region defined by <code>mz</code> and/or <code>rt</code>.
For <code>type = "apex_within"</code>: returns peaks or features for which the m/z
and retention time of the peak's apex is within the region defined by
<code>mz</code> and/or <code>rt</code>.
For <code>processHistory</code>: restrict returned processing steps to specific
types. Use <code><a href="XCMSnExp-class.html">processHistoryTypes()</a></code> to list all supported values.</p></dd>


<dt>isFilledColumn</dt>
<dd><p>For <code>chromPeaks</code>: <code>logical(1)</code> whether a column
<code>"is_filled"</code> should be included in the returned <code>matrix</code> with the
information whether a peak was detected or <em>only</em> filled-in. Note that
this information is also provided in the <code>chromPeakData</code> data frame.</p></dd>


<dt>keep</dt>
<dd><p>For <code>filterChromPeaks</code>: <code>logical</code>, <code>integer</code> or <code>character</code>
specifying which chromatographic peaks to keep. If <code>logical</code> the
length of <code>keep</code> needs to match the number of rows of <code>chromPeaks</code>.
Alternatively, <code>keep</code> allows to specify the <code>index</code> (row) of peaks
to keep or their ID (i.e. row name in <code>chromPeaks</code>).</p></dd>


<dt>method</dt>
<dd><p>For <code>featureValues</code>: <code>character(1)</code> specifying the method to
resolve multi-peak mappings within the same sample (correspondence
analysis can assign more than one chromatographic peak within a sample
to the same feature, e.g. if they are close in retention time). Options:
<code>method = "medret"</code>: report the value for the chromatographic peak
closest to the feature's median retention time.
<code>method = "maxint"</code>: report the value for the chromatographic peak
with the largest signal (parameter <code>intensity</code> allows to select the
column in <code>chromPeaks</code> that should be used for <em>signal</em>).
<code>method = "sum"</code>: sum the value for all chromatographic peaks in a
sample assigned to the same feature. The default is <code>method = "medret"</code>.
For <code>filterChromPeaks</code>: currently only <code>method = "keep"</code> is supported.</p></dd>


<dt>adjusted</dt>
<dd><p>For <code>rtime,XcmsExperiment</code>: whether adjusted or <em>raw</em>
retention times should be returned. The default is to return adjusted
retention times, if available.</p></dd>


<dt>intensity</dt>
<dd><p>For <code>featureValues</code>: <code>character(1)</code> specifying the name
of the column in the <code>chromPeaks(objects)</code> matrix containing the
intensity value of the peak that should be used for the conflict
resolution if <code>method = "maxint"</code>.</p></dd>


<dt>filled</dt>
<dd><p>For <code>featureValues</code>: <code>logical(1)</code> specifying whether values
for filled-in peaks should be reported. For <code>filled = TRUE</code> (the
default) filled peak values are returned, otherwise <code>NA</code> is reported
for the respective features in the samples in which no peak was
detected.</p></dd>


<dt>missing</dt>
<dd><p>For <code>featureValues</code>: default value for missing values.
Allows to define the value that should be reported for a missing peak
intensity. Defaults to <code>missing = NA_real_</code>.</p></dd>


<dt>include</dt>
<dd><p>For <code>chromatogram</code>: deprecated; use parameter <code>chromPeaks</code>
instead.</p></dd>


<dt>chromPeaks</dt>
<dd><p>For <code>chromatogram</code>: <code>character(1)</code> defining which
chromatographic peaks should be returned. Can be either
<code>chromPeaks = "apex_within"</code> (default) to return all chromatographic
peaks with the m/z and RT of their apex within the m/z and retention
time window, <code>chromPeaks = "any"</code> for all chromatographic peaks that
are overlapping with the m/z - retention time window or
<code>chromPeaks = "none"</code> to not include any chromatographic peaks. See
also parameter <code>type</code> below for additional information.</p></dd>


<dt>keepFeatures</dt>
<dd><p>for most subsetting functions (<code>[</code>, <code>filterFile</code>):
<code>logical(1)</code>: wheter eventually present feature definitions should
be retained in the returned (filtered) object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="subsetting-and-filtering">Subsetting and filtering<a class="anchor" aria-label="anchor" href="#subsetting-and-filtering"></a></h2>
    

<ul><li><p><code>[</code>: subset an <code>XcmsExperiment</code> by <strong>sample</strong> (parameter <code>i</code>). Subsetting
will by default drop correspondence results (as subsetting by samples will
obviously affect the feature definition) and alignment results (adjusted
retention times) while identified chromatographic peaks (for the selected
samples) will be retained. Which preprocessing results should be
kept or dropped can also be configured with optional parameters
<code>keepChromPeaks</code> (by default <code>TRUE</code>), <code>keepAdjustedRtime</code> (by default
<code>FALSE</code>) and <code>keepFeatures</code> (by default <code>FALSE</code>).</p></li>
<li><p><code>filterChromPeaks</code>: filter chromatographic peaks of an <code>XcmsExperiment</code>
keeping only those specified with parameter <code>keep</code>. Returns the
<code>XcmsExperiment</code> with the filtered data. Chromatographic peaks to
retain can be specified either by providing their index in the
<code>chromPeaks</code> matrix, their ID (rowname in <code>chromPeaks</code>) or with a
<code>logical</code> vector with the same length than number of rows of
<code>chromPeaks</code>. Assignment of chromatographic peaks are updated to
eventually present feature definitions after filtering.</p></li>
<li><p><code>filterFeatureDefinitions</code>: filter feature definitions of an
<code>XcmsExperiment</code> keeping only those defined with parameter <code>features</code>,
which can be a <code>logical</code> of length equal to the number of features,
an <code>integer</code> with the index of the features in
<code>featureDefinitions(object)</code> to keep or a <code>character</code> with the feature
IDs (i.e. row names in <code>featureDefinitions(object)</code>).</p></li>
<li><p><code>filterFile</code>: filter an <code>XcmsExperiment</code> (or <code>MsExperiment</code>) by <em>file</em>
(sample). The index of the samples to which the data should be subsetted
can be specified with parameter <code>file</code>. The sole purpose of this function
is to provide backward compatibility with the <code>MSnbase</code> package. Wherever
possible, the <code>[</code> function should be used instead for any sample-based
subsetting. Parameters <code>keepChromPeaks</code>, <code>keepAdjustedRtime</code> and
<code>keepChromPeaks</code> can be passed using <code>...</code>.
Note also that in contrast to <code>[</code>, <code>filterFile</code> does not support subsetting
in arbitrary order.</p></li>
<li><p><code>filterIsolationWindow</code>: filter the <strong>spectra</strong> within an <code>MsExperiment</code>
or <code>XcmsExperiment</code> object keeping only those with an isolation window
containing the specified m/z (i.e., keeping spectra with an
<code>"isolationWindowLowerMz"</code> smaller than the user-provided <code>mz</code> and an
<code>"isolationWindowUpperMz"</code> larger than <code>mz</code>). For an <code>XcmsExperiment</code> also
all chromatographic peaks (and subsequently also features) are removed for
which the range of their <code>"isolationWindowLowerMz"</code> and
<code>"isolationWindowUpperMz"</code> (columns in <code>chromPeakData</code>) do not contain
the user provided <code>mz</code>.</p></li>
<li><p><code>filterMsLevel</code>: filter the data of the <code>XcmsExperiment</code> or <code>MsExperiment</code>
to keep only data of the MS level(s) specified with parameter <code>msLevel.</code>.</p></li>
<li><p><code>filterMz</code>, <code>filterMzRange</code>: filter the spectra within an
<code>XcmsExperiment</code> or <code>MsExperiment</code> to the specified m/z range (parameter
<code>mz</code>). For <code>XcmsExperiment</code> also identified chromatographic peaks and
features are filtered keeping only those that are within the specified
m/z range (i.e. for which the m/z of the peak apex is within the m/z
range). Parameter <code>msLevels.</code> allows to restrict the filtering to
only specified MS levels. By default data from all MS levels are
filtered.</p></li>
<li><p><code>filterRt</code>: filter an <code>XcmsExperiment</code> keeping only data within the
specified retention time range (parameter <code>rt</code>). This function will keep
all preprocessing results present within the retention time range: all
identified chromatographic peaks with the retention time of the apex
position within the retention time range <code>rt</code> are retained along, if
present, with the associated features.
Parameter <code>msLevel.</code> is currently ignored, i.e. filtering will always
performed on <strong>all</strong> MS levels of the object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="functionality-related-to-chromatographic-peaks">Functionality related to chromatographic peaks<a class="anchor" aria-label="anchor" href="#functionality-related-to-chromatographic-peaks"></a></h2>
    

<ul><li><p><code>chromatogram</code>: extract chromatographic data from a data set. Parameters
<code>mz</code> and <code>rt</code> allow to define specific m/z - retention time regions to
extract the data from (to e.g. for extracted ion chromatograms EICs).
Both parameters are expected to be numerical two-column matrices with
the first column defining the lower and the second the upper margin.
Each row can define a separate m/z - retention time region. Currently
the function returns a <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> object for <code>object</code> being a
<code>MsExperiment</code> or, for <code>object</code> being an <code>XcmsExperiment</code>, either a
<code>MChromatograms</code> or <code><a href="XChromatogram.html">XChromatograms()</a></code> depending on parameter
<code>return.type</code> (can be either <code>"MChromatograms"</code> or <code>"XChromatograms"</code>).
For the latter also chromatographic peaks detected within the provided
m/z and retention times are returned. Parameter <code>chromPeaks</code> allows
to specify which chromatographic peaks should be reported. See
documentation on the <code>chromPeaks</code> parameter for more information.
If the <code>XcmsExperiment</code> contains correspondence results, also the
associated feature definitions will be included in the returned
<code>XChromatograms</code>. By default the function returns chromatograms from MS1
data, but by setting parameter <code>msLevel = 2L</code> it is possible to e.g.
extract also MS2 chromatograms. For <code>msLevel</code> other than 1 it is in
addition important to also specify the <code>isolationWindowTargetMz</code> for which
MS2 data should be extracted (e.g. for SWATH data MS2 spectra are created
for different m/z isolation windows and the <code>isolationWindowTargetMz</code>
parameter allows to define from which of these the MS2 chromatogram
should be extracted.
Note that in future more efficient data structures for chromatographic
data will be available as well.</p></li>
<li><p><code>chromPeaks</code>: returns a <code>numeric</code> matrix with the identified
chromatographic peaks. Each row represents a chromatographic peak
identified in one sample (file). The number of columns depends on the
peak detection algorithm (see <code><a href="findChromPeaks.html">findChromPeaks()</a></code>) but most methods return
the following columns: <code>"mz"</code> (intensity-weighted mean of the m/z values
of all mass peaks included in the chromatographic peak), <code>"mzmin"</code> (
smallest m/z value of any mass peak in the chromatographic peak), <code>"mzmax"</code>
(largest m/z value of any mass peak in the chromatographic peak), <code>"rt"</code>
(retention time of the peak apex), <code>"rtmin"</code> (retention time of the first
scan/mass peak of the chromatographic peak), <code>"rtmax"</code> (retention time of
the last scan/mass peak of the chromatographic peak), <code>"into"</code> (integrated
intensity of the chromatographic peak), <code>"maxo"</code> (maximal intensity of any
mass peak of the chromatographic peak), <code>"sample"</code> (index of the sample
in <code>object</code> in which the peak was identified). Parameters <code>rt</code>, <code>mz</code>,
<code>ppm</code>, <code>msLevel</code> and <code>type</code> allow to extract subsets of identified
chromatographic peaks from the <code>object</code>. See parameter description below
for details.</p></li>
<li><p><code>chromPeakData</code>: returns a <code>DataFrame</code> with potential additional
<em>annotations</em> for the identified chromatographic peaks. Each row in this
<code>DataFrame</code> corresponds to a row (same index and row name) in the
<code>chromPeaks</code> matrix. The default <em>annotations</em> are <code>"ms_level"</code> (the MS
level in which the peak was identified) and <code>"is_filled"</code> (whether the
chromatographic peak was <em>detected</em> (by <code>findChromPeaks</code>) or <em>filled-in</em>
(by <code>fillChromPeaks</code>).</p></li>
<li><p><code>chromPeakSpectra</code>: extract MS spectra for identified chromatographic
peaks. This can be either all (full scan) MS1 spectra with retention
times between the retention time range of a chromatographic peak, all
MS2 spectra (if present) with a retention time within the retention
time range of a (MS1) chromatographic peak and a precursor m/z within
the m/z range of the chromatographic peak or single, selected spectra
depending on their total signal or highest signal. Parameter <code>msLevel</code>
allows to define from which MS level spectra should be extracted,
parameter <code>method</code> allows to define if all or selected spectra should
be returned. See <code><a href="chromPeakSpectra.html">chromPeakSpectra()</a></code> for details.</p></li>
<li><p><code>dropChromPeaks</code>: removes (all) chromatographic peak detection results
from <code>object</code>. This will also remove any correspondence results (i.e.
features) and eventually present adjusted retention times from the object
if the alignment was performed <strong>after</strong> the peak detection.
Alignment results (adjusted retention times) can be retained if parameter
<code>keepAdjustedRtime</code> is set to <code>TRUE</code>.</p></li>
<li><p><code>dropFilledChromPeaks</code>: removes chromatographic peaks added by gap filling
with <code>fillChromPeaks</code>.</p></li>
<li><p><code>fillChromPeaks</code>: perform <em>gap filling</em> to integrate signal missing
values in samples in which no chromatographic peak was found. This
depends on correspondence results, hence <code>groupChromPeaks</code> needs to be
called first. For details and options see <code><a href="fillChromPeaks.html">fillChromPeaks()</a></code>.</p></li>
<li><p><code>findChromPeaks</code>: perform chromatographic peak detection. See
<code><a href="findChromPeaks.html">findChromPeaks()</a></code> for details.</p></li>
<li><p><code>hasChromPeaks</code>: whether the object contains peak detection results.
Parameter <code>msLevel</code> allows to check whether peak detection results are
available for the specified MS level(s).</p></li>
<li><p><code>hasFilledChromPeaks</code>: whether gap-filling results (i.e., filled-in
chromatographic peaks) are present.</p></li>
<li><p><code>manualChromPeaks</code>: <em>manually</em> add chromatographic peaks by defining
their m/z and retention time ranges. See <code><a href="manualChromPeaks.html">manualChromPeaks()</a></code> for
details and examples.</p></li>
<li><p><code>plotChromPeakImage</code>: show the <em>density</em> of identified chromatographic
peaks per file along the retention time. See <code><a href="plotChromPeaks.html">plotChromPeakImage()</a></code> for
details.</p></li>
<li><p><code>plotChromPeaks</code>: indicate identified chromatographic peaks from one
sample in the RT-m/z space. See <code><a href="plotChromPeaks.html">plotChromPeaks()</a></code> for details.</p></li>
<li><p><code>refineChromPeaks</code>: <em>refines</em> identified chromatographic peaks in <code>object</code>.
See <code><a href="refineChromPeaks.html">refineChromPeaks()</a></code> for details.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="functionality-related-to-alignment">Functionality related to alignment<a class="anchor" aria-label="anchor" href="#functionality-related-to-alignment"></a></h2>
    

<ul><li><p><code>adjustedRtime</code>: extract adjusted retention times. This is just an
alias for <code>rtime(object, adjusted = TRUE)</code>.</p></li>
<li><p><code>adjustRtime</code>: performs retention time adjustment (alignment) of the data.
See <code><a href="adjustRtime.html">adjustRtime()</a></code> for details.</p></li>
<li><p><code>applyAdjustedRtime</code>: replaces the original (raw) retention times with the
adjusted ones. See <code><a href="applyAdjustedRtime.html">applyAdjustedRtime()</a></code> for more information.</p></li>
<li><p><code>dropAdjustedRtime</code>: drops alignment results (adjusted retention time) from
the result object. This also reverts the retention times of identified
chromatographic peaks if present in the result object. Note that any
results from a correspondence analysis (i.e. feature definitions) will be
dropped too (if the correspondence analysis was performed <strong>after</strong> the
alignment). This can be overruled with <code>keepAdjustedRtime = TRUE</code>.</p></li>
<li><p><code>hasAdjustedRtime</code>: whether alignment was performed on the object (i.e.,
the object contains alignment results).</p></li>
<li><p><code>plotAdjustedRtime</code>: plot the alignment results; see <code><a href="plotAdjustedRtime.html">plotAdjustedRtime()</a></code>
for more information.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="functionality-related-to-correspondence-analysis">Functionality related to correspondence analysis<a class="anchor" aria-label="anchor" href="#functionality-related-to-correspondence-analysis"></a></h2>
    

<ul><li><p><code>dropFeatureDefinitions</code>: removes any correspondence analysis results from
<code>object</code> as well as any filled-in chromatographic peaks. By default
(with parameter <code>keepAdjustedRtime = FALSE</code>) also all alignment results
will be removed if alignment was performed <strong>after</strong> the correspondence
analysis. This can be overruled with <code>keepAdjustedRtime = TRUE</code>.</p></li>
<li><p><code>featureArea</code>: returns a <code>matrix</code> with columns <code>"mzmin"</code>, <code>"mzmax"</code>,
<code>"rtmin"</code> and <code>"rtmax"</code> with the m/z and retention time range for each
feature (row) in <code>object</code>. By default these represent the minimal m/z
and retention times as well as maximal m/z and retention times for
all chromatographic peaks assigned to that feature. Parameter
<code>features</code> allows to extract these values for selected features only.
Parameters <code>mzmin</code>, <code>mzmax</code>, <code>rtmin</code> and <code>rtmax</code> allow to define
the function to calculate the reported <code>"mzmin"</code>, <code>"mzmax"</code>, <code>"rtmin"</code>
and <code>"rtmax"</code> values.</p></li>
<li><p><code>featureChromatograms</code>: extract ion chromatograms (EICs) for each
feature in <code>object</code>. See <code><a href="featureChromatograms.html">featureChromatograms()</a></code> for more details.</p></li>
<li><p><code>featureDefinitions</code>: returns a <code>data.frame</code> with feature definitions or
an empty <code>data.frame</code> if no correspondence analysis results are present.
Parameters <code>msLevel</code>, <code>mz</code>, <code>ppm</code> and <code>rt</code> allow to define subsets of
feature definitions that should be returned with the parameter <code>type</code>
defining how these parameters should be used to subset the returned
<code>data.frame</code>. See parameter descriptions for details.</p></li>
<li><p><code>featureSpectra</code>: returns a <code>Spectra()</code> or <code>List</code> of <code>Spectra</code> with
(MS1 or MS2) spectra associated to each feature. See <code><a href="featureSpectra.html">featureSpectra()</a></code>
for more details and available parameters.</p></li>
<li><p><code>featuresSummary</code>: calculate a simple summary on features. See
<code><a href="featureSummary.html">featureSummary()</a></code> for details.</p></li>
<li><p><code>groupChromPeaks</code>: performs the correspondence analysis (i.e., grouping
of chromatographic peaks into LC-MS <em>features</em>). See <code><a href="groupChromPeaks.html">groupChromPeaks()</a></code>
for details.</p></li>
<li><p><code>hasFeatures</code>: whether correspondence analysis results are presentin in
<code>object</code>. The optional parameter <code>msLevel</code> allows to define the  MS
level(s) for which it should be determined if feature definitions are
available.</p></li>
<li><p><code>overlappingFeatures</code>: identify features that overlapping or close in
m/z - rt dimension. See <code><a href="overlappingFeatures.html">overlappingFeatures()</a></code> for more information.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="extracting-data-and-results-from-an-xcmsexperiment">Extracting data and results from an <code>XcmsExperiment</code><a class="anchor" aria-label="anchor" href="#extracting-data-and-results-from-an-xcmsexperiment"></a></h2>
    


<p>Preprocessing results can be extracted using the following functions:</p><ul><li><p><code>chromPeaks</code>: extract identified chromatographic peaks. See section on
chromatographic peak detection for details.</p></li>
<li><p><code>featureDefinitions</code>: extract the definition of <em>features</em> (chromatographic
peaks grouped across samples). See section on correspondence analysis for
details.</p></li>
<li><p><code>featureValues</code>: extract a <code>matrix</code> of <em>values</em> for features from each
sample (file). Rows are features, columns samples. Which <em>value</em> should be
returned can be defined with parameter <code>value</code>, which can be any column of
the <code>chromPeaks</code> matrix. By default (<code>value = "into"</code>) the integrated
chromatographic peak intensities are returned. With parameter <code>msLevel</code> it
is possible to extract values for features from certain MS levels.
During correspondence analysis, more than one chromatographic peak per
sample can be assigned to the same feature (e.g. if they are very close in
retention time). Parameter <code>method</code> allows to define the strategy to deal
with such cases: <code>method = "medret"</code>: report the value from the
chromatographic peak with the apex position closest to the feautre's
median retention time. <code>method = "maxint"</code>: report the value from the
chromatographic peak with the largest signal (parameter <code>intensity</code> allows
to define the column in <code>chromPeaks</code> that should be selected; defaults to
<code>intensity = "into"). </code>method = "sum"`: sum the values for all
chromatographic peaks assigned to the feature in the same sample.</p></li>
<li><p><code>quantify</code>: extract the correspondence analysis results as a
<code>SummarizedExperiment()</code>. The feature <em>values</em> are used as <code>assay</code> in
the returned <code>SummarizedExperiment</code>, <code>rowData</code> contains the
<code>featureDefinitions</code> (without column <code>"peakidx"</code>) and <code>colData</code> the
<code>sampleData</code> of <code>object</code>. Additional parameters to the <code>featureValues</code>
function (that is used to extract the feature value matrix) can be
passed <em>via</em> <code>...</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a></h2>
    

<ul><li><p><code>plot</code>: plot for each file the position of individual peaks in the m/z -
retention time space (with color-coded intensity) and a base peak
chromatogram. This function should ideally be called only on a data subset
(i.e. after using <code>filterRt</code> and <code>filterMz</code> to restrict to a region of
interest). Parameter <code>msLevel</code> allows to define from which MS level the
plot should be created. If <code>x</code> is a <code>XcmsExperiment</code> with available
identified chromatographic peaks, also the region defining the peaks
are indicated with a rectangle. Parameter <code>peakCol</code> allows to define the
color of the border for these rectangles.</p></li>
<li><p><code>plotAdjustedRtime</code>: plot the alignment results; see <code><a href="plotAdjustedRtime.html">plotAdjustedRtime()</a></code>
for more information.</p></li>
<li><p><code>plotChromPeakImage</code>: show the <em>density</em> of identified chromatographic
peaks per file along the retention time. See <code><a href="plotChromPeaks.html">plotChromPeakImage()</a></code> for
details.</p></li>
<li><p><code>plotChromPeaks</code>: indicate identified chromatographic peaks from one
sample in the RT-m/z space. See <code><a href="plotChromPeaks.html">plotChromPeaks()</a></code> for details.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="general-functionality-and-functions-for-backward-compatibility">General functionality and functions for backward compatibility<a class="anchor" aria-label="anchor" href="#general-functionality-and-functions-for-backward-compatibility"></a></h2>
    

<ul><li><p><code>uniqueMsLevels</code>: returns the unique MS levels of the spectra in <code>object</code>.</p></li>
</ul><p>The functions listed below ensure compatibility with the <em>older</em>
<code><a href="XCMSnExp-class.html">XCMSnExp()</a></code> xcms result object.</p><ul><li><p><code>fileNames</code>: returns the original data file names for the spectra data.
Ideally, the <code>dataOrigin</code> or <code>dataStorage</code> spectra variables from the
object's <code>spectra</code> should be used instead.</p></li>
<li><p><code>fromFile</code>: returns the file (sample) index for each spectrum within
<code>object</code>. Generally, subsetting by sample using the <code>[</code> is the preferred
way to get spectra from a specific sample.</p></li>
<li><p><code>polarity</code>: returns the polarity information for each spectrum in
<code>object</code>.</p></li>
<li><p><code>processHistory</code>: returns a <code>list</code> with <a href="ProcessHistory-class.html">ProcessHistory</a> <em>process history</em>
objects that contain also the parameter object used for the different
processings. Optional parameter <code>type</code> allows to query for specific
processing steps.</p></li>
<li><p><code>rtime</code>: extract retention times of the <strong>spectra</strong> from the
<code>MsExperiment</code> or <code>XcmsExperiment</code> object. It is thus a shortcut for
<code>rtime(spectra(object))</code> which would be the preferred way to extract
retention times from an <code>MsExperiment</code>. The <code>rtime</code> method for
<code>XcmsExperiment</code> has an additional parameter <code>adjusted</code> which allows to
define whether adjusted retention times (if present - <code>adjusted = TRUE</code>)
or <em>raw</em> retention times (<code>adjusted = FALSE</code>) should be returned. By
default adjusted retention times are returned if available.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="differences-compared-to-the-xcmsnexp-object">Differences compared to the <code><a href="XCMSnExp-class.html">XCMSnExp()</a></code> object<a class="anchor" aria-label="anchor" href="#differences-compared-to-the-xcmsnexp-object"></a></h2>
    

<ul><li><p>Subsetting by <code>[</code> supports arbitrary ordering.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Creating a MsExperiment object representing the data from an LC-MS</span></span></span>
<span class="r-in"><span><span class="co">## experiment.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Defining the raw data files</span></span></span>
<span class="r-in"><span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cdf/KO/ko15.CDF'</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cdf/KO/ko16.CDF'</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cdf/KO/ko18.CDF'</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Defining a data frame with the sample characterization</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mzML_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fls</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ko15"</span>, <span class="st">"ko16"</span>, <span class="st">"ko18"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Importing the data. This will initialize a `Spectra` object representing</span></span></span>
<span class="r-in"><span><span class="co">## the raw data and assign these to the individual samples.</span></span></span>
<span class="r-in"><span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span>spectraFiles <span class="op">=</span> <span class="va">fls</span>, sampleData <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract a total ion chromatogram and base peak chromatogram</span></span></span>
<span class="r-in"><span><span class="co">## from the data</span></span></span>
<span class="r-in"><span><span class="va">bpc</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">mse</span>, aggregationFun <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot them</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bpc</span>, main <span class="op">=</span> <span class="st">"BPC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tic</span>, main <span class="op">=</span> <span class="st">"TIC"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XcmsExperiment-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extracting MS2 chromatographic data</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## To show how MS2 chromatograms can be extracted we first load a DIA</span></span></span>
<span class="r-in"><span><span class="co">## (SWATH) data set.</span></span></span>
<span class="r-in"><span><span class="va">mse_dia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"TripleTOF-SWATH"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"PestMix1_SWATH.mzML"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extracting MS2 chromatogram requires also to specify the isolation</span></span></span>
<span class="r-in"><span><span class="co">## window from which to extract the data. Without that chromatograms</span></span></span>
<span class="r-in"><span><span class="co">## will be empty:</span></span></span>
<span class="r-in"><span><span class="va">chr_ms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">mse_dia</span>, msLevel <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">chr_ms2</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First we list available isolation windows</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="isolationWindowTargetMz-OnDiskMSnExp-method.html">isolationWindowTargetMz</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectra</a></span><span class="op">(</span><span class="va">mse_dia</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163.75 208.95 244.05 270.85  299.1  329.8 367.35 601.85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1000   1000   1000   1000   1000   1000   1000   1000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can then extract the TIC of MS2 data for a specific isolation window</span></span></span>
<span class="r-in"><span><span class="va">chr_ms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">mse_dia</span>, msLevel <span class="op">=</span> <span class="fl">2L</span>,</span></span>
<span class="r-in"><span>    isolationWindowTargetMz <span class="op">=</span> <span class="fl">244.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chr_ms2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co">## Chromatographic peak detection</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform peak detection on the data using the centWave algorith. Note</span></span></span>
<span class="r-in"><span><span class="co">## that the parameters are chosen to reduce the run time of the example.</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks-centWave.html">CentWaveParam</a></span><span class="op">(</span>noise <span class="op">=</span> <span class="fl">10000</span>, snthresh <span class="op">=</span> <span class="fl">40</span>, prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span><span class="va">mse</span>, param <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xmse</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class XcmsExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectra: MS1 (3834) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Experiment data: 3 sample(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample data links:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - spectra: 3 sample(s) to 3834 element(s).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  xcms results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - chromatographic peaks: 248 in MS level(s): 1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Have a quick look at the identified chromatographic peaks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract chromatographic peaks identified between 3000 and 3300 seconds</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse</span>, rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>, <span class="fl">3300</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax        into        intb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP021 453.2 453.2 453.2 3063.196 3035.027 3114.840  3001594.78  3001514.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP030 361.1 361.1 361.1 3147.704 3141.444 3153.964   367361.84   362278.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP031 340.3 340.3 340.3 3230.646 3225.952 3233.776    68671.25    68664.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP032 526.2 526.2 526.2 3243.166 3238.471 3246.296   374698.56   374692.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP033 313.1 313.1 313.1 3276.030 3254.121 3290.115  1199152.63  1162839.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP034 454.1 454.1 454.1 3276.030 3261.945 3294.809 12283448.95 12024951.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP108 307.1 307.1 307.1 3143.009 3121.099 3164.918  2191519.65  2063202.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP109 278.1 278.1 278.1 3196.217 3180.568 3213.432   657840.25   651048.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP110 526.1 526.1 526.1 3179.003 3150.833 3210.302 21334966.98 21147392.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP111 380.1 380.1 380.1 3152.398 3132.054 3174.308  2201517.91  2201474.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP112 380.1 380.1 380.1 3210.302 3210.302 3216.561   187031.44   187023.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP113 380.1 380.1 380.1 3202.477 3174.308 3216.561  1156780.73  1156736.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP114 380.1 380.1 380.1 3222.821 3216.561 3240.036   485818.25   485793.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP115 286.2 286.2 286.2 3258.815 3246.296 3280.725  1264118.64  1247233.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP116 308.1 308.1 308.1 3261.945 3241.601 3285.419  2066854.37  2025917.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP204 380.1 380.1 380.1 3150.835 3128.925 3171.179  2036803.99  1937655.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP205 286.2 286.2 286.2 3250.992 3233.777 3257.252   732016.23   722185.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP206 568.2 568.2 568.2 3207.173 3185.264 3232.212  3951832.25  3866503.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         maxo    sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP021  53096 53095      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP030  49240    57      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP031  11391 11390      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP032  60800 60799      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP033  55392    50      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP034 554112    58      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP108 101400    43      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP109  30208    54      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP110 622144   251      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP111  95176 95175      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP112  25144 28791      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP113  28920 28919      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP114  23176 23535      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP115  67600    41      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP116  96272    78      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP204  82624    49      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP205  74824    68      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP206 164352   113      3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract ion chromatograms (EIC) for the first two chromatographic</span></span></span>
<span class="r-in"><span><span class="co">## peaks.</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatogram-method.html">chromatogram</a></span><span class="op">(</span><span class="va">xmse</span>,</span></span>
<span class="r-in"><span>    mz <span class="op">=</span> <span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mzmin"</span>, <span class="st">"mzmax"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    rt <span class="op">=</span> <span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rtmin"</span>, <span class="st">"rtmax"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing chromatographic peaks</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An EIC for each sample and each of the two regions was extracted.</span></span></span>
<span class="r-in"><span><span class="co">## Identified chromatographic peaks in the defined regions are extracted</span></span></span>
<span class="r-in"><span><span class="co">## as well.</span></span></span>
<span class="r-in"><span><span class="va">chrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> XChromatograms with 2 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    1               2               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;XChromatogram&gt; &lt;XChromatogram&gt; &lt;XChromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        peaks: 1        peaks: 0        peaks: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        peaks: 1        peaks: 0        peaks: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 3 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 4 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the EICs for the second defined region</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XcmsExperiment-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Subsetting the data to the results (and data) for the second sample</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">xmse</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 248</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Filtering the result by retention time: keeping all spectra and</span></span></span>
<span class="r-in"><span><span class="co">## chromatographic peaks within 3000 and 3500 seconds.</span></span></span>
<span class="r-in"><span><span class="va">xmse_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterRt</a></span><span class="op">(</span><span class="va">xmse</span>, rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>, <span class="fl">3500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filter spectra</span>
<span class="r-in"><span><span class="va">xmse_sub</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class XcmsExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectra: MS1 (960) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Experiment data: 3 sample(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample data links:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - spectra: 3 sample(s) to 960 element(s).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  xcms results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - chromatographic peaks: 79 in MS level(s): 1 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xmse_sub</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 79</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform an initial feature grouping to allow alignment using the</span></span></span>
<span class="r-in"><span><span class="co">## peak groups method:</span></span></span>
<span class="r-in"><span><span class="va">pdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">PeakDensityParam</a></span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">xmse</span>, param <span class="op">=</span> <span class="va">pdp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform alignment using the peak groups method.</span></span></span>
<span class="r-in"><span><span class="va">pgp</span> <span class="op">&lt;-</span> <span class="fu"><a href="adjustRtime.html">PeakGroupsParam</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="adjustRtime.html">adjustRtime</a></span><span class="op">(</span><span class="va">xmse</span>, param <span class="op">=</span> <span class="va">pgp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing retention time correction using 19 peak groups.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualizing the alignment results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotAdjustedRtime.html">plotAdjustedRtime</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Performing the final correspondence analysis</span></span></span>
<span class="r-in"><span><span class="va">xmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">xmse</span>, param <span class="op">=</span> <span class="va">pdp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Show the definition of the first 6 features</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mzmed mzmin mzmax    rtmed    rtmin    rtmax npeaks 1      peakidx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01 279.0 279.0 279.0 2789.588 2787.430 2791.746      2 2      11, 199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02 286.2 286.2 286.2 3253.923 3245.811 3262.034      2 2     115, 205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03 300.2 300.2 300.2 3385.835 3384.068 3390.895      4 3 35, 125,....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04 301.0 301.0 301.0 2789.066 2787.430 2790.180      3 3  10, 97, 198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05 305.1 305.1 305.1 2927.922 2922.158 2933.686      2 2      14, 202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06 305.1 305.1 305.1 3000.543 2991.470 3009.616      2 2      15, 203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ms_level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06        1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the feature values; show the results for the first 6 rows.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-peak-grouping-results.html">featureValues</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ko15.CDF ko16.CDF   ko18.CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01 17140627.0       NA 16919266.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02         NA  1264119   732016.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03  4700903.2  5313736  5169558.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04  3051847.8  1964444  2774885.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05  1070389.9       NA  1983342.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06   847473.1       NA  1003750.6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The full results can also be extracted as a `SummarizedExperiment`</span></span></span>
<span class="r-in"><span><span class="co">## that would eventually simplify subsequent analyses with other packages.</span></span></span>
<span class="r-in"><span><span class="co">## Any additional parameters passed to the function are passed to the</span></span></span>
<span class="r-in"><span><span class="co">## `featureValues` function that is called to generate the feature value</span></span></span>
<span class="r-in"><span><span class="co">## matrix.</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">quantify</a></span><span class="op">(</span><span class="va">xmse</span>, method <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EICs for all features can be extracted with the `featureChromatograms`</span></span></span>
<span class="r-in"><span><span class="co">## function. Note that, depending on the data set, extracting this for</span></span></span>
<span class="r-in"><span><span class="co">## all features might take some time. Below we extract EICs for the</span></span></span>
<span class="r-in"><span><span class="co">## first 10 features by providing the feature IDs.</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="featureChromatograms.html">featureChromatograms</a></span><span class="op">(</span><span class="va">xmse</span>,</span></span>
<span class="r-in"><span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">xmse</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> XChromatograms with 10 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              ko15.CDF        ko16.CDF        ko18.CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;XChromatogram&gt; &lt;XChromatogram&gt; &lt;XChromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         peaks: 1        peaks: 0        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]         peaks: 0        peaks: 1        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...              ...             ...             ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [9,]         peaks: 1        peaks: 2        peaks: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]        peaks: 1        peaks: 1        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 3 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 4 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correspondence:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: chromatographic peak density </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10 feature(s) identified.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="XcmsExperiment-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

