<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Find peaks in the chromatographic time domain of the
    profile matrix. For more details see
    do_findChromPeaks_matchedFilter."><title>Peak detection in the chromatographic time domain — findPeaks.matchedFilter,xcmsRaw-method • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Peak detection in the chromatographic time domain — findPeaks.matchedFilter,xcmsRaw-method"><meta property="og:description" content="Find peaks in the chromatographic time domain of the
    profile matrix. For more details see
    do_findChromPeaks_matchedFilter."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Peak detection in the chromatographic time domain</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-xcmsRaw.R" class="external-link"><code>R/methods-xcmsRaw.R</code></a></small>
      <div class="d-none name"><code>findPeaks.matchedFilter-xcmsRaw-method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find peaks in the chromatographic time domain of the
    profile matrix. For more details see
    <code><a href="do_findChromPeaks_matchedFilter.html">do_findChromPeaks_matchedFilter</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for xcmsRaw</span></span>
<span><span class="fu">findPeaks.matchedFilter</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  fwhm <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">fwhm</span><span class="op">/</span><span class="fl">2.3548</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  snthresh <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mzdiff <span class="op">=</span> <span class="fl">0.8</span> <span class="op">-</span> <span class="va">step</span> <span class="op">*</span> <span class="va">steps</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sleep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scanrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>The <code><a href="xcmsRaw-class.html">xcmsRaw</a></code> object on which peak detection
should be performed.</p></dd>


<dt>fwhm</dt>
<dd><p><code>numeric(1)</code> specifying the full width at half maximum
of matched filtration gaussian model peak. Only used to calculate the
actual sigma, see below.</p></dd>


<dt>sigma</dt>
<dd><p><code>numeric(1)</code> specifying the standard deviation (width)
of the matched filtration model peak.</p></dd>


<dt>max</dt>
<dd><p><code>numeric(1)</code> representing the maximum number of peaks
that are expected/will be identified per slice.</p></dd>


<dt>snthresh</dt>
<dd><p><code>numeric(1)</code> defining the signal to noise cutoff
to be used in the chromatographic peak detection step.</p></dd>


<dt>step</dt>
<dd><p>numeric(1) specifying the width of the bins/slices in m/z
dimension.</p></dd>


<dt>steps</dt>
<dd><p><code>numeric(1)</code> defining the number of bins to be
merged before filtration (i.e. the number of neighboring bins that will
be joined to the slice in which filtration and peak detection will be
performed).</p></dd>


<dt>mzdiff</dt>
<dd><p><code>numeric(1)</code> defining the minimum difference
in m/z for peaks with overlapping retention times</p></dd>


<dt>index</dt>
<dd><p><code>logical(1)</code> specifying whether indicies should be
returned instead of values for m/z and retention times.</p></dd>


<dt>sleep</dt>
<dd><p>(DEPRECATED). The use of this parameter is highly discouraged,
as it could cause problems in parallel processing mode.</p></dd>


<dt>scanrange</dt>
<dd><p>Numeric vector defining the range of scans to which the
original <code>object</code> should be sub-setted before peak detection.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix, each row representing an intentified chromatographic peak,
    with columns:</p>
<p></p>
<dl><dt>mz</dt>
<dd><p>Intensity weighted mean of m/z values of the peak across
    scans.</p></dd>

    <dt>mzmin</dt>
<dd><p>Minimum m/z of the peak.</p></dd>

    <dt>mzmax</dt>
<dd><p>Maximum m/z of the peak.</p></dd>

    <dt>rt</dt>
<dd><p>Retention time of the peak's midpoint.</p></dd>

    <dt>rtmin</dt>
<dd><p>Minimum retention time of the peak.</p></dd>

    <dt>rtmax</dt>
<dd><p>Maximum retention time of the peak.</p></dd>

    <dt>into</dt>
<dd><p>Integrated (original) intensity of the peak.</p></dd>

    <dt>intf</dt>
<dd><p>Integrated intensity of the filtered peak.</p></dd>

    <dt>maxo</dt>
<dd><p>Maximum intensity of the peak.</p></dd>

    <dt>maxf</dt>
<dd><p>Maximum intensity of the filtered peak.</p></dd>

    <dt>i</dt>
<dd><p>Rank of peak in merged EIC (<code>&lt;= max</code>).</p></dd>

    <dt>sn</dt>
<dd><p>Signal to noise ratio of the peak.</p></dd>

    
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
    Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
    Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
    <em>Anal. Chem.</em> 2006, 78:779-787.
    @family Old peak detection methods</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="findChromPeaks-matchedFilter.html">matchedFilter</a></code> for the new user interface.
    <code><a href="xcmsRaw-class.html">xcmsRaw</a></code>,
    <code><a href="do_findChromPeaks_matchedFilter.html">do_findChromPeaks_matchedFilter</a></code> for the core function
    performing the peak detection.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Colin A. Smith</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

