<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chromatographic Peak Detection — findChromPeaks • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Chromatographic Peak Detection — findChromPeaks"><meta property="og:description" content="The findChromPeaks method performs chromatographic peak detection on
LC/GC-MS data. The peak detection algorithm can be selected, and configured,
using the param argument.
Supported param objects are:
CentWaveParam(): chromatographic peak detection using the centWave
algorithm.
CentWavePredIsoParam(): centWave with predicted isotopes. Peak
detection uses a two-step centWave-based approach considering also feature
isotopes.
MatchedFilterParam(): peak detection using the matched filter
algorithm.
MassifquantParam(): peak detection using the Kalman filter-based
massifquant method.
MSWParam(): single-spectrum non-chromatography MS data peak detection.


For specific examples see the help pages of the individual parameter classes
listed above."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chromatographic Peak Detection</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/XcmsExperiment.R" class="external-link"><code>R/XcmsExperiment.R</code></a></small>
    <div class="hidden name"><code>findChromPeaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>findChromPeaks</code> method performs chromatographic peak detection on
LC/GC-MS data. The peak detection algorithm can be selected, and configured,
using the <code>param</code> argument.</p>
<p>Supported <code>param</code> objects are:</p><ul><li><p><code><a href="findChromPeaks-centWave.html">CentWaveParam()</a></code>: chromatographic peak detection using the <em>centWave</em>
algorithm.</p></li>
<li><p><code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">CentWavePredIsoParam()</a></code>: <em>centWave</em> with predicted isotopes. Peak
detection uses a two-step centWave-based approach considering also feature
isotopes.</p></li>
<li><p><code><a href="findChromPeaks-matchedFilter.html">MatchedFilterParam()</a></code>: peak detection using the <em>matched filter</em>
algorithm.</p></li>
<li><p><code><a href="findChromPeaks-massifquant.html">MassifquantParam()</a></code>: peak detection using the Kalman filter-based
<em>massifquant</em> method.</p></li>
<li><p><code><a href="findPeaks-MSW.html">MSWParam()</a></code>: single-spectrum non-chromatography MS data peak detection.</p></li>
</ul><p>For specific examples see the help pages of the individual parameter classes
listed above.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findChromPeaks</span><span class="op">(</span><span class="va">object</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MsExperiment,Param</span></span>
<span><span class="fu">findChromPeaks</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  chunkSize <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XcmsExperiment,Param</span></span>
<span><span class="fu">findChromPeaks</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  chunkSize <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>The data object on which to perform the peak detection. Can be
an <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp()</a></code>, <code><a href="XCMSnExp-class.html">XCMSnExp()</a></code>, <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> or <code><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment()</a></code>
object.</p></dd>


<dt>param</dt>
<dd><p>The parameter object selecting and configuring the algorithm.</p></dd>


<dt>...</dt>
<dd><p>Optional parameters.</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level on which the
chromatographic peak detection should be performed.</p></dd>


<dt>chunkSize</dt>
<dd><p><code>integer(1)</code> for <code>object</code> being an <code>MsExperiment</code> or
<code><a href="XcmsExperiment.html">XcmsExperiment()</a></code>: defines the number of files (samples) for which the
full peaks data (m/z and intensity values) should be loaded into memory
at the same time. Peak detection is then performed in parallel (per
sample) on this subset of loaded data. This setting thus allows to
balance between memory demand and speed (due to parallel processing) of
the peak detection. Because parallel processing can only performed on
the subset of data loaded currently into memory (in each iteration), the
value for <code>chunkSize</code> should be match the defined  parallel setting
setup. Using a parallel processing setup using 4 CPUs (separate
processes) but using <code>chunkSize = </code>1<code>will not perform any parallel processing, as only the data from one sample is loaded in memory at a time. On the other hand, setting</code>chunkSize<code>to the total number of samples in an experiment will load the full MS data into memory and will thus in most settings cause an out-of-memory error. By setting</code>chunkSize = -1<code>the peak detection will be performed separately, and in parallel, for each sample. This will however not work for all</code>Spectra` <em>backends</em> (see eventually <code>Spectra()</code> for details).</p></dd>


<dt>BPPARAM</dt>
<dd><p>Parallel processing setup. Uses by default the system-wide
default setup. See <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam()</a></code> for more details.</p></dd>


<dt>add</dt>
<dd><p><code>logical(1)</code> (if <code>object</code> contains already chromatographic peaks,
i.e. is either an <code>XCMSnExp</code> or <code>XcmsExperiment</code>) whether chromatographic
peak detection results should be <strong>added</strong> to existing results. By
default (<code>add = FALSE</code>) any additional <code>findChromPeaks</code> call on a result
object will remove previous results.</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotChromPeaks.html">plotChromPeaks()</a></code> to plot identified chromatographic peaks for one file.</p>
<p><code><a href="refineChromPeaks.html">refineChromPeaks()</a></code> for methods to <em>refine</em> or clean identified
chromatographic peaks.</p>
<p><code><a href="manualChromPeaks.html">manualChromPeaks()</a></code> to manually add/define chromatographic peaks.</p>
<p>Other peak detection methods: 
<code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href="findChromPeaks-centWave.html">findChromPeaks-centWave</a></code>,
<code><a href="findChromPeaks-massifquant.html">findChromPeaks-massifquant</a></code>,
<code><a href="findChromPeaks-matchedFilter.html">findChromPeaks-matchedFilter</a></code>,
<code><a href="findPeaks-MSW.html">findPeaks-MSW</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Johannes Rainer</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

