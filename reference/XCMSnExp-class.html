<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The XCMSnExp object is a container for the results of a G/LC-MS
data preprocessing that comprises chromatographic peak detection, alignment
and correspondence. These results can be accessed with the chromPeaks,
adjustedRtime and featureDefinitions functions; see below
(after the Usage, Arguments, Value and Slots sections) for more details).
Along with the results, the object contains the processing history that
allows to track each processing step along with the used settings. This
can be extracted with the processHistory method.
XCMSnExp objects, by directly extending the
OnDiskMSnExp object from the MSnbase package, inherit
all of its functionality and allows thus an easy access to the full raw
data at any stage of an analysis.
To support interaction with packages requiring the old objects,
XCMSnExp objects can be coerced into xcmsSet
objects using the as method (see examples below). All
preprocessing results will be passed along to the resulting
xcmsSet object.
General functions for XCMSnExp objects are (see further below for
specific function to handle chromatographic peak data, alignment and
correspondence results):
processHistoryTypes returns the available types of
    process histories. These can be passed with argument type to the
    processHistory method to extract specific process step(s).
hasFilledChromPeaks: whether filled-in peaks are present or not.
profMat: creates a profile matrix, which
    is a n x m matrix, n (rows) representing equally spaced m/z values (bins)
    and m (columns) the retention time of the corresponding scans. Each cell
    contains the maximum intensity measured for the specific scan and m/z
    values. See profMat for more details and description of
    the various binning methods.
hasAdjustedRtime: whether the object provides adjusted
retention times.
hasFeatures: whether the object contains correspondence
results (i.e. features).
hasChromPeaks: whether the object contains peak
detection results.
hasFilledChromPeaks: whether the object contains any filled-in
chromatographic peaks.
adjustedRtime,adjustedRtime&amp;lt;-:
extract/set adjusted retention times. adjustedRtime&amp;lt;- should not
be called manually, it is called internally by the
adjustRtime methods. For XCMSnExp objects,
adjustedRtime&amp;lt;- does also apply retention time adjustments to
eventually present chromatographic peaks. The bySample parameter
allows to specify whether the adjusted retention time should be grouped
by sample (file).
featureDefinitions, featureDefinitions&amp;lt;-: extract
or set the correspondence results, i.e. the mz-rt features (peak groups).
Similar to the chromPeaks it is possible to extract features for
specified m/z and/or rt ranges. The function supports also the parameter
type that allows to specify which features to be returned if any
of rt or mz is specified. For details see help of
chromPeaks.
See also featureSummary for a function to calculate simple
feature summaries.
chromPeaks, chromPeaks&amp;lt;-: extract or set
the matrix containing the information on identified chromatographic
peaks. Rownames of the matrix represent unique IDs of the respective peaks
within the experiment.
Parameter bySample allows to specify whether peaks should
be returned ungrouped (default bySample = FALSE) or grouped by
sample (bySample = TRUE). The chromPeaks&amp;lt;- method for
XCMSnExp objects removes also all correspondence (peak grouping)
and retention time correction (alignment) results. The optional
arguments rt, mz, ppm and type allow to extract
only chromatographic peaks overlapping the defined retention time and/or
m/z ranges. Argument type allows to define how overlapping is
determined: for type == &quot;any&quot; (the default), all peaks that are even
partially overlapping the region are returned (i.e. for which either
&quot;mzmin&quot; or &quot;mzmax&quot; of the chromPeaks or
featureDefinitions matrix are within the provided m/z range), for
type == &quot;within&quot; the full peak has to be within the region (i.e.
both &quot;mzmin&quot; and &quot;mzmax&quot; have to be within the m/z range) and
for type == &quot;apex_within&quot; the peak's apex position (highest signal
of the peak) has to be within the region (i.e. the peak's or features m/z
has to be within the m/z range).
See description of the return value for details on the returned matrix.
Users usually don't have to use the chromPeaks&amp;lt;- method directly
as detected chromatographic peaks are added to the object by the
findChromPeaks method. Also, chromPeaks&amp;lt;- will replace
any existing chromPeakData.
chromPeakData and chromPeakData&amp;lt;- allow to get or set arbitrary
chromatographic peak annotations. These are returned or ar returned as a
DataFrame. Note that the number of rows and the rownames of the
DataFrame have to match those of chromPeaks.
rtime: extracts the retention time for each
scan. The bySample parameter allows to return the values grouped
by sample/file and adjusted whether adjusted or raw retention
times should be returned. By default the method returns adjusted
retention times, if they are available (i.e. if retention times were
adjusted using the adjustRtime method).
mz: extracts the mz values from each scan of
all files within an XCMSnExp object. These values are extracted
from the original data files and eventual processing steps are applied
on the fly. Using the bySample parameter it is possible to
switch from the default grouping of mz values by spectrum/scan to a
grouping by sample/file.
intensity: extracts the intensity values from
each scan of all files within an XCMSnExp object. These values are
extracted from the original data files and eventual processing steps are
applied on the fly. Using the bySample parameter it is
possible to switch from the default grouping of intensity values by
spectrum/scan to a grouping by sample/file.
spectra: extracts the
Spectrum objects containing all data from
object. The values are extracted from the original data files and
eventual processing steps are applied on the fly. By setting
bySample = TRUE, the spectra are returned grouped by sample/file.
If the XCMSnExp object contains adjusted retention times, these
are returned by default in the Spectrum objects (can be
overwritten by setting adjusted = FALSE).
processHistory: returns a list of
ProcessHistory objects (or objects inheriting from this
base class) representing the individual processing steps that have been
performed, eventually along with their settings (Param parameter
class). Optional arguments fileIndex, type and
msLevel allow to restrict to process steps of a certain type or
performed on a certain file or MS level.
dropChromPeaks: drops any identified chromatographic
peaks and returns the object without that information. Note that for
XCMSnExp objects the method drops by default also results from a
correspondence (peak grouping) analysis. Adjusted retention times are
removed if the alignment has been performed after peak detection.
This can be overruled with keepAdjustedRtime = TRUE.
dropFeatureDefinitions: drops the results from a
correspondence (peak grouping) analysis, i.e. the definition of the mz-rt
features and returns the object without that information. Note that for
XCMSnExp objects the method will also by default drop retention
time adjustment results, if these were performed after the last peak
grouping (i.e. which base on the results from the peak grouping that are
going to be removed). All related process history steps are
removed too as well as eventually filled in peaks
(by fillChromPeaks). The parameter keepAdjustedRtime
can be used to avoid removal of adjusted retention times.
dropAdjustedRtime: drops any retention time
adjustment information and returns the object without adjusted retention
time. For XCMSnExp objects, this also reverts the retention times
reported for the chromatographic peaks in the peak matrix to the
original, raw, ones (after chromatographic peak detection). Note that
for XCMSnExp objects the method drops also all peak grouping
results if these were performed after the retention time
adjustment. All related process history steps are removed too.
findChromPeaks performs chromatographic peak detection
on the provided XCMSnExp objects. For more details see the method
for XCMSnExp.
Note that by default (with parameter add = FALSE) previous peak
detection results are removed. Use add = TRUE to perform a second
round of peak detection and add the newly identified peaks to the previous
peak detection results. Correspondence results (features) are always removed
prior to peak detection. Previous alignment (retention
time adjustment) results are kept, i.e. chromatographic peak detection
is performed using adjusted retention times if the data was first
aligned using e.g. obiwarp (adjustRtime).
dropFilledChromPeaks: drops any filled-in chromatographic
peaks (filled in by the fillChromPeaks method) and all
related process history steps.
spectrapply applies the provided function to each
Spectrum in the object and returns its
results. If no function is specified the function simply returns the
list of Spectrum objects.
XCMSnExp objects can be combined with the c function. This
combines identified chromatographic peaks and the objects' pheno data but
discards alignment results or feature definitions.
plot plots the spectrum data (see plot for
MSnExp objects in the MSnbase package for more details.
For type = &quot;XIC&quot;, identified chromatographic peaks will be indicated
as rectangles with border color peakCol."><title>Data container storing xcms preprocessing results — XCMSnExp-class • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data container storing xcms preprocessing results — XCMSnExp-class"><meta property="og:description" content="The XCMSnExp object is a container for the results of a G/LC-MS
data preprocessing that comprises chromatographic peak detection, alignment
and correspondence. These results can be accessed with the chromPeaks,
adjustedRtime and featureDefinitions functions; see below
(after the Usage, Arguments, Value and Slots sections) for more details).
Along with the results, the object contains the processing history that
allows to track each processing step along with the used settings. This
can be extracted with the processHistory method.
XCMSnExp objects, by directly extending the
OnDiskMSnExp object from the MSnbase package, inherit
all of its functionality and allows thus an easy access to the full raw
data at any stage of an analysis.
To support interaction with packages requiring the old objects,
XCMSnExp objects can be coerced into xcmsSet
objects using the as method (see examples below). All
preprocessing results will be passed along to the resulting
xcmsSet object.
General functions for XCMSnExp objects are (see further below for
specific function to handle chromatographic peak data, alignment and
correspondence results):
processHistoryTypes returns the available types of
    process histories. These can be passed with argument type to the
    processHistory method to extract specific process step(s).
hasFilledChromPeaks: whether filled-in peaks are present or not.
profMat: creates a profile matrix, which
    is a n x m matrix, n (rows) representing equally spaced m/z values (bins)
    and m (columns) the retention time of the corresponding scans. Each cell
    contains the maximum intensity measured for the specific scan and m/z
    values. See profMat for more details and description of
    the various binning methods.
hasAdjustedRtime: whether the object provides adjusted
retention times.
hasFeatures: whether the object contains correspondence
results (i.e. features).
hasChromPeaks: whether the object contains peak
detection results.
hasFilledChromPeaks: whether the object contains any filled-in
chromatographic peaks.
adjustedRtime,adjustedRtime&amp;lt;-:
extract/set adjusted retention times. adjustedRtime&amp;lt;- should not
be called manually, it is called internally by the
adjustRtime methods. For XCMSnExp objects,
adjustedRtime&amp;lt;- does also apply retention time adjustments to
eventually present chromatographic peaks. The bySample parameter
allows to specify whether the adjusted retention time should be grouped
by sample (file).
featureDefinitions, featureDefinitions&amp;lt;-: extract
or set the correspondence results, i.e. the mz-rt features (peak groups).
Similar to the chromPeaks it is possible to extract features for
specified m/z and/or rt ranges. The function supports also the parameter
type that allows to specify which features to be returned if any
of rt or mz is specified. For details see help of
chromPeaks.
See also featureSummary for a function to calculate simple
feature summaries.
chromPeaks, chromPeaks&amp;lt;-: extract or set
the matrix containing the information on identified chromatographic
peaks. Rownames of the matrix represent unique IDs of the respective peaks
within the experiment.
Parameter bySample allows to specify whether peaks should
be returned ungrouped (default bySample = FALSE) or grouped by
sample (bySample = TRUE). The chromPeaks&amp;lt;- method for
XCMSnExp objects removes also all correspondence (peak grouping)
and retention time correction (alignment) results. The optional
arguments rt, mz, ppm and type allow to extract
only chromatographic peaks overlapping the defined retention time and/or
m/z ranges. Argument type allows to define how overlapping is
determined: for type == &quot;any&quot; (the default), all peaks that are even
partially overlapping the region are returned (i.e. for which either
&quot;mzmin&quot; or &quot;mzmax&quot; of the chromPeaks or
featureDefinitions matrix are within the provided m/z range), for
type == &quot;within&quot; the full peak has to be within the region (i.e.
both &quot;mzmin&quot; and &quot;mzmax&quot; have to be within the m/z range) and
for type == &quot;apex_within&quot; the peak's apex position (highest signal
of the peak) has to be within the region (i.e. the peak's or features m/z
has to be within the m/z range).
See description of the return value for details on the returned matrix.
Users usually don't have to use the chromPeaks&amp;lt;- method directly
as detected chromatographic peaks are added to the object by the
findChromPeaks method. Also, chromPeaks&amp;lt;- will replace
any existing chromPeakData.
chromPeakData and chromPeakData&amp;lt;- allow to get or set arbitrary
chromatographic peak annotations. These are returned or ar returned as a
DataFrame. Note that the number of rows and the rownames of the
DataFrame have to match those of chromPeaks.
rtime: extracts the retention time for each
scan. The bySample parameter allows to return the values grouped
by sample/file and adjusted whether adjusted or raw retention
times should be returned. By default the method returns adjusted
retention times, if they are available (i.e. if retention times were
adjusted using the adjustRtime method).
mz: extracts the mz values from each scan of
all files within an XCMSnExp object. These values are extracted
from the original data files and eventual processing steps are applied
on the fly. Using the bySample parameter it is possible to
switch from the default grouping of mz values by spectrum/scan to a
grouping by sample/file.
intensity: extracts the intensity values from
each scan of all files within an XCMSnExp object. These values are
extracted from the original data files and eventual processing steps are
applied on the fly. Using the bySample parameter it is
possible to switch from the default grouping of intensity values by
spectrum/scan to a grouping by sample/file.
spectra: extracts the
Spectrum objects containing all data from
object. The values are extracted from the original data files and
eventual processing steps are applied on the fly. By setting
bySample = TRUE, the spectra are returned grouped by sample/file.
If the XCMSnExp object contains adjusted retention times, these
are returned by default in the Spectrum objects (can be
overwritten by setting adjusted = FALSE).
processHistory: returns a list of
ProcessHistory objects (or objects inheriting from this
base class) representing the individual processing steps that have been
performed, eventually along with their settings (Param parameter
class). Optional arguments fileIndex, type and
msLevel allow to restrict to process steps of a certain type or
performed on a certain file or MS level.
dropChromPeaks: drops any identified chromatographic
peaks and returns the object without that information. Note that for
XCMSnExp objects the method drops by default also results from a
correspondence (peak grouping) analysis. Adjusted retention times are
removed if the alignment has been performed after peak detection.
This can be overruled with keepAdjustedRtime = TRUE.
dropFeatureDefinitions: drops the results from a
correspondence (peak grouping) analysis, i.e. the definition of the mz-rt
features and returns the object without that information. Note that for
XCMSnExp objects the method will also by default drop retention
time adjustment results, if these were performed after the last peak
grouping (i.e. which base on the results from the peak grouping that are
going to be removed). All related process history steps are
removed too as well as eventually filled in peaks
(by fillChromPeaks). The parameter keepAdjustedRtime
can be used to avoid removal of adjusted retention times.
dropAdjustedRtime: drops any retention time
adjustment information and returns the object without adjusted retention
time. For XCMSnExp objects, this also reverts the retention times
reported for the chromatographic peaks in the peak matrix to the
original, raw, ones (after chromatographic peak detection). Note that
for XCMSnExp objects the method drops also all peak grouping
results if these were performed after the retention time
adjustment. All related process history steps are removed too.
findChromPeaks performs chromatographic peak detection
on the provided XCMSnExp objects. For more details see the method
for XCMSnExp.
Note that by default (with parameter add = FALSE) previous peak
detection results are removed. Use add = TRUE to perform a second
round of peak detection and add the newly identified peaks to the previous
peak detection results. Correspondence results (features) are always removed
prior to peak detection. Previous alignment (retention
time adjustment) results are kept, i.e. chromatographic peak detection
is performed using adjusted retention times if the data was first
aligned using e.g. obiwarp (adjustRtime).
dropFilledChromPeaks: drops any filled-in chromatographic
peaks (filled in by the fillChromPeaks method) and all
related process history steps.
spectrapply applies the provided function to each
Spectrum in the object and returns its
results. If no function is specified the function simply returns the
list of Spectrum objects.
XCMSnExp objects can be combined with the c function. This
combines identified chromatographic peaks and the objects' pheno data but
discards alignment results or feature definitions.
plot plots the spectrum data (see plot for
MSnExp objects in the MSnbase package for more details.
For type = &quot;XIC&quot;, identified chromatographic peaks will be indicated
as rectangles with border color peakCol."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data container storing xcms preprocessing results</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/DataClasses.R" class="external-link"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-ProcessHistory.R" class="external-link"><code>R/functions-ProcessHistory.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-XCMSnExp.R" class="external-link"><code>R/functions-XCMSnExp.R</code></a>, and 2 more</small>
      <div class="d-none name"><code>XCMSnExp-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>XCMSnExp</code> object is a container for the results of a G/LC-MS
data preprocessing that comprises chromatographic peak detection, alignment
and correspondence. These results can be accessed with the <code>chromPeaks</code>,
<code>adjustedRtime</code> and <code>featureDefinitions</code> functions; see below
(after the Usage, Arguments, Value and Slots sections) for more details).
Along with the results, the object contains the processing history that
allows to track each processing step along with the used settings. This
can be extracted with the <code>processHistory</code> method.
<code>XCMSnExp</code> objects, by directly extending the
<code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> object from the <code>MSnbase</code> package, inherit
all of its functionality and allows thus an easy access to the full raw
data at any stage of an analysis.
To support interaction with packages requiring the <em>old</em> objects,
<code>XCMSnExp</code> objects can be coerced into <code><a href="xcmsSet-class.html">xcmsSet</a></code>
objects using the <code>as</code> method (see examples below). All
preprocessing results will be passed along to the resulting
<code>xcmsSet</code> object.</p>
<p>General functions for <code>XCMSnExp</code> objects are (see further below for
specific function to handle chromatographic peak data, alignment and
correspondence results):</p>
<p><code>processHistoryTypes</code> returns the available <em>types</em> of
    process histories. These can be passed with argument <code>type</code> to the
    <code>processHistory</code> method to extract specific process step(s).</p>
<p><code>hasFilledChromPeaks</code>: whether filled-in peaks are present or not.</p>
<p><code>profMat</code>: creates a <em>profile matrix</em>, which
    is a n x m matrix, n (rows) representing equally spaced m/z values (bins)
    and m (columns) the retention time of the corresponding scans. Each cell
    contains the maximum intensity measured for the specific scan and m/z
    values. See <code><a href="profMat-xcmsSet.html">profMat</a></code> for more details and description of
    the various binning methods.</p>
<p><code>hasAdjustedRtime</code>: whether the object provides adjusted
retention times.</p>
<p><code>hasFeatures</code>: whether the object contains correspondence
results (i.e. features).</p>
<p><code>hasChromPeaks</code>: whether the object contains peak
detection results.</p>
<p><code>hasFilledChromPeaks</code>: whether the object contains any filled-in
chromatographic peaks.</p>
<p><code>adjustedRtime</code>,<code>adjustedRtime&lt;-</code>:
extract/set adjusted retention times. <code>adjustedRtime&lt;-</code> should not
be called manually, it is called internally by the
<code><a href="adjustRtime.html">adjustRtime</a></code> methods. For <code>XCMSnExp</code> objects,
<code>adjustedRtime&lt;-</code> does also apply retention time adjustments to
eventually present chromatographic peaks. The <code>bySample</code> parameter
allows to specify whether the adjusted retention time should be grouped
by sample (file).</p>
<p><code>featureDefinitions</code>, <code>featureDefinitions&lt;-</code>: extract
or set the correspondence results, i.e. the mz-rt features (peak groups).
Similar to the <code>chromPeaks</code> it is possible to extract features for
specified m/z and/or rt ranges. The function supports also the parameter
<code>type</code> that allows to specify which features to be returned if any
of <code>rt</code> or <code>mz</code> is specified. For details see help of
<code>chromPeaks</code>.
See also <code><a href="featureSummary.html">featureSummary</a></code> for a function to calculate simple
feature summaries.</p>
<p><code>chromPeaks</code>, <code>chromPeaks&lt;-</code>: extract or set
the matrix containing the information on identified chromatographic
peaks. Rownames of the matrix represent unique IDs of the respective peaks
within the experiment.
Parameter <code>bySample</code> allows to specify whether peaks should
be returned ungrouped (default <code>bySample = FALSE</code>) or grouped by
sample (<code>bySample = TRUE</code>). The <code>chromPeaks&lt;-</code> method for
<code>XCMSnExp</code> objects removes also all correspondence (peak grouping)
and retention time correction (alignment) results. The optional
arguments <code>rt</code>, <code>mz</code>, <code>ppm</code> and <code>type</code> allow to extract
only chromatographic peaks overlapping the defined retention time and/or
m/z ranges. Argument <code>type</code> allows to define how <em>overlapping</em> is
determined: for <code>type == "any"</code> (the default), all peaks that are even
partially overlapping the region are returned (i.e. for which either
<code>"mzmin"</code> or <code>"mzmax"</code> of the <code>chromPeaks</code> or
<code>featureDefinitions</code> matrix are within the provided m/z range), for
<code>type == "within"</code> the full peak has to be within the region (i.e.
both <code>"mzmin"</code> and <code>"mzmax"</code> have to be within the m/z range) and
for <code>type == "apex_within"</code> the peak's apex position (highest signal
of the peak) has to be within the region (i.e. the peak's or features m/z
has to be within the m/z range).
See description of the return value for details on the returned matrix.
Users usually don't have to use the <code>chromPeaks&lt;-</code> method directly
as detected chromatographic peaks are added to the object by the
<code><a href="findChromPeaks.html">findChromPeaks</a></code> method. Also, <code>chromPeaks&lt;-</code> will replace
any existing <code>chromPeakData</code>.</p>
<p><code>chromPeakData</code> and <code>chromPeakData&lt;-</code> allow to get or set arbitrary
chromatographic peak annotations. These are returned or ar returned as a
<code>DataFrame</code>. Note that the number of rows and the rownames of the
<code>DataFrame</code> have to match those of <code>chromPeaks</code>.</p>
<p><code>rtime</code>: extracts the retention time for each
scan. The <code>bySample</code> parameter allows to return the values grouped
by sample/file and <code>adjusted</code> whether adjusted or raw retention
times should be returned. By default the method returns adjusted
retention times, if they are available (i.e. if retention times were
adjusted using the <code><a href="adjustRtime.html">adjustRtime</a></code> method).</p>
<p><code>mz</code>: extracts the mz values from each scan of
all files within an <code>XCMSnExp</code> object. These values are extracted
from the original data files and eventual processing steps are applied
<em>on the fly</em>. Using the <code>bySample</code> parameter it is possible to
switch from the default grouping of mz values by spectrum/scan to a
grouping by sample/file.</p>
<p><code>intensity</code>: extracts the intensity values from
each scan of all files within an <code>XCMSnExp</code> object. These values are
extracted from the original data files and eventual processing steps are
applied <em>on the fly</em>. Using the <code>bySample</code> parameter it is
possible to switch from the default grouping of intensity values by
spectrum/scan to a grouping by sample/file.</p>
<p><code>spectra</code>: extracts the
<code><a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">Spectrum</a></code> objects containing all data from
<code>object</code>. The values are extracted from the original data files and
eventual processing steps are applied <em>on the fly</em>. By setting
<code>bySample = TRUE</code>, the spectra are returned grouped by sample/file.
If the <code>XCMSnExp</code> object contains adjusted retention times, these
are returned by default in the <code>Spectrum</code> objects (can be
overwritten by setting <code>adjusted = FALSE</code>).</p>
<p><code>processHistory</code>: returns a <code>list</code> of
<code><a href="ProcessHistory-class.html">ProcessHistory</a></code> objects (or objects inheriting from this
base class) representing the individual processing steps that have been
performed, eventually along with their settings (<code>Param</code> parameter
class). Optional arguments <code>fileIndex</code>, <code>type</code> and
<code>msLevel</code> allow to restrict to process steps of a certain type or
performed on a certain file or MS level.</p>
<p><code>dropChromPeaks</code>: drops any identified chromatographic
peaks and returns the object without that information. Note that for
<code>XCMSnExp</code> objects the method drops by default also results from a
correspondence (peak grouping) analysis. Adjusted retention times are
removed if the alignment has been performed <em>after</em> peak detection.
This can be overruled with <code>keepAdjustedRtime = TRUE</code>.</p>
<p><code>dropFeatureDefinitions</code>: drops the results from a
correspondence (peak grouping) analysis, i.e. the definition of the mz-rt
features and returns the object without that information. Note that for
<code>XCMSnExp</code> objects the method will also by default drop retention
time adjustment results, if these were performed after the last peak
grouping (i.e. which base on the results from the peak grouping that are
going to be removed). All related process history steps are
removed too as well as eventually filled in peaks
(by <code><a href="fillChromPeaks.html">fillChromPeaks</a></code>). The parameter <code>keepAdjustedRtime</code>
can be used to avoid removal of adjusted retention times.</p>
<p><code>dropAdjustedRtime</code>: drops any retention time
adjustment information and returns the object without adjusted retention
time. For <code>XCMSnExp</code> objects, this also reverts the retention times
reported for the chromatographic peaks in the peak matrix to the
original, raw, ones (after chromatographic peak detection). Note that
for <code>XCMSnExp</code> objects the method drops also all peak grouping
results if these were performed <em>after</em> the retention time
adjustment. All related process history steps are removed too.</p>
<p><code>findChromPeaks</code> performs chromatographic peak detection
on the provided <code>XCMSnExp</code> objects. For more details see the method
for <code>XCMSnExp</code>.
Note that by default (with parameter <code>add = FALSE</code>) previous peak
detection results are removed. Use <code>add = TRUE</code> to perform a second
round of peak detection and add the newly identified peaks to the previous
peak detection results. Correspondence results (features) are always removed
prior to peak detection. Previous alignment (retention
time adjustment) results are kept, i.e. chromatographic peak detection
is performed using adjusted retention times if the data was first
aligned using e.g. obiwarp (<code><a href="adjustRtime.html">adjustRtime</a></code>).</p>
<p><code>dropFilledChromPeaks</code>: drops any filled-in chromatographic
peaks (filled in by the <code><a href="fillChromPeaks.html">fillChromPeaks</a></code> method) and all
related process history steps.</p>
<p><code>spectrapply</code> applies the provided function to each
<code>Spectrum</code> in the object and returns its
results. If no function is specified the function simply returns the
<code>list</code> of <code>Spectrum</code> objects.</p>
<p><code>XCMSnExp</code> objects can be combined with the <code>c</code> function. This
combines identified chromatographic peaks and the objects' pheno data but
discards alignment results or feature definitions.</p>
<p><code>plot</code> plots the spectrum data (see <code><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></code> for
<code><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">MSnExp</a></code> objects in the <code>MSnbase</code> package for more details.
For <code>type = "XIC"</code>, identified chromatographic peaks will be indicated
as rectangles with border color <code>peakCol</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">processHistoryTypes</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">hasFilledChromPeaks</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OnDiskMSnExp</span></span>
<span><span class="fu"><a href="profMat-xcmsSet.html">profMat</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"bin"</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  baselevel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basespace <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mzrange. <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">fileIndex</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">hasAdjustedRtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">hasFeatures</span><span class="op">(</span><span class="va">object</span>, msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">hasChromPeaks</span><span class="op">(</span><span class="va">object</span>, msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">hasFilledChromPeaks</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">adjustedRtime</span><span class="op">(</span><span class="va">object</span>, bySample <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">adjustedRtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">featureDefinitions</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"any"</span>, <span class="st">"within"</span>, <span class="st">"apex_within"</span><span class="op">)</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">featureDefinitions</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">chromPeaks</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  bySample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"any"</span>, <span class="st">"within"</span>, <span class="st">"apex_within"</span><span class="op">)</span>,</span>
<span>  isFilledColumn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">chromPeaks</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">object</span>, bySample <span class="op">=</span> <span class="cn">FALSE</span>, adjusted <span class="op">=</span> <span class="fu">hasAdjustedRtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">object</span>, bySample <span class="op">=</span> <span class="cn">FALSE</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">object</span>, bySample <span class="op">=</span> <span class="cn">FALSE</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectra</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  bySample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  adjusted <span class="op">=</span> <span class="fu">hasAdjustedRtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">processHistory</span><span class="op">(</span><span class="va">object</span>, <span class="va">fileIndex</span>, <span class="va">type</span>, <span class="va">msLevel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">dropChromPeaks</span><span class="op">(</span><span class="va">object</span>, keepAdjustedRtime <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">dropFeatureDefinitions</span><span class="op">(</span><span class="va">object</span>, keepAdjustedRtime <span class="op">=</span> <span class="cn">FALSE</span>, dropLastN <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">dropAdjustedRtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="profMat-xcmsSet.html">profMat</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"bin"</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  baselevel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basespace <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mzrange. <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">fileIndex</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp,Param</span></span>
<span><span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="st">"XCMSnExp"</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">dropFilledChromPeaks</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectrapply</a></span><span class="op">(</span><span class="va">object</span>, FUN <span class="op">=</span> <span class="cn">NULL</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for XCMSnExp</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">chromPeakData</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">chromPeakData</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp,missing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spectra"</span>, <span class="st">"XIC"</span><span class="op">)</span>, peakCol <span class="op">=</span> <span class="st">"#ff000060"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>For <code>adjustedRtime</code>, <code>featureDefinitions</code>,
<code>chromPeaks</code>, <code>hasAdjustedRtime</code>, <code>hasFeatures</code> and
<code>hasChromPeaks</code> either a <code>MsFeatureData</code> or a <code>XCMSnExp</code>
object, for all other methods a <code>XCMSnExp</code> object.</p></dd>


<dt>method</dt>
<dd><p><code>character(1)</code> defining the profile matrix generation method.
Allowed are <code>"bin"</code>, <code>"binlin"</code>, <code>"binlinbase"</code> and <code>"intlin"</code>.
See details section for more information.</p></dd>


<dt>step</dt>
<dd><p><code>numeric(1)</code> representing the m/z bin size.</p></dd>


<dt>baselevel</dt>
<dd><p><code>numeric(1)</code> representing the base value to which
empty elements (i.e. m/z bins without a measured intensity) should be
set. Only considered if <code>method = "binlinbase"</code>. See
<code>baseValue</code> parameter of <code><a href="imputeLinInterpol.html">imputeLinInterpol()</a></code> for more
details.</p></dd>


<dt>basespace</dt>
<dd><p><code>numeric(1)</code> representing the m/z length after
which the signal will drop to the base level. Linear interpolation will
be used between consecutive data points falling within
<code>2 * basespace</code> to each other. Only considered if
<code>method = "binlinbase"</code>. If not specified, it defaults to
<code>0.075</code>. Internally this parameter is translated into the
<code>distance</code> parameter of the <code><a href="imputeLinInterpol.html">imputeLinInterpol()</a></code>
function by <code>distance = floor(basespace / step)</code>. See
<code>distance</code> parameter of <code><a href="imputeLinInterpol.html">imputeLinInterpol()</a></code> for more
details.</p></dd>


<dt>mzrange.</dt>
<dd><p>Optional <code>numeric(2)</code> manually specifying the mz value range
to be used for binnind. If not provided, the whole m/z value range is
used.</p></dd>


<dt>fileIndex</dt>
<dd><p>For <code>processHistory</code>: optional <code>integer</code>
specifying the index of the files/samples for which the
<code><a href="ProcessHistory-class.html">ProcessHistory</a></code> objects should be retrieved.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters.</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer</code> specifying the MS level(s) for which identified
chromatographic peaks should be returned.</p></dd>


<dt>bySample</dt>
<dd><p>logical(1) specifying whether results should be grouped by
sample.</p></dd>


<dt>value</dt>
<dd><p>For <code>adjustedRtime&lt;-</code>: a <code>list</code> (length equal to the
    number of samples) with numeric vectors representing the adjusted
    retention times per scan.</p>
<p>For <code>featureDefinitions&lt;-</code>: a <code>DataFrame</code> with peak
    grouping information. See return value for the <code>featureDefinitions</code>
    method for the expected format.</p>
<p>For <code>chromPeaks&lt;-</code>: a <code>matrix</code> with information on
    detected peaks. See return value for the <code>chromPeaks</code> method for the
    expected format.</p></dd>


<dt>mz</dt>
<dd><p>optional <code>numeric(2)</code> defining the mz range for which
chromatographic peaks should be returned.</p></dd>


<dt>rt</dt>
<dd><p>optional <code>numeric(2)</code> defining the retention time range for
which chromatographic peaks should be returned.</p></dd>


<dt>ppm</dt>
<dd><p>optional <code>numeric(1)</code> specifying the ppm by which the
<code>mz</code> range should be extended. For a value of <code>ppm = 10</code>, all
peaks within <code>mz[1] - ppm / 1e6</code> and <code>mz[2] + ppm / 1e6</code> are
returned.</p></dd>


<dt>type</dt>
<dd><p>For <code>processHistory</code>: restrict returned
<code><a href="ProcessHistory-class.html">ProcessHistory</a></code> objects to analysis steps of a certain
type. Use the <code>processHistoryTypes</code> to list all supported values.
For <code>chromPeaks</code>: <code>character</code> specifying which peaks to return
if <code>rt</code> or <code>mz</code> are defined. For <code>type = "any"</code> all
chromatographic peaks partially overlapping the range defined by
<code>mz</code> and/or <code>rt</code> are returned, <code>type = "within"</code> returns
only peaks completely within the region and <code>type = "apex_within"</code>
peaks for which the peak's apex is within the region.</p></dd>


<dt>isFilledColumn</dt>
<dd><p><code>logical(1)</code> whether a column <code>"is_filled"</code>
is included in the returned <code>"matrix"</code> providing the information
if a peak was filled in. Alternatively, this information would be
provided by the <code>chromPeakData</code> data frame.</p></dd>


<dt>adjusted</dt>
<dd><p>logical(1) whether adjusted or raw (i.e. the original
retention times reported in the files) should be returned.</p></dd>


<dt>BPPARAM</dt>
<dd><p>Parameter class for parallel processing. See
<code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></code>.</p></dd>


<dt>keepAdjustedRtime</dt>
<dd><p>For <code>dropFeatureDefinitions,XCMSnExp</code>:
<code>logical(1)</code> defining whether eventually present retention time
adjustment should not be dropped. By default dropping feature definitions
drops retention time adjustment results too.</p></dd>


<dt>dropLastN</dt>
<dd><p>For <code>dropFeatureDefinitions,XCMSnExp</code>:
<code>numeric(1)</code> defining the number of peak grouping related process
history steps to remove. By default <code>dropLastN = -1</code>, dropping the
chromatographic peaks removes all process history steps related to peak
grouping. Setting e.g. <code>dropLastN = 1</code> will only remove the most
recent peak grouping related process history step.</p></dd>


<dt>param</dt>
<dd><p>A <code><a href="findChromPeaks-centWave.html">CentWaveParam</a></code>, <code><a href="findChromPeaks-matchedFilter.html">MatchedFilterParam</a></code>,
<code><a href="findChromPeaks-massifquant.html">MassifquantParam</a></code>, <code><a href="findPeaks-MSW.html">MSWParam</a></code> or
<code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">CentWavePredIsoParam</a></code> object with the settings for the
chromatographic peak detection algorithm.</p></dd>


<dt>return.type</dt>
<dd><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></dd>


<dt>add</dt>
<dd><p>For <code>findChromPeaks</code>: if newly identified chromatographic
peaks should be added to the peak matrix with the already identified
chromatographic peaks. By default (<code>add = FALSE</code>) previous
peak detection results will be removed.</p></dd>


<dt>FUN</dt>
<dd><p>For <code>spectrapply</code>: a function that should be applied to each
spectrum in the object.</p></dd>


<dt>x</dt>
<dd><p>For <code>plot</code>: <code>XCMSnExp</code> object.</p></dd>


<dt>y</dt>
<dd><p>For <code>plot</code>: not used.</p></dd>


<dt>peakCol</dt>
<dd><p>For <code>plot</code>: the color that should be used to indicate
identified chromatographic peaks (only in combination with
<code>type = "XIC"</code> and if chromatographic peaks are present).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>profMat</code>: a <code>list</code> with a the profile matrix</p>
<p></p>
<p><code>matrix</code> (or matrices if <code>fileIndex</code> was not specified or if</p>
<p></p>
<p><code>length(fileIndex) &gt; 1</code>). See <code><a href="profMat-xcmsSet.html">profile-matrix</a></code> for
    general help and information about the profile matrix.</p>


<p>For <code>adjustedRtime</code>: if <code>bySample = FALSE</code> a <code>numeric</code></p>


<p>vector with the adjusted retention for each spectrum of all files/samples
within the object. If <code>bySample = TRUE </code> a <code>list</code> (length equal
to the number of samples) with adjusted retention times grouped by
sample. Returns <code>NULL</code> if no adjusted retention times are present.</p>


<p>For <code>featureDefinitions</code>: a <code>DataFrame</code> with peak grouping
information, each row corresponding to one mz-rt feature (grouped peaks
within and across samples) and columns <code>"mzmed"</code> (median mz value),
<code>"mzmin"</code> (minimal mz value), <code>"mzmax"</code> (maximum mz value),
<code>"rtmed"</code> (median retention time), <code>"rtmin"</code> (minimal retention
time), <code>"rtmax"</code> (maximal retention time) and <code>"peakidx"</code>.
Column <code>"peakidx"</code> contains a <code>list</code> with indices of
chromatographic peaks (rows) in the matrix returned by the
<code>chromPeaks</code> method that belong to that feature group. The method
returns <code>NULL</code> if no feature definitions are present.
<code>featureDefinitions</code> supports also parameters <code>mz</code>, <code>rt</code>,
<code>ppm</code> and <code>type</code> to return only features within certain ranges (see
description of <code>chromPeaks</code> for details).</p>


<p>For <code>chromPeaks</code>: if <code>bySample = FALSE</code> a <code>matrix</code> (each row
being a chromatographic peak, rownames representing unique IDs of the peaks)
with at least the following columns:
<code>"mz"</code> (intensity-weighted mean of mz values of the peak across
scans/retention times),
<code>"mzmin"</code> (minimal mz value),
<code>"mzmax"</code> (maximal mz value),
<code>"rt"</code> (retention time of the peak apex),
<code>"rtmin"</code> (minimal retention time),
<code>"rtmax"</code> (maximal retention time),
<code>"into"</code> (integrated, original, intensity of the peak),
<code>"maxo"</code> (maximum intentity of the peak),
<code>"sample"</code> (sample index in which the peak was identified) and
Depending on the employed peak detection algorithm and the
<code>verboseColumns</code> parameter of it, additional columns might be
returned. If parameter <code>isFilledColumn</code> was set to <code>TRUE</code> a column
named <code>"is_filled"</code> is also returned.
For <code>bySample = TRUE</code> the chromatographic peaks are
returned as a <code>list</code> of matrices, each containing the
chromatographic peaks of a specific sample. For samples in which no
peaks were detected a matrix with 0 rows is returned.</p>


<p>For <code>rtime</code>: if <code>bySample = FALSE</code> a numeric vector with
the retention times of each scan, if <code>bySample = TRUE</code> a
<code>list</code> of numeric vectors with the retention times per sample.</p>


<p>For <code>mz</code>: if <code>bySample = FALSE</code> a <code>list</code> with the mz
values (numeric vectors) of each scan. If <code>bySample = TRUE</code> a
<code>list</code> with the mz values per sample.</p>


<p>For <code>intensity</code>: if <code>bySample = FALSE</code> a <code>list</code> with
the intensity values (numeric vectors) of each scan. If
<code>bySample = TRUE</code> a <code>list</code> with the intensity values per
sample.</p>


<p>For <code>spectra</code>: if <code>bySample = FALSE</code> a <code>list</code> with
<code><a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">Spectrum</a></code> objects. If <code>bySample = TRUE</code> the
result is grouped by sample, i.e. as a <code>list</code> of <code>lists</code>, each
element in the <em>outer</em></p>
<p></p>
<p><code>list</code> being the <code>list</code> of spectra
of the specific file.</p>


<p>For <code>processHistory</code>: a <code>list</code> of
<code><a href="ProcessHistory-class.html">ProcessHistory</a></code> objects providing the details of the
individual data processing steps that have been performed.</p>
    </div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>
    

<dl><dt><code>.processHistory</code></dt>
<dd><p><code>list</code> with <code>XProcessHistory</code> objects
tracking all individual analysis steps that have been performed.</p></dd>


<dt><code>msFeatureData</code></dt>
<dd><p><code>MsFeatureData</code> class extending <code>environment</code>
and containing the results from a chromatographic peak detection (element
<code>"chromPeaks"</code>), peak grouping (element <code>"featureDefinitions"</code>)
and retention time correction (element <code>"adjustedRtime"</code>) steps.
This object should not be manipulated directly.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>"chromPeaks"</code> element in the <code>msFeatureData</code> slot is
    equivalent to the <code>@peaks</code> slot of the <code>xcmsSet</code> object, the
    <code>"featureDefinitions"</code> contains information from the <code>@groups</code>
    and <code>@groupidx</code> slots from an <code>xcmsSet</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="chromatographic-peak-data">Chromatographic peak data<a class="anchor" aria-label="anchor" href="#chromatographic-peak-data"></a></h2>
    


<p>Chromatographic peak data is added to an <code>XCMSnExp</code> object by the
<code><a href="findChromPeaks.html">findChromPeaks</a></code> function. Functions to access chromatographic
peak data are:</p>
<ul><li><p><code>hasChromPeaks</code> whether chromatographic peak data is available,
see below for help of the function.</p></li>
<li><p><code>chromPeaks</code> access chromatographic peaks (see below for help).</p></li>
<li><p><code>dropChromPeaks</code> remove chromatographic peaks (see below for
help).</p></li>
<li><p><code>dropFilledChromPeaks</code> remove filled-in peaks (see below for
help).</p></li>
<li><p><code><a href="fillChromPeaks.html">fillChromPeaks</a></code> fill-in missing peaks (see respective
help page).</p></li>
<li><p><code><a href="plotChromPeaks.html">plotChromPeaks</a></code> plot identified peaks for a file (see
respective help page).</p></li>
<li><p><code><a href="plotChromPeaks.html">plotChromPeakImage</a></code> plot distribution of peaks along the
retention time axis (see respective help page).</p></li>
<li><p><code><a href="highlightChromPeaks.html">highlightChromPeaks</a></code> add chromatographic peaks to an
existing plot of a <code><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></code> (see respective help page).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="adjusted-retention-times">Adjusted retention times<a class="anchor" aria-label="anchor" href="#adjusted-retention-times"></a></h2>
    


<p>Adjusted retention times are stored in an <code>XCMSnExp</code> object besides the
original, raw, retention times, allowing to switch between raw and adjusted
times. It is also possible to replace the raw retention times with the
adjusted ones with the <code><a href="applyAdjustedRtime.html">applyAdjustedRtime</a></code>. The adjusted
retention times are added to an <code>XCMSnExp</code> by the
<code><a href="adjustRtime.html">adjustRtime</a></code> function. All functions related to the access of
 adjusted retention times are:</p>
<ul><li><p><code>hasAdjustedRtime</code> whether adjusted retention times are available
(see below for help).</p></li>
<li><p><code>dropAdjustedRtime</code> remove adjusted retention times (see below
for help).</p></li>
<li><p><code><a href="applyAdjustedRtime.html">applyAdjustedRtime</a></code> replace the raw retention times with
the adjusted ones (see respective help page).</p></li>
<li><p><code><a href="plotAdjustedRtime.html">plotAdjustedRtime</a></code> plot differences between adjusted and
raw retention times (see respective help page).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="correspondence-results-features">Correspondence results, features<a class="anchor" aria-label="anchor" href="#correspondence-results-features"></a></h2>
    


<p>The correspondence analysis (<code><a href="groupChromPeaks.html">groupChromPeaks</a></code>) adds the feature
definitions to an <code>XCMSnExp</code> object. All functions related to these are
listed below:</p>
<ul><li><p><code>hasFeatures</code> whether correspondence results are available (see
below for help).</p></li>
<li><p><code>featureDefinitions</code> access the definitions of the features (see
below for help).</p></li>
<li><p><code>dropFeatureDefinitions</code> remove correspondence results (see below
for help).</p></li>
<li><p><code><a href="XCMSnExp-peak-grouping-results.html">featureValues</a></code> access values for features (see respective
help page).</p></li>
<li><p><code><a href="featureSummary.html">featureSummary</a></code> perform a simple summary of the defined
features (see respective help page).</p></li>
<li><p><code><a href="overlappingFeatures.html">overlappingFeatures</a></code> identify features that are
overlapping or close in the m/z - rt space (see respective help page).</p></li>
<li><p><code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">quantify</a></code> extract feature intensities and put them, along
with feature definitions and phenodata information, into a
<code>SummarizedExperiment</code>. See help page for details.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="xcmsSet-class.html">xcmsSet</a></code> for the old implementation.
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code>, <code><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">MSnExp</a></code>
    and <code><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html" class="external-link">pSet</a></code> for a complete list of inherited methods.</p>
<p><code><a href="findChromPeaks.html">findChromPeaks</a></code> for available peak detection methods
    returning a <code>XCMSnExp</code> object as a result.</p>
<p><code><a href="groupChromPeaks.html">groupChromPeaks</a></code> for available peak grouping
    methods and <code>featureDefinitions</code> for the method to extract
    the feature definitions representing the peak grouping results.
    <code><a href="adjustRtime.html">adjustRtime</a></code> for retention time adjustment methods.</p>
<p><code><a href="chromatogram-method.html">chromatogram</a></code> to extract MS data as
    <code><a href="https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html" class="external-link">Chromatogram</a></code> objects.</p>
<p><code><a href="https://lgatto.github.io/MSnbase/reference/mzRident2dfr.html" class="external-link">as</a></code> (<code>as(x, "data.frame")</code>) in the <code>MSnbase</code>
    package for the method to extract MS data as <code>data.frame</code>s.</p>
<p><code><a href="featureSummary.html">featureSummary</a></code> to calculate basic feature summaries.</p>
<p><code><a href="featureChromatograms.html">featureChromatograms</a></code> to extract chromatograms for each
    feature.</p>
<p><code><a href="chromPeakSpectra.html">chromPeakSpectra</a></code> to extract MS2 spectra with the m/z of
    the precursor ion within the m/z range of a peak and a retention time
    within its retention time range.</p>
<p><code><a href="featureSpectra.html">featureSpectra</a></code> to extract MS2 spectra associated with
    identified features.</p>
<p><code><a href="fillChromPeaks.html">fillChromPeaks</a></code> for the method to fill-in eventually
    missing chromatographic peaks for a feature in some samples.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load a test data set with detected peaks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Update the path to the files for the local system</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dirname.html">dirname</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf/KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Disable parallel processing for this example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The results from the peak detection are now stored in the XCMSnExp</span></span></span>
<span class="r-in"><span><span class="co">## object</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn experiment data ("XCMSnExp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object size in memory: 1.22 Mb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Spectra data - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s): 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of spectra: 3834 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MSn retention times: 41:41 - 74:60 minutes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Processing information - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data loaded [Tue Aug  1 15:54:19 2023] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter: select MS level(s) 1. [Tue Aug  1 15:54:19 2023] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MSnbase version: 2.26.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Meta data  - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rowNames: 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   varLabels: sampleNames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   varMetadata: labelDescription</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loaded from:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] ko15.CDF...  [3] ko18.CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Use 'fileNames(.)' to see all files.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> protocolData: none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   featureNames: F1.S0001 F1.S0002 ... F3.S1278 (3834 total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fvarMetadata: labelDescription</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> experimentData: use 'experimentData(object)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  248 peaks identified in 3 samples.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  On average 82.7 chromatographic peaks per sample.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The detected peaks can be accessed with the chromPeaks method.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">chromPeaks</span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The settings of the chromatographic peak detection can be accessed with</span></span></span>
<span class="r-in"><span><span class="co">## the processHistory method</span></span></span>
<span class="r-in"><span><span class="fu">processHistory</span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak detection </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Tue Aug  1 15:54:19 2023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2,3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s) 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Also the parameter class for the peak detection can be accessed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ProcessHistory-class.html">processParam</a></span><span class="op">(</span><span class="fu">processHistory</span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - ppm: [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - peakwidth: [1] 20 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - snthresh: [1] 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - prefilter: [1]     3 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzCenterFun: [1] "wMean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - integrate: [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzdiff: [1] -0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - fitgauss: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - noise: [1] 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - verboseColumns: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - roiList: list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - firstBaselineCheck: [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - roiScales: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - extendLengthMSW: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - verboseBetaColumns: [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The XCMSnExp inherits all methods from the pSet and OnDiskMSnExp classes</span></span></span>
<span class="r-in"><span><span class="co">## defined in Bioconductor's MSnbase package. To access the (raw) retention</span></span></span>
<span class="r-in"><span><span class="co">## time for each spectrum we can use the rtime method. Setting bySample = TRUE</span></span></span>
<span class="r-in"><span><span class="co">## would cause the retention times to be grouped by sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2501.378 2502.943 2504.508 2506.073 2507.638 2509.203 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Similarly it is possible to extract the mz values or the intensity values</span></span></span>
<span class="r-in"><span><span class="co">## using the mz and intensity method, respectively, also with the option to</span></span></span>
<span class="r-in"><span><span class="co">## return the results grouped by sample instead of the default, which is</span></span></span>
<span class="r-in"><span><span class="co">## grouped by spectrum. Finally, to extract all of the data we can use the</span></span></span>
<span class="r-in"><span><span class="co">## spectra method which returns Spectrum objects containing all raw data.</span></span></span>
<span class="r-in"><span><span class="co">## Note that all these methods read the information from the original input</span></span></span>
<span class="r-in"><span><span class="co">## files and subsequently apply eventual data processing steps to them.</span></span></span>
<span class="r-in"><span><span class="va">mzs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">faahko_sub</span>, bySample <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mzs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">mzs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1      2      3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 445769 440794 442516 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The full data could also be read using the spectra data, which returns</span></span></span>
<span class="r-in"><span><span class="co">## a list of Spectrum object containing the mz, intensity and rt values.</span></span></span>
<span class="r-in"><span><span class="co">## spctr &lt;- spectra(faahko_sub)</span></span></span>
<span class="r-in"><span><span class="co">## To get all spectra of the first file we can split them by file</span></span></span>
<span class="r-in"><span><span class="co">## head(split(spctr, fromFile(faahko_sub))[[1]])</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############</span></span></span>
<span class="r-in"><span><span class="co">## Filtering</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## XCMSnExp objects can be filtered by file, retention time, mz values or</span></span></span>
<span class="r-in"><span><span class="co">## MS level. For some of these filter preprocessing results (mostly</span></span></span>
<span class="r-in"><span><span class="co">## retention time correction and peak grouping results) will be dropped.</span></span></span>
<span class="r-in"><span><span class="co">## Below we filter the XCMSnExp object by file to extract the results for</span></span></span>
<span class="r-in"><span><span class="co">## only the second file.</span></span></span>
<span class="r-in"><span><span class="va">xod_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">filterFile</a></span><span class="op">(</span><span class="va">faahko_sub</span>, file <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xod_2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn experiment data ("XCMSnExp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object size in memory: 0.48 Mb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Spectra data - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s): 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of spectra: 1278 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MSn retention times: 41:41 - 74:60 minutes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Processing information - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data loaded [Tue Aug  1 15:54:19 2023] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter: select MS level(s) 1. [Tue Aug  1 15:54:19 2023] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter: select file(s) 2. [Thu Dec  7 08:42:31 2023] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MSnbase version: 2.26.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Meta data  - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rowNames: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   varLabels: sampleNames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   varMetadata: labelDescription</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loaded from:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ko16.CDF </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> protocolData: none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   featureNames: F2.S0001 F2.S0002 ... F2.S1278 (1278 total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fvarMetadata: labelDescription</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> experimentData: use 'experimentData(object)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100 peaks identified in 1 samples.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  On average 100 chromatographic peaks per sample.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now the objects contains only the idenfified peaks for the second file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">chromPeaks</span><span class="op">(</span><span class="va">xod_2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into        intb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP088 384.1 384.1 384.1 2603.100 2592.145 2614.054   274906.3   274885.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP089 533.3 533.3 533.3 2686.042 2681.347 2689.172    70456.3    70450.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP090 344.0 344.0 344.0 2686.042 2648.483 2714.211  5700652.0  5574744.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP091 366.0 366.0 366.0 2686.042 2639.094 2725.166  3448376.1  3338483.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP092 343.0 343.0 343.0 2686.042 2645.353 2717.341 26229546.1 25615117.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP093 365.0 365.0 365.0 2686.042 2639.094 2726.731 15565868.0 14884380.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         maxo    sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP088  15187 15186      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP089  11819 11818      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP090 151744    87      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP091  77640    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP092 692352    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP093 345536    48      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##########</span></span></span>
<span class="r-in"><span><span class="co">## Coercing to an xcmsSet object</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## We can also coerce the XCMSnExp object into an xcmsSet object:</span></span></span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">faahko_sub</span>, <span class="st">"xcmsSet"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: you might want to set/adjust the 'sampclass' of the returned xcmSet object before proceeding with the analysis.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="xcmsSet-class.html">peaks</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

