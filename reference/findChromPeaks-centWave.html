<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chromatographic peak detection using the centWave method — findChromPeaks-centWave • xcms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Chromatographic peak detection using the centWave method — findChromPeaks-centWave"><meta property="og:description" content="The centWave algorithm perform peak density and wavelet based
    chromatographic peak detection for high resolution LC/MS data in centroid
    mode [Tautenhahn 2008].
The CentWaveParam class allows to specify all settings
    for a chromatographic peak detection using the centWave method. Instances
    should be created with the CentWaveParam constructor.
The detectChromPeaks,OnDiskMSnExp,CentWaveParam method
    performs chromatographic peak detection using the centWave
    algorithm on all samples from an OnDiskMSnExp
    object. OnDiskMSnExp objects encapsule all
    experiment specific data and load the spectra data (mz and intensity
    values) on the fly from the original files applying also all eventual
    data manipulations.
ppm,ppm&amp;lt;-: getter and setter for the ppm
    slot of the object.
peakwidth,peakwidth&amp;lt;-: getter and setter for the
    peakwidth slot of the object.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
prefilter,prefilter&amp;lt;-: getter and setter for the
    prefilter slot of the object.
mzCenterFun,mzCenterFun&amp;lt;-: getter and setter for the
    mzCenterFun slot of the object.
integrate,integrate&amp;lt;-: getter and setter for the
    integrate slot of the object.
mzdiff,mzdiff&amp;lt;-: getter and setter for the
    mzdiff slot of the object.
fitgauss,fitgauss&amp;lt;-: getter and setter for the
    fitgauss slot of the object.
noise,noise&amp;lt;-: getter and setter for the
    noise slot of the object.
verboseColumns,verboseColumns&amp;lt;-: getter and
    setter for the verboseColumns slot of the object.
roiList,roiList&amp;lt;-: getter and setter for the
    roiList slot of the object.
fistBaselineCheck,firstBaselineCheck&amp;lt;-: getter
    and setter for the firstBaselineCheck slot of the object.
roiScales,roiScales&amp;lt;-: getter and setter for the
    roiScales slot of the object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.19.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chromatographic peak detection using the centWave method</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/DataClasses.R" class="external-link"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-Params.R" class="external-link"><code>R/functions-Params.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-OnDiskMSnExp.R" class="external-link"><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>findChromPeaks-centWave.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The centWave algorithm perform peak density and wavelet based
    chromatographic peak detection for high resolution LC/MS data in centroid
    mode [Tautenhahn 2008].</p>
<p>The <code>CentWaveParam</code> class allows to specify all settings
    for a chromatographic peak detection using the centWave method. Instances
    should be created with the <code>CentWaveParam</code> constructor.</p>
<p>The <code>detectChromPeaks,OnDiskMSnExp,CentWaveParam</code> method
    performs chromatographic peak detection using the <em>centWave</em>
    algorithm on all samples from an <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code>
    object. <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> objects encapsule all
    experiment specific data and load the spectra data (mz and intensity
    values) on the fly from the original files applying also all eventual
    data manipulations.</p>
<p><code>ppm</code>,<code>ppm&lt;-</code>: getter and setter for the <code>ppm</code>
    slot of the object.</p>
<p><code>peakwidth</code>,<code>peakwidth&lt;-</code>: getter and setter for the
    <code>peakwidth</code> slot of the object.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>prefilter</code>,<code>prefilter&lt;-</code>: getter and setter for the
    <code>prefilter</code> slot of the object.</p>
<p><code>mzCenterFun</code>,<code>mzCenterFun&lt;-</code>: getter and setter for the
    <code>mzCenterFun</code> slot of the object.</p>
<p><code>integrate</code>,<code>integrate&lt;-</code>: getter and setter for the
    <code>integrate</code> slot of the object.</p>
<p><code>mzdiff</code>,<code>mzdiff&lt;-</code>: getter and setter for the
    <code>mzdiff</code> slot of the object.</p>
<p><code>fitgauss</code>,<code>fitgauss&lt;-</code>: getter and setter for the
    <code>fitgauss</code> slot of the object.</p>
<p><code>noise</code>,<code>noise&lt;-</code>: getter and setter for the
    <code>noise</code> slot of the object.</p>
<p><code>verboseColumns</code>,<code>verboseColumns&lt;-</code>: getter and
    setter for the <code>verboseColumns</code> slot of the object.</p>
<p><code>roiList</code>,<code>roiList&lt;-</code>: getter and setter for the
    <code>roiList</code> slot of the object.</p>
<p><code>fistBaselineCheck</code>,<code>firstBaselineCheck&lt;-</code>: getter
    and setter for the <code>firstBaselineCheck</code> slot of the object.</p>
<p><code>roiScales</code>,<code>roiScales&lt;-</code>: getter and setter for the
    <code>roiScales</code> slot of the object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">CentWaveParam</span><span class="op">(</span>
  ppm <span class="op">=</span> <span class="fl">25</span>,
  peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>,
  snthresh <span class="op">=</span> <span class="fl">10</span>,
  prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">100</span><span class="op">)</span>,
  mzCenterFun <span class="op">=</span> <span class="st">"wMean"</span>,
  integrate <span class="op">=</span> <span class="fl">1L</span>,
  mzdiff <span class="op">=</span> <span class="op">-</span><span class="fl">0.001</span>,
  fitgauss <span class="op">=</span> <span class="cn">FALSE</span>,
  noise <span class="op">=</span> <span class="fl">0</span>,
  verboseColumns <span class="op">=</span> <span class="cn">FALSE</span>,
  roiList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  firstBaselineCheck <span class="op">=</span> <span class="cn">TRUE</span>,
  roiScales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  extendLengthMSW <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S4 method for OnDiskMSnExp,CentWaveParam</span>
<span class="fu"><a href="chromatographic-peak-detection.html">findChromPeaks</a></span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">param</span>,
  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,
  return.type <span class="op">=</span> <span class="st">"XCMSnExp"</span>,
  msLevel <span class="op">=</span> <span class="fl">1L</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">ppm</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">ppm</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">peakwidth</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">peakwidth</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">snthresh</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">snthresh</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">prefilter</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">prefilter</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">mzCenterFun</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">mzCenterFun</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">mzdiff</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">mzdiff</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">fitgauss</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">fitgauss</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">noise</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">noise</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">verboseColumns</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">verboseColumns</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">roiList</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">roiList</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">firstBaselineCheck</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">firstBaselineCheck</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">roiScales</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for CentWaveParam</span>
<span class="fu">roiScales</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ppm</dt>
<dd><p><code>numeric(1)</code> defining the maximal tolerated m/z deviation in
consecutive scans in parts per million (ppm) for the initial ROI
definition.</p></dd>
<dt>peakwidth</dt>
<dd><p><code>numeric(2)</code> with the expected approximate
peak width in chromatographic space. Given as a range (min, max)
in seconds.</p></dd>
<dt>snthresh</dt>
<dd><p><code>numeric(1)</code> defining the signal to noise ratio cutoff.</p></dd>
<dt>prefilter</dt>
<dd><p><code>numeric(2)</code>: <code>c(k, I)</code> specifying the prefilter
step for the first analysis step (ROI detection). Mass traces are only
retained if they contain at least <code>k</code> peaks with intensity
<code>&gt;= I</code>.</p></dd>
<dt>mzCenterFun</dt>
<dd><p>Name of the function to calculate the m/z center of the
chromatographic peak. Allowed are: <code>"wMean"</code>: intensity weighted
mean of the peak's m/z values, <code>"mean"</code>: mean of the peak's m/z
values, <code>"apex"</code>: use the m/z value at the peak apex,
<code>"wMeanApex3"</code>: intensity weighted mean of the m/z value at the
peak apex and the m/z values left and right of it and <code>"meanApex3"</code>:
mean of the m/z value of the peak apex and the m/z values left and right
of it.</p></dd>
<dt>integrate</dt>
<dd><p>Integration method. For <code>integrate = 1</code> peak limits
are found through descent on the mexican hat filtered data, for
<code>integrate = 2</code> the descent is done on the real data. The latter
method is more accurate but prone to noise, while the former is more
robust, but less exact.</p></dd>
<dt>mzdiff</dt>
<dd><p><code>numeric(1)</code> representing the minimum difference in m/z
dimension required for peaks with overlapping retention times; can be
negative to allow overlap. During peak post-processing, peaks
defined to be overlapping are reduced to the one peak with the largest
signal.</p></dd>
<dt>fitgauss</dt>
<dd><p><code>logical(1)</code> whether or not a Gaussian should be fitted
to each peak. This affects mostly the retention time position of the
peak.</p></dd>
<dt>noise</dt>
<dd><p><code>numeric(1)</code> allowing to set a minimum intensity required
for centroids to be considered in the first analysis step (centroids with
intensity <code>&lt; noise</code> are omitted from ROI detection).</p></dd>
<dt>verboseColumns</dt>
<dd><p><code>logical(1)</code> whether additional peak meta data
columns should be returned.</p></dd>
<dt>roiList</dt>
<dd><p>An optional list of regions-of-interest (ROI) representing
detected mass traces. If ROIs are submitted the first analysis step is
omitted and chromatographic peak detection is performed on the submitted
ROIs. Each ROI is expected to have the following elements specified:
<code>scmin</code> (start scan index), <code>scmax</code> (end scan index),
<code>mzmin</code> (minimum m/z), <code>mzmax</code> (maximum m/z), <code>length</code>
(number of scans), <code>intensity</code> (summed intensity). Each ROI should
be represented by a <code>list</code> of elements or a single row
<code>data.frame</code>.</p></dd>
<dt>firstBaselineCheck</dt>
<dd><p><code>logical(1)</code>. If <code>TRUE</code> continuous
data within regions of interest is checked to be above the first baseline.</p></dd>
<dt>roiScales</dt>
<dd><p>Optional numeric vector with length equal to <code>roiList</code>
defining the scale for each region of interest in <code>roiList</code> that
should be used for the centWave-wavelets.</p></dd>
<dt>extendLengthMSW</dt>
<dd><p>Option to force centWave to use all scales when
running centWave rather than truncating with the EIC length. Uses the "open"
method to extend the EIC to a integer base-2 length prior to being passed to
<code>convolve</code> rather than the default "reflect" method. See
https://github.com/sneumann/xcms/issues/445 for more information.</p></dd>
<dt>object</dt>
<dd><p>For <code>findChromPeaks</code>: an
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code>  object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></dd>
<dt>param</dt>
<dd><p>An <code>CentWaveParam</code> object containing all settings for the
centWave algorithm.</p></dd>
<dt>BPPARAM</dt>
<dd><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></dd>
<dt>return.type</dt>
<dd><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></dd>
<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></dd>
<dt>...</dt>
<dd><p>ignored.</p></dd>
<dt>value</dt>
<dd><p>The value for the slot.</p></dd>
<dt>f</dt>
<dd><p>For <code>integrate</code>: a <code>CentWaveParam</code> object.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The <code>CentWaveParam</code> function returns a <code>CentWaveParam</code>    class instance with all of the settings specified for chromatographic
    peak detection by the centWave method.
For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an
<code><a href="XCMSnExp-class.html">XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href="xcmsSet-class.html">xcmsSet</a></code> object
    with the results of the peak detection.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The centWave algorithm is most suitable for high resolution
LC/{TOF,OrbiTrap,FTICR}-MS data in centroid mode. In the first phase
the method identifies <em>regions of interest</em> (ROIs) representing
mass traces that are characterized as regions with less than <code>ppm</code>
m/z deviation in consecutive scans in the LC/MS map. In detail, starting
with a single m/z, a ROI is extended if a m/z can be found in the next scan
(spectrum) for which the difference to the mean m/z of the ROI is smaller
than the user defined <code>ppm</code> of the m/z. The mean m/z of the ROI is then
updated considering also the newly included m/z value.</p>
<p>These ROIs are then, after some cleanup, analyzed using continuous wavelet
transform (CWT) to locate chromatographic peaks on different scales.
The first analysis step is skipped, if regions of interest are passed
<em>via</em> the <code>param</code> parameter.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></code> method from the <code>BiocParallel</code>
    package.</p>
    </div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>ppm,peakwidth,snthresh,prefilter,mzCenterFun,integrate,mzdiff,fitgauss,noise,verboseColumns,roiList,firstBaselineCheck,roiScales,extendLengthMSW</code></dt>
<dd><p>See corresponding parameter above. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p></dd>


</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href="findPeaks-methods.html">findPeaks</a></code> methods. It supports peak detection on
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> objects (defined in the <code>MSnbase</code>
    package). All of the settings to the centWave algorithm can be passed
    with a <code>CentWaveParam</code> object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ralf Tautenhahn, Christoph B\"ottcher, and Steffen Neumann "Highly
sensitive feature detection for high resolution LC/MS" <em>BMC Bioinformatics</em>
2008, 9:504</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The <code><a href="do_findChromPeaks_centWave.html">do_findChromPeaks_centWave</a></code> core API function and
<code><a href="findPeaks.centWave-methods.html">findPeaks.centWave</a></code> for the old user interface.</p>
<p><code><a href="peaksWithCentWave.html">peaksWithCentWave</a></code> for functions to perform centWave peak
detection in purely chromatographic data.</p>
<p><code><a href="XCMSnExp-class.html">XCMSnExp</a></code> for the object containing the results of
    the peak detection.</p>
<p>Other peak detection methods: 
<code><a href="chromatographic-peak-detection.html">chromatographic-peak-detection</a></code>,
<code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href="findChromPeaks-massifquant.html">findChromPeaks-massifquant</a></code>,
<code><a href="findChromPeaks-matchedFilter.html">findChromPeaks-matchedFilter</a></code>,
<code><a href="findPeaks-MSW.html">findPeaks-MSW</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ralf Tautenhahn, Johannes Rainer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Create a CentWaveParam object. Note that the noise is set to 10000 to</span></span>
<span class="r-in"><span class="co">## speed up the execution of the example - in a real use case the default</span></span>
<span class="r-in"><span class="co">## value should be used, or it should be set to a reasonable value.</span></span>
<span class="r-in"><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu">CentWaveParam</span><span class="op">(</span>ppm <span class="op">=</span> <span class="fl">20</span>, noise <span class="op">=</span> <span class="fl">10000</span>, prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Change snthresh parameter</span></span>
<span class="r-in"><span class="fu">snthresh</span><span class="op">(</span><span class="va">cwp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span class="r-in"><span class="va">cwp</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - ppm: [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - peakwidth: [1] 20 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - snthresh: [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - prefilter: [1]     3 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzCenterFun: [1] "wMean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - integrate: [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzdiff: [1] -0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - fitgauss: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - noise: [1] 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - verboseColumns: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - roiList: list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - firstBaselineCheck: [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - roiScales: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - extendLengthMSW: [1] FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Perform the peak detection using centWave on some of the files from the</span></span>
<span class="r-in"><span class="co">## faahKO package. Files are read using the readMSData from the MSnbase</span></span>
<span class="r-in"><span class="co">## package</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf/KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">           full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span><span class="va">fls</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Perform the peak detection using the settings defined above.</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromatographic-peak-detection.html">findChromPeaks</a></span><span class="op">(</span><span class="va">raw_data</span>, param <span class="op">=</span> <span class="va">cwp</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting mass traces at 20 ppm ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting chromatographic peaks in 937 regions of interest ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  OK: 120 found.</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax      into      intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982 1007409.0 1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659  687146.6  671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517 5210015.9 5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 381.0 381.0 381.0 2678.218 2637.529 2720.472 2180565.2 2023571.9  52504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 430.1 430.1 430.1 2681.348 2639.094 2712.647 2395840.3 2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 366.0 366.0 366.0 2679.783 2642.224 2718.907 3365174.0 3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    37      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    49      1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

