<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Replace missing values with random numbers.
When using the method = "mean_sd", random numbers will be generated
from a normal distribution based
on (a fraction of) the row min and a standard deviation estimated from the
linear relationship between row standard deviation and mean of the full data
set. Parameter sd_fraction allows to further reduce the estimated
standard deviation.
When using the method method = "from_to", random numbers between 2 specific values
will be generated.'><title>Impute missing values with random numbers based on the row minimum — imputeRowMinRand • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Impute missing values with random numbers based on the row minimum — imputeRowMinRand"><meta property="og:description" content='Replace missing values with random numbers.
When using the method = "mean_sd", random numbers will be generated
from a normal distribution based
on (a fraction of) the row min and a standard deviation estimated from the
linear relationship between row standard deviation and mean of the full data
set. Parameter sd_fraction allows to further reduce the estimated
standard deviation.
When using the method method = "from_to", random numbers between 2 specific values
will be generated.'><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Impute missing values with random numbers based on the row minimum</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-imputation.R" class="external-link"><code>R/functions-imputation.R</code></a></small>
      <div class="d-none name"><code>imputeRowMinRand.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Replace missing values with random numbers.
When using the <code>method = "mean_sd"</code>, random numbers will be generated
from a normal distribution based
on (a fraction of) the row min and a standard deviation estimated from the
linear relationship between row standard deviation and mean of the full data
set. Parameter <code>sd_fraction</code> allows to further reduce the estimated
standard deviation.
When using the method <code>method = "from_to"</code>, random numbers between 2 specific values
will be generated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">imputeRowMinRand</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_sd"</span>, <span class="st">"from_to"</span><span class="op">)</span>,</span>
<span>  min_fraction <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  min_fraction_from <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  sd_fraction <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>matrix</code> with abundances, rows being features/metabolites and
columns samples.</p></dd>


<dt>method</dt>
<dd><p>method <code>character(1)</code> defining the imputation method.
See description for details. Defaults to <code>method = "mean_sd"</code>.</p></dd>


<dt>min_fraction</dt>
<dd><p><code>numeric(1)</code> with the fraction of the row minimum that
should be used to replace <code>NA</code> values in that row in case that <code>mean_sd</code>
method is specified. When  using <code>from_to</code> method, this value will be the
one used to calculate the maximum value for replace <code>NA</code> values in that row.</p></dd>


<dt>min_fraction_from</dt>
<dd><p><code>numeric(1)</code> with the fraction of the row minimum
that should be used to calculate the minimum value for replace <code>NA</code> values
in that row. This parameter is used only in case that <code>from_to</code> method is
specified.</p></dd>


<dt>sd_fraction</dt>
<dd><p><code>numeric(1)</code> factor to reduce the estimated standard
deviation. This parameter is used only in case that <code>mean_sd</code> method is
specified.</p></dd>


<dt>abs</dt>
<dd><p><code>logical(1)</code> to force imputed values to be strictly positive.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For method <strong>mean_sd</strong>, imputed
values are taken from a normal distribution with mean being a
user defined fraction of the row minimum and the standard deviation
estimated for that mean based on the linear relationship between row
standard deviations and row means in the full matrix <code>x</code>.</p>
<p>To largely avoid imputed values being negative or larger than the <em>real</em>
values, the standard deviation for the random number generation is estimated
ignoring the intercept of the linear model estimating the relationship
between standard deviation and mean. If <code>abs = TRUE</code> <code>NA</code> values are
replaced with the absolute value of the random values.</p>
<p>For method <strong>from_to</strong>, imputed values are taken between 2 user defined
fractions of the row minimum.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>imputeLCMD</code> package for more left censored imputation functions.</p>
<p>Other imputation functions: 
<code><a href="imputeRowMin.html">imputeRowMin</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer, Mar Garcia-Aloy</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"faahko"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xset</span> <span class="op">&lt;-</span> <span class="fu"><a href="group-methods.html">group</a></span><span class="op">(</span><span class="va">faahko</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupval-methods.html">groupval</a></span><span class="op">(</span><span class="va">xset</span>, value <span class="op">=</span> <span class="st">"into"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate the relationship between row sd and mean. The standard deviation</span></span></span>
<span class="r-in"><span><span class="co">## of the random distribution is estimated on this relationship.</span></span></span>
<span class="r-in"><span><span class="va">mns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">mat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mat</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mns</span>, <span class="va">sds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">sds</span> <span class="op">~</span> <span class="va">mns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="imputeRowMinRand-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat_imp_meansd</span> <span class="op">&lt;-</span> <span class="fu">imputeRowMinRand</span><span class="op">(</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"mean_sd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat_imp_fromto</span> <span class="op">&lt;-</span> <span class="fu">imputeRowMinRand</span><span class="op">(</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"from_to"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ko15      ko16       ko18      ko19       ko21      ko22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  147887.5  451600.7   65290.38        NA   91635.45  162012.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1778568.9 1567038.1 1482796.38 1039129.8 1223132.35 1072037.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    237993.6  269714.0  201393.42  150107.3  176989.65  156797.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  380873.0  460629.7  351750.14  219288.0  286848.56  235022.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  235544.9  173623.4         NA        NA  185792.43  174458.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517          NA        NA  222609.07  286232.1  435094.49        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 wt15       wt16       wt18       wt19      wt21       wt22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  175177.1   82619.48         NA   69198.22  153273.5   98144.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1950287.5 1466780.60 1572679.16 1275312.76 1356014.3 1231442.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    276541.8  222366.15  211717.71  186850.88  188285.9  172348.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  417169.6  324892.46  277990.70  220972.35  252874.0  236728.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  244584.5  161184.05   72029.38         NA  238194.4  173829.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517          NA         NA         NA  240261.21  201316.2  179437.72</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat_imp_meansd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  ko15       ko16       ko18       ko19       ko21       ko22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  147887.53  451600.71   65290.38   29228.64   91635.45  162012.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1778568.94 1567038.14 1482796.38 1039129.82 1223132.35 1072037.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    237993.62  269713.98  201393.42  150107.31  176989.65  156797.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  380873.05  460629.74  351750.14  219287.97  286848.56  235022.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  235544.92  173623.38   37404.32   42921.02  185792.43  174458.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517     52093.05   76516.41  222609.07  286232.15  435094.49   96407.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  wt15       wt16       wt18       wt19      wt21       wt22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  175177.08   82619.48   39281.34   69198.22  153273.5   98144.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1950287.49 1466780.60 1572679.16 1275312.76 1356014.3 1231442.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    276541.85  222366.15  211717.71  186850.88  188285.9  172348.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  417169.58  324892.46  277990.70  220972.35  252874.0  236728.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  244584.47  161184.05   72029.38   37584.60  238194.4  173829.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517     87879.78  101189.57   92076.38  240261.21  201316.2  179437.72</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat_imp_fromto</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  ko15       ko16       ko18       ko19       ko21       ko22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  147887.53  451600.71   65290.38   22187.04   91635.45  162012.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1778568.94 1567038.14 1482796.38 1039129.82 1223132.35 1072037.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    237993.62  269713.98  201393.42  150107.31  176989.65  156797.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  380873.05  460629.74  351750.14  219287.97  286848.56  235022.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  235544.92  173623.38   33774.45   12538.98  185792.43  174458.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517     78317.06   33691.98  222609.07  286232.15  435094.49   80359.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  wt15       wt16       wt18       wt19      wt21       wt22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200.1/2926  175177.08   82619.48   18310.31   69198.22  153273.5   98144.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205/2791   1950287.49 1466780.60 1572679.16 1275312.76 1356014.3 1231442.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206/2790    276541.85  222366.15  211717.71  186850.88  188285.9  172348.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207.1/2719  417169.58  324892.46  277990.70  220972.35  252874.0  236728.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 219.1/2525  244584.47  161184.05   72029.38   32750.16  238194.4  173829.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 231/2517     88895.62   24286.30   89067.98  240261.21  201316.2  179437.72</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

