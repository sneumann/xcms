<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Peak density and wavelet based feature detection aiming at isotope peaks for high resolution LC/MS data in centroid mode"><title>Feature detection based on predicted isotope features for high resolution LC/MS data — findPeaks.addPredictedIsotopeFeatures-methods • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Feature detection based on predicted isotope features for high resolution LC/MS data — findPeaks.addPredictedIsotopeFeatures-methods"><meta property="og:description" content="Peak density and wavelet based feature detection aiming at isotope peaks for high resolution LC/MS data in centroid mode"><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Feature detection based on predicted isotope features for high resolution LC/MS data</h1>
      
      <div class="d-none name"><code>findPeaks.addPredictedIsotopeFeatures-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Peak density and wavelet based feature detection aiming at isotope peaks for high resolution LC/MS data in centroid mode</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<dl><dt>object = "xcmsRaw"</dt>
<dd><p><code>
    findPeaks.centWave(object, ppm=25, peakwidth=c(20,50),
    prefilter=c(3,100), mzCenterFun="wMean", integrate=1, mzdiff=-0.001, fitgauss=FALSE,
    scanrange= numeric(), noise=0, sleep=0, verbose.columns=FALSE, xcmsPeaks, snthresh=6.25, maxcharge=3, maxiso=5, mzIntervalExtension=TRUE)
  </code></p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This algorithm is most suitable for high resolution LC/{TOF,OrbiTrap,FTICR}-MS data in centroid mode. In the first phase of the method isotope ROIs (regions of interest) in the LC/MS map are predicted.
  In the second phase these mass traces are further analysed.
  Continuous wavelet transform (CWT) is used to locate chromatographic peaks on different scales.
  The resulting peak list and the given peak list (<code>xcmsPeaks</code>) are merged and redundant peaks are removed.</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>xcmsSet</code> object</p></dd>

  <dt>ppm</dt>
<dd><p>maxmial tolerated m/z deviation in consecutive scans, in ppm (parts per million)</p></dd>

  <dt>peakwidth</dt>
<dd><p>Chromatographic peak width, given as range (min,max) in seconds</p></dd>

  <dt>prefilter</dt>
<dd><p><code>prefilter=c(k,I)</code>. Prefilter step for the first phase. Mass traces are only retained if they contain at least <code>k</code> peaks with intensity &gt;= <code>I</code>.</p></dd>

  <dt>mzCenterFun</dt>
<dd><p>Function to calculate the m/z center of the feature: <code>wMean</code> intensity weighted mean of the feature m/z values, <code>mean</code> mean of the feature m/z values, <code>apex</code> use m/z value at peak apex,
        <code>wMeanApex3</code> intensity weighted mean of the m/z value at peak apex and the m/z value left and right of it, <code>meanApex3</code> mean of the m/z value at peak apex and the m/z value left and right of it.</p></dd>

  <dt>integrate</dt>
<dd><p>Integration method. If <code>=1</code> peak limits are found through descent on the mexican hat filtered data, if <code>=2</code> the descent is done on the real data. Method 2 is very accurate but prone to noise, while method 1 is more robust to noise but less exact.</p></dd>

  <dt>mzdiff</dt>
<dd><p>minimum difference in m/z for peaks with overlapping retention
    times, can be negative to allow overlap</p></dd>

  <dt>fitgauss</dt>
<dd><p>logical, if TRUE a Gaussian is fitted to each peak</p></dd>

  <dt>scanrange</dt>
<dd><p>scan range to process</p></dd>

  <dt>noise</dt>
<dd><p>optional argument which is useful for data that was centroided without any intensity threshold,
    centroids with intensity &lt; <code>noise</code> are omitted from ROI detection</p></dd>

  <dt>sleep</dt>
<dd><p>number of seconds to pause between plotting peak finding cycles</p></dd>

  <dt>verbose.columns</dt>
<dd><p>logical, if TRUE additional peak meta data columns are returned</p></dd>

  <dt>xcmsPeaks</dt>
<dd><p>peak list picked using the <code>centWave</code> algorithm with parameter <code>verbose.columns</code> set to TRUE (columns <code>scmin</code> and <code>scmax</code> needed)</p></dd>

  <dt>snthresh</dt>
<dd><p>signal to noise ratio cutoff, definition see below.</p></dd>

  <dt>maxcharge</dt>
<dd><p>max. number of the isotope charge.</p></dd>

  <dt>maxiso</dt>
<dd><p>max. number of the isotope peaks to predict for each detected feature.</p></dd>

  <dt>mzIntervalExtension</dt>
<dd><p>logical, if TRUE predicted isotope ROIs (regions of interest) are extended in the m/z dimension to increase the detection of low intensity and hence noisy peaks.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix with columns:</p>
<dl><dt>mz</dt>
<dd><p>weighted (by intensity) mean of peak m/z across scans</p></dd>

  <dt>mzmin</dt>
<dd><p>m/z peak minimum</p></dd>

  <dt>mzmax</dt>
<dd><p>m/z peak maximum</p></dd>

  <dt>rt</dt>
<dd><p>retention time of peak midpoint</p></dd>

  <dt>rtmin</dt>
<dd><p>leading edge of peak retention time</p></dd>

  <dt>rtmax</dt>
<dd><p>trailing edge of peak retention time</p></dd>

  <dt>into</dt>
<dd><p>integrated peak intensity</p></dd>

   <dt>intb</dt>
<dd><p>baseline corrected integrated peak intensity</p></dd>

  <dt>maxo</dt>
<dd><p>maximum peak intensity</p></dd>

  <dt>sn</dt>
<dd><p>Signal/Noise ratio, defined as <code>(maxo - baseline)/sd</code>, where <br><code>maxo</code> is the maximum peak intensity, <br><code>baseline</code> the estimated baseline value and <br><code>sd</code> the standard deviation of local chromatographic noise.</p></dd>

  <dt>egauss</dt>
<dd><p>RMSE of Gaussian fit</p></dd>


</dl><p>if <code>verbose.columns</code> is <code>TRUE</code> additionally :</p>
<dl><dt>mu</dt>
<dd><p>Gaussian parameter mu</p></dd>

  <dt>sigma</dt>
<dd><p>Gaussian parameter sigma</p></dd>

  <dt>h</dt>
<dd><p>Gaussian parameter h</p></dd>

  <dt>f</dt>
<dd><p>Region number of m/z ROI where the peak was localised</p></dd>

  <dt>dppm</dt>
<dd><p>m/z deviation of mass trace across scans in ppm</p></dd>

  <dt>scale</dt>
<dd><p>Scale on which the peak was localised</p></dd>

  <dt>scpos</dt>
<dd><p>Peak position found by wavelet analysis</p></dd>

  <dt>scmin</dt>
<dd><p>Left peak limit found by wavelet analysis (scan number)</p></dd>

  <dt>scmax</dt>
<dd><p>Right peak limit found by wavelet analysis (scan number)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ralf Tautenhahn</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ralf Tautenhahn, Christoph B\"ottcher, and Steffen Neumann
  "Highly sensitive feature detection for high resolution LC/MS"
  BMC Bioinformatics 2008, 9:504\
  Hendrik Treutler and Steffen Neumann.
  "Prediction, detection, and validation of isotope clusters in mass spectrometry data"
  Submitted to Metabolites 2016, Special Issue "Bioinformatics and Data Analysis"</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="findPeaks.centWave-methods.html">findPeaks.centWave</a></code>
  <code><a href="findPeaks-methods.html">findPeaks-methods</a></code>
  <code><a href="xcmsRaw-class.html">xcmsRaw-class</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

