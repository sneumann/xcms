<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extract an ion chromatogram (EIC) for each chromatographic peak in an
XcmsExperiment() object. The result is returned as an XChromatograms()
of length equal to the number of chromatographic peaks (and one column)."><title>Extract an ion chromatogram for each chromatographic peak — chromPeakChromatograms • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract an ion chromatogram for each chromatographic peak — chromPeakChromatograms"><meta property="og:description" content="Extract an ion chromatogram (EIC) for each chromatographic peak in an
XcmsExperiment() object. The result is returned as an XChromatograms()
of length equal to the number of chromatographic peaks (and one column)."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract an ion chromatogram for each chromatographic peak</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/XcmsExperiment.R" class="external-link"><code>R/XcmsExperiment.R</code></a></small>
      <div class="d-none name"><code>chromPeakChromatograms.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract an ion chromatogram (EIC) for each chromatographic peak in an
<code><a href="XcmsExperiment.html">XcmsExperiment()</a></code> object. The result is returned as an <code><a href="XChromatogram.html">XChromatograms()</a></code>
of length equal to the number of chromatographic peaks (and one column).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chromPeakChromatograms</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XcmsExperiment</span></span>
<span><span class="fu">chromPeakChromatograms</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  expandRt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  expandMz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  aggregationFun <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"XChromatograms"</span>, <span class="st">"MChromatograms"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  progressbar <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <code><a href="XcmsExperiment.html">XcmsExperiment()</a></code> with identified chromatographic peaks.</p></dd>


<dt>...</dt>
<dd><p>currently ignored.</p></dd>


<dt>expandRt</dt>
<dd><p><code>numeric(1)</code> to eventually expand the retention time range
from which the signal should be integrated. The chromatogram will
contain signal from <code>chromPeaks[, "rtmin"] - expandRt</code> to
<code>chromPeaks[, "rtmax"] + expandRt</code>. The default is <code>expandRt = 0</code>.</p></dd>


<dt>expandMz</dt>
<dd><p><code>numeric(1)</code> to eventually expand the m/z range
from which the signal should be integrated. The chromatogram will
contain signal from <code>chromPeaks[, "mzmin"] - expandMz</code> to
<code>chromPeaks[, "mzmax"] + expandMz</code>. The default is <code>expandMz = 0</code>.</p></dd>


<dt>aggregationFun</dt>
<dd><p><code>character(1)</code> defining the function how signals
within the m/z range in each spectrum (i.e. for each discrete retention
time) should be aggregated. The default (<code>aggregationFun = "max"</code>)
reports the largest signal for each spectrum.</p></dd>


<dt>peaks</dt>
<dd><p>optional <code>character</code> providing the IDs of the chromatographic
peaks (i.e. the row names of the peaks in <code>chromPeaks(object)</code>) for
which chromatograms should be returned.</p></dd>


<dt>return.type</dt>
<dd><p><code>character(1)</code> specifying the type of the returned object.
Can be either <code>return.type = "XChromatograms"</code> (the default) or
<code>return.type = "MChromatograms"</code> to return either a chromatographic
object with or without the identified chromatographic peaks,
respectively.</p></dd>


<dt>progressbar</dt>
<dd><p><code>logical(1)</code> whether the progress of the extraction
process should be displayed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="featureChromatograms.html">featureChromatograms()</a></code> to extract an EIC for each feature.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load a test data set with detected peaks</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadXcmsData.html">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get EICs for every detected chromatographic peak</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu">chromPeakChromatograms</span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chrs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> XChromatograms with 248 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;XChromatogram&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]          peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]          peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...               ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [247,]        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [248,]        peaks: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phenoData with 2 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> featureData with 5 variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - xcms preprocessing - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chromatographic peak detection:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  method: centWave </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Order of EICs matches the order in chromPeaks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## variable "sample_index" provides the index of the sample the EIC was</span></span></span>
<span class="r-in"><span><span class="co">## extracted from</span></span></span>
<span class="r-in"><span><span class="fu">fData</span><span class="op">(</span><span class="va">chrs</span><span class="op">)</span><span class="op">$</span><span class="va">sample_index</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [186] 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [223] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the EIC for selected peaks only.</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pks</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CP006" "CP012"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Expand the data on retention time dimension by 15 seconds (on each side)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">chromPeakChromatograms</span><span class="op">(</span><span class="va">faahko_sub</span>, peaks <span class="op">=</span> <span class="va">pks</span>, expandRt <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chromPeakChromatograms-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

