<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Integrate areas of missing peaks — FillChromPeaksParam-class • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Integrate areas of missing peaks — FillChromPeaksParam-class" />
<meta property="og:description" content="The FillChromPeaksParam object encapsules all settings for
the signal integration for missing peaks.
expandMz,expandMz&amp;lt;-: getter and setter
    for the expandMz slot of the object.
expandRt,expandRt&amp;lt;-: getter and setter
    for the expandRt slot of the object.
ppm,ppm&amp;lt;-: getter and setter
    for the ppm slot of the object.
Integrate signal in the mz-rt area of a feature (chromatographic
peak group) for samples in which no chromatographic peak for this
feature was identified and add it to the chromPeaks. Such peaks
will have a TRUE in column &quot;is_filled&quot; in the
chromPeakData data frame containing peak annotations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integrate areas of missing peaks</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-Params.R'><code>R/methods-Params.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>fillChromPeaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>FillChromPeaksParam</code> object encapsules all settings for
the signal integration for missing peaks.</p>
<p><code>expandMz</code>,<code>expandMz&lt;-</code>: getter and setter
    for the <code>expandMz</code> slot of the object.</p>
<p><code>expandRt</code>,<code>expandRt&lt;-</code>: getter and setter
    for the <code>expandRt</code> slot of the object.</p>
<p><code>ppm</code>,<code>ppm&lt;-</code>: getter and setter
    for the <code>ppm</code> slot of the object.</p>
<p>Integrate signal in the mz-rt area of a feature (chromatographic
peak group) for samples in which no chromatographic peak for this
feature was identified and add it to the <code>chromPeaks</code>. Such peaks
will have a <code>TRUE</code> in column <code>"is_filled"</code> in the
<code>chromPeakData</code> data frame containing peak annotations.</p>
    </div>

    <pre class="usage"><span class='fu'>FillChromPeaksParam</span>(
  <span class='kw'>expandMz</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>expandRt</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>fixedMz</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>fixedRt</span> <span class='kw'>=</span> <span class='fl'>0</span>
)

<span class='fu'>fixedRt</span>(<span class='no'>object</span>)

<span class='fu'>fixedMz</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'>expandMz</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'>expandMz</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'>expandRt</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'>expandRt</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for FillChromPeaksParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp,FillChromPeaksParam</span>
<span class='fu'>fillChromPeaks</span>(<span class='no'>object</span>, <span class='no'>param</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>())

<span class='co'># S4 method for XCMSnExp,missing</span>
<span class='fu'>fillChromPeaks</span>(<span class='no'>object</span>, <span class='no'>param</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>(), <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>expandMz</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the value by which the mz width of
peaks should be expanded. Each peak is expanded in mz direction by
<code>expandMz *</code> their original mz width. A value of <code>0</code> means no
expansion, a value of <code>1</code> grows each peak by 1 * the mz width of
the peak resulting in peakswith twice their original size in mz
direction (expansion by half mz width to both sides).</p></td>
    </tr>
    <tr>
      <th>expandRt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>, same as <code>expandMz</code> but for the
retention time width.</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> optionally specifying a <em>ppm</em> by which the
mz width of the peak region should be expanded. For peaks with an mz
width smaller than <code>mean(c(mzmin, mzmax)) * ppm / 1e6</code>, the
<code>mzmin</code> will be replaced by
<code>mean(c(mzmin, mzmax)) - (mean(c(mzmin, mzmax)) * ppm / 2 / 1e6)</code>
and <code>mzmax</code> by
<code>mean(c(mzmin, mzmax)) + (mean(c(mzmin, mzmax)) * ppm / 2 / 1e6)</code>.
This is applied before eventually expanding the mz width using the
<code>expandMz</code> parameter.</p></td>
    </tr>
    <tr>
      <th>fixedMz</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining a constant factor by which the
m/z width of each feature is to be expanded. The m/z width is expanded
on both sides by <code>fixedMz</code> (i.e. <code>fixedMz</code> is subtracted
from the lower m/z and added to the upper m/z). This expansion is
applied <em>after</em> <code>expandMz</code> and <code>ppm</code>.</p></td>
    </tr>
    <tr>
      <th>fixedRt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining a constant factor by which the
retention time width of each factor is to be expanded. The rt width is
expanded on both sides by <code>fixedRt</code> (i.e. <code>fixedRt</code> is
subtracted from the lower rt and added to the upper rt). This
expansion is applied <em>after</em> <code>expandRt</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p><code>XCMSnExp</code> object with identified and grouped
chromatographic peaks.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A <code>FillChromPeaksParam</code> object with all settings.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the MS level on which peak filling
should be performed (defaults to <code>msLevel = 1L</code>). Only peak filling
on one MS level at a time is supported, to fill in peaks for MS level 1
and 2 run first using <code>msLevel = 1</code> and then (on the returned
result object) again with <code>msLevel = 2</code>.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>Parallel processing settings.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>FillChromPeaksParam</code> function returns a
    <code>FillChromPeaksParam</code> object.</p>
<p>A <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object with previously missing
chromatographic peaks for features filled into its <code>chromPeaks</code>
matrix.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>After correspondence (i.e. grouping of chromatographic peaks across
samples) there will always be features (peak groups) that do not include
peaks from every sample. The <code>fillChromPeaks</code> method defines
intensity values for such features in the missing samples by integrating
the signal in the mz-rt region of the feature. The mz-rt area is defined
by the median mz and rt start and end points of the other detected
chromatographic peaks for a given feature. Various parameters allow to
increase this area, either by a constant value (<code>fixedMz</code> and
<code>fixedRt</code>) or by a feature-relative amount (<code>expandMz</code> and
<code>expandRt</code>).</p>
<p>Adjusted retention times will be used if available.</p>
<p>Based on the peak finding algorithm that was used to identify the
(chromatographic) peaks different internal functions are employed to
guarantee that the integrated peak signal matches as much as possible
the peak signal integration used during the peak detection. For peaks
identified with the <code><a href='findChromPeaks-matchedFilter.html'>matchedFilter</a></code> method, signal
integration is performed on the <em>profile matrix</em> generated with
the same settings used also during peak finding (using the same
<code>bin</code> size for example). For direct injection data and peaks
identified with the <code><a href='findPeaks-MSW.html'>MSW</a></code> algorithm signal is integrated
only along the mz dimension. For all other methods the complete (raw)
signal within the area defined by <code>"mzmin"</code>, <code>"mzmax"</code>,
<code>"rtmin"</code> and <code>"rtmax"</code> is used.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>.__classVersion__,expandMz,expandRt,ppm,fixedMz,fixedRt</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores the version of the class.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The reported <code>"mzmin"</code>, <code>"mzmax"</code>, <code>"rtmin"</code> and
<code>"rtmax"</code> for the filled peaks represents the actual MS area from
which the signal was integrated.
Note that no peak is filled in if no signal was present in a file/sample
in the respective mz-rt area. These samples will still show a <code>NA</code>
in the matrix returned by the <code><a href='XCMSnExp-peak-grouping-results.html'>featureValues</a></code> method. This
is in contrast to the <code><a href='fillPeaks.chrom-methods.html'>fillPeaks.chrom</a></code> method that returned
an <code>"into"</code> and <code>"maxo"</code> of <code>0</code> for such peak areas.
Growing the mz-rt area using the <code>expandMz</code> and <code>expandRt</code>
might help to reduce the number of missing peak signals after filling.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='groupChromPeaks.html'>groupChromPeaks</a></code> for methods to perform the
    correspondence.
    <code><a href='XCMSnExp-class.html'>dropFilledChromPeaks</a></code> for the method to remove filled in peaks.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Perform the peak detection using centWave on some of the files from the</span>
<span class='co'>## faahKO package. Files are read using the readMSData from the MSnbase</span>
<span class='co'>## package</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>xcms</span>)
<span class='no'>fls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>raw_data</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='no'>fls</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'>
<span class='co'>## Create a CentWaveParam object. Note that the noise is set to 10000 to</span>
<span class='co'>## speed up the execution of the example - in a real use case the default</span>
<span class='co'>## value should be used, or it should be set to a reasonable value.</span>
<span class='no'>cwp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='findChromPeaks-centWave.html'>CentWaveParam</a></span>(<span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>prefilter</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>10000</span>),
    <span class='kw'>noise</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>40</span>)

<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>cwp</span>)

<span class='co'>## Perform the correspondence. We assign all samples to the same group.</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='groupChromPeaks.html'>groupChromPeaks</a></span>(<span class='no'>res</span>,
    <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'>fileNames</span>(<span class='no'>res</span>)))))</div><div class='output co'>#&gt; <span class='message'>Processing 2572 mz slices ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## For how many features do we lack an integrated peak signal?</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='fu'><a href='XCMSnExp-peak-grouping-results.html'>featureValues</a></span>(<span class='no'>res</span>)))</div><div class='output co'>#&gt; [1] 105</div><div class='input'>
<span class='co'>## Filling missing peak data using default settings.</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>fillChromPeaks</span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; <span class='message'>Defining peak areas for filling-in .</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'> OK</span>
#&gt; <span class='message'>Start integrating peak areas from original files</span></div><div class='input'>
<span class='co'>## Get the peaks that have been filled in:</span>
<span class='no'>fp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res</span>)[<span class='fu'><a href='XCMSnExp-class.html'>chromPeakData</a></span>(<span class='no'>res</span>)$<span class='no'>is_filled</span>, ]
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>fp</span>)</div><div class='output co'>#&gt;          mz mzmin mzmax       rt    rtmin    rtmax       into intb  maxo sn
#&gt; CP188 280.1 280.1 280.1 3319.849 3297.939 3348.018 123710.780   NA  5546 NA
#&gt; CP189 286.2 286.2 286.2 3252.556 3246.296 3280.725 891050.689   NA 78048 NA
#&gt; CP190 300.1 300.1 300.1 3623.450 3623.449 3631.274   5144.155   NA  3287 NA
#&gt; CP191 301.2 301.2 301.2 3379.317 3379.317 3410.616 523424.132   NA 46152 NA
#&gt; CP192 307.1 307.1 307.1 3133.619 3121.099 3164.918 112106.217   NA  5701 NA
#&gt; CP193 308.1 308.1 308.1 3250.991 3241.601 3285.419 290227.712   NA 15800 NA
#&gt;       sample
#&gt; CP188      1
#&gt; CP189      1
#&gt; CP190      1
#&gt; CP191      1
#&gt; CP192      1
#&gt; CP193      1</div><div class='input'>
<span class='co'>## Did we get a signal for all missing peaks?</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='fu'><a href='XCMSnExp-peak-grouping-results.html'>featureValues</a></span>(<span class='no'>res</span>)))</div><div class='output co'>#&gt; [1] 21</div><div class='input'>
<span class='co'>## No.</span>

<span class='co'>## Get the process history step along with the parameters used to perform</span>
<span class='co'>## The peak filling:</span>
<span class='no'>ph</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='XCMSnExp-class.html'>processHistory</a></span>(<span class='no'>res</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"Missing peak filling"</span>)<span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>ph</span></div><div class='output co'>#&gt; Object of class "XProcessHistory"
#&gt;  type: Missing peak filling 
#&gt;  date: Wed May 20 05:36:40 2020 
#&gt;  info:  
#&gt;  fileIndex: 1,2 
#&gt;  Parameter class: FillChromPeaksParam 
#&gt;  MS level(s) 1 </div><div class='input'>
<span class='co'>## The parameter class:</span>
<span class='no'>ph</span>@<span class='kw'>param</span></div><div class='output co'>#&gt; Object of class:  FillChromPeaksParam 
#&gt; Parameters:
#&gt;  expandMz: 0 
#&gt;  expandRt: 0 
#&gt;  ppm: 0 </div><div class='input'>
<span class='co'>## Drop the filled in peaks:</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='XCMSnExp-class.html'>dropFilledChromPeaks</a></span>(<span class='no'>res</span>)

<span class='co'>## Perform the peak filling with modified settings: allow expansion of the</span>
<span class='co'>## mz range by a specified ppm and expanding the mz range by mz width/2</span>
<span class='no'>prm</span> <span class='kw'>&lt;-</span> <span class='fu'>FillChromPeaksParam</span>(<span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>40</span>, <span class='kw'>expandMz</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>fillChromPeaks</span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>prm</span>)</div><div class='output co'>#&gt; <span class='message'>Defining peak areas for filling-in .</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'> OK</span>
#&gt; <span class='message'>Start integrating peak areas from original files</span></div><div class='input'>
<span class='co'>## Did we get a signal for all missing peaks?</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='fu'><a href='XCMSnExp-peak-grouping-results.html'>featureValues</a></span>(<span class='no'>res</span>)))</div><div class='output co'>#&gt; [1] 21</div><div class='input'>
## Still the same missing peaks.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


