<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform peak detection in mass spectrometry
    direct injection spectrum using a wavelet based algorithm.
The MSWParam class allows to specify all
    settings for a peak detection using the MSW method. Instances should be
    created with the MSWParam constructor.
The findChromPeaks,OnDiskMSnExp,MSWParam
    method performs peak detection in single-spectrum non-chromatography MS
    data using functionality from the MassSpecWavelet package on all
    samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
verboseColumns,verboseColumns&amp;lt;-: getter and setter
    for the verboseColumns slot of the object.
scales,scales&amp;lt;-: getter and setter for the
    scales slot of the object.
nearbyPeak,nearbyPeak&amp;lt;-: getter and setter for the
    nearbyPeak slot of the object.
peakScaleRange,peakScaleRange&amp;lt;-: getter and setter
    for the peakScaleRange slot of the object.
ampTh,ampTh&amp;lt;-: getter and setter for the
    ampTh slot of the object.
minNoiseLevel,minNoiseLevel&amp;lt;-: getter and setter
    for the minNoiseLevel slot of the object.
ridgeLength,ridgeLength&amp;lt;-: getter and setter for
    the ridgeLength slot of the object.
peakThr,peakThr&amp;lt;-: getter and setter for the
    peakThr slot of the object.
tuneIn,tuneIn&amp;lt;-: getter and setter for the
    tuneIn slot of the object.
addParams,addParams&amp;lt;-: getter and setter for the
    addParams slot of the object. This slot stores optional additional
    parameters to be passed to the
    identifyMajorPeaks and
    peakDetectionCWT functions from the
    MassSpecWavelet package."><title>Single-spectrum non-chromatography MS data peak detection — findPeaks-MSW • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single-spectrum non-chromatography MS data peak detection — findPeaks-MSW"><meta property="og:description" content="Perform peak detection in mass spectrometry
    direct injection spectrum using a wavelet based algorithm.
The MSWParam class allows to specify all
    settings for a peak detection using the MSW method. Instances should be
    created with the MSWParam constructor.
The findChromPeaks,OnDiskMSnExp,MSWParam
    method performs peak detection in single-spectrum non-chromatography MS
    data using functionality from the MassSpecWavelet package on all
    samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
verboseColumns,verboseColumns&amp;lt;-: getter and setter
    for the verboseColumns slot of the object.
scales,scales&amp;lt;-: getter and setter for the
    scales slot of the object.
nearbyPeak,nearbyPeak&amp;lt;-: getter and setter for the
    nearbyPeak slot of the object.
peakScaleRange,peakScaleRange&amp;lt;-: getter and setter
    for the peakScaleRange slot of the object.
ampTh,ampTh&amp;lt;-: getter and setter for the
    ampTh slot of the object.
minNoiseLevel,minNoiseLevel&amp;lt;-: getter and setter
    for the minNoiseLevel slot of the object.
ridgeLength,ridgeLength&amp;lt;-: getter and setter for
    the ridgeLength slot of the object.
peakThr,peakThr&amp;lt;-: getter and setter for the
    peakThr slot of the object.
tuneIn,tuneIn&amp;lt;-: getter and setter for the
    tuneIn slot of the object.
addParams,addParams&amp;lt;-: getter and setter for the
    addParams slot of the object. This slot stores optional additional
    parameters to be passed to the
    identifyMajorPeaks and
    peakDetectionCWT functions from the
    MassSpecWavelet package."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single-spectrum non-chromatography MS data peak detection</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/DataClasses.R" class="external-link"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-Params.R" class="external-link"><code>R/functions-Params.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-OnDiskMSnExp.R" class="external-link"><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>findPeaks-MSW.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform peak detection in mass spectrometry
    direct injection spectrum using a wavelet based algorithm.</p>
<p>The <code>MSWParam</code> class allows to specify all
    settings for a peak detection using the MSW method. Instances should be
    created with the <code>MSWParam</code> constructor.</p>
<p>The <code>findChromPeaks,OnDiskMSnExp,MSWParam</code>
    method performs peak detection in single-spectrum non-chromatography MS
    data using functionality from the <code>MassSpecWavelet</code> package on all
    samples from an <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> object.
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>verboseColumns</code>,<code>verboseColumns&lt;-</code>: getter and setter
    for the <code>verboseColumns</code> slot of the object.</p>
<p><code>scales</code>,<code>scales&lt;-</code>: getter and setter for the
    <code>scales</code> slot of the object.</p>
<p><code>nearbyPeak</code>,<code>nearbyPeak&lt;-</code>: getter and setter for the
    <code>nearbyPeak</code> slot of the object.</p>
<p><code>peakScaleRange</code>,<code>peakScaleRange&lt;-</code>: getter and setter
    for the <code>peakScaleRange</code> slot of the object.</p>
<p><code>ampTh</code>,<code>ampTh&lt;-</code>: getter and setter for the
    <code>ampTh</code> slot of the object.</p>
<p><code>minNoiseLevel</code>,<code>minNoiseLevel&lt;-</code>: getter and setter
    for the <code>minNoiseLevel</code> slot of the object.</p>
<p><code>ridgeLength</code>,<code>ridgeLength&lt;-</code>: getter and setter for
    the <code>ridgeLength</code> slot of the object.</p>
<p><code>peakThr</code>,<code>peakThr&lt;-</code>: getter and setter for the
    <code>peakThr</code> slot of the object.</p>
<p><code>tuneIn</code>,<code>tuneIn&lt;-</code>: getter and setter for the
    <code>tuneIn</code> slot of the object.</p>
<p><code>addParams</code>,<code>addParams&lt;-</code>: getter and setter for the
    <code>addParams</code> slot of the object. This slot stores optional additional
    parameters to be passed to the
    <code>identifyMajorPeaks</code> and
    <code>peakDetectionCWT</code> functions from the
    <code>MassSpecWavelet</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MSWParam</span><span class="op">(</span></span>
<span>  snthresh <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  verboseColumns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">64</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nearbyPeak <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  peakScaleRange <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  ampTh <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  minNoiseLevel <span class="op">=</span> <span class="va">ampTh</span><span class="op">/</span><span class="va">snthresh</span>,</span>
<span>  ridgeLength <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  peakThr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tuneIn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OnDiskMSnExp,MSWParam</span></span>
<span><span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="st">"XCMSnExp"</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">verboseColumns</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">verboseColumns</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">scales</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">scales</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">nearbyPeak</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">nearbyPeak</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">peakScaleRange</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">peakScaleRange</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">ampTh</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">ampTh</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">minNoiseLevel</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">minNoiseLevel</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">ridgeLength</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">ridgeLength</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">peakThr</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">peakThr</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">tuneIn</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">tuneIn</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">addParams</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MSWParam</span></span>
<span><span class="fu">addParams</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>snthresh</dt>
<dd><p><code>numeric(1)</code> defining the signal to noise ratio cutoff.</p></dd>


<dt>verboseColumns</dt>
<dd><p><code>logical(1)</code> whether additional peak meta data
columns should be returned.</p></dd>


<dt>scales</dt>
<dd><p>Numeric defining the scales of the continuous wavelet
transform (CWT).</p></dd>


<dt>nearbyPeak</dt>
<dd><p>logical(1) whether to include nearby peaks of
major peaks.</p></dd>


<dt>peakScaleRange</dt>
<dd><p>numeric(1) defining the scale range of the
peak (larger than 5 by default).</p></dd>


<dt>ampTh</dt>
<dd><p>numeric(1) defining the minimum required relative
amplitude of the peak (ratio of the maximum of CWT coefficients).</p></dd>


<dt>minNoiseLevel</dt>
<dd><p>numeric(1) defining the minimum noise level
used in computing the SNR.</p></dd>


<dt>ridgeLength</dt>
<dd><p>numeric(1) defining the minimum highest scale
of the peak in 2-D CWT coefficient matrix.</p></dd>


<dt>peakThr</dt>
<dd><p>numeric(1) with the minimum absolute intensity
(above baseline) of peaks to be picked. If provided, the smoothing
Savitzky-Golay filter is used (in the <code>MassSpecWavelet</code>)
package to estimate the local intensity.</p></dd>


<dt>tuneIn</dt>
<dd><p>logical(1) whther to tune in the parameter
estimation of the detected peaks.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters to be passed to the
<code>peakDetectionCWT</code> and
<code>identifyMajorPeaks</code> functions from the
<code>MassSpecWavelet</code> package.</p></dd>


<dt>object</dt>
<dd><p>For <code>findChromPeaks</code>: an
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></dd>


<dt>param</dt>
<dd><p>An <code>MSWParam</code> object containing all settings for
the algorithm.</p></dd>


<dt>BPPARAM</dt>
<dd><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></dd>


<dt>return.type</dt>
<dd><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></dd>


<dt>value</dt>
<dd><p>The value for the slot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>MSWParam</code> function returns a <code>MSWParam</code></p>


<p>class instance with all of the settings specified for peak detection by
    the <em>MSW</em> method.</p>


<p>For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an</p>
<p></p>
<p><code><a href="XCMSnExp-class.html">XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href="xcmsSet-class.html">xcmsSet</a></code> object
    with the results of the detection.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is a wrapper for the peak picker in Bioconductor's
    <code>MassSpecWavelet</code> package calling
    <code>peakDetectionCWT</code> and
    <code>tuneInPeakInfo</code> functions. See the
    <em>xcmsDirect</em> vignette for more information.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></code> method from the <code>BiocParallel</code>
    package.</p>
    </div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>
    

<dl><dt><code>snthresh,verboseColumns,scales,nearbyPeak,peakScaleRange,ampTh,minNoiseLevel,ridgeLength,peakThr,tuneIn,addParams</code></dt>
<dd><p>See corresponding parameter above.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href="findPeaks-methods.html">findPeaks</a></code> methods. It supports peak detection on
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code>
    objects (defined in the <code>MSnbase</code> package). All of the settings
    to the algorithm can be passed with a <code>MSWParam</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The <code><a href="do_findPeaks_MSW.html">do_findPeaks_MSW</a></code> core API function
    and <code><a href="findPeaks.MSW-xcmsRaw-method.html">findPeaks.MSW</a></code> for the old user interface.</p>
<p><code><a href="XCMSnExp-class.html">XCMSnExp</a></code> for the object containing the results of
    the peak detection.</p>
<p>Other peak detection methods: 
<code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href="findChromPeaks-centWave.html">findChromPeaks-centWave</a></code>,
<code><a href="findChromPeaks-massifquant.html">findChromPeaks-massifquant</a></code>,
<code><a href="findChromPeaks-matchedFilter.html">findChromPeaks-matchedFilter</a></code>,
<code><a href="findChromPeaks.html">findChromPeaks</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Joachim Kutzera, Steffen Neumann, Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a MSWParam object</span></span></span>
<span class="r-in"><span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="fu">MSWParam</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Change snthresh parameter</span></span></span>
<span class="r-in"><span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">mp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  MSWParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - snthresh: [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - verboseColumns: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - scales:  [1]  1  2  4  6  8 10 12 14 16 18 20 22 24 26 28 30 32 36 40 44 48 52 56 60 64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - nearbyPeak: [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - peakScaleRange: [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - amp.Th: [1] 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - minNoiseLevel: [1] 0.003333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - ridgeLength: [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - peakThr: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - tuneIn: [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Loading a small subset of direct injection, single spectrum files</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">msdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fticrf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fticr-mzML"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fticr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span><span class="va">fticrf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, msLevel. <span class="op">=</span> <span class="fl">1</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform the MSW peak detection on these:</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">MSWParam</span><span class="op">(</span>scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>, peakThr <span class="op">=</span> <span class="fl">80000</span>, ampTh <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>             SNR.method <span class="op">=</span> <span class="st">"data.mean"</span>, winSize.noise <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fticr</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span><span class="va">fticr</span>, param <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">fticr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            mz    mzmin    mzmax rt rtmin rtmax    into     maxo        sn intf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP01 403.2367 403.2279 403.2447 -1    -1    -1 4735258 372259.4 22.975342   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP02 409.1845 409.1755 409.1936 -1    -1    -1 4158404 310572.1 20.597978   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP03 413.2677 413.2585 413.2769 -1    -1    -1 6099006 435462.6 27.217229   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP04 414.2719 414.2652 414.2786 -1    -1    -1 1916658 157613.1  8.777433   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP05 423.2363 423.2266 423.2459 -1    -1    -1 2708391 174252.7 14.745275   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP06 427.2681 427.2583 427.2779 -1    -1    -1 6302089 461385.6 32.468892   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           maxf sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP01  814693.1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP02  731557.2      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP03 1018994.8      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP04  280826.9      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP05  435858.5      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP06 1124549.4      1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

