<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extract ion chromatograms for features in an XcmsExperiment or
XCMSnExp object. The function returns for each feature the
extracted ion chromatograms (along with all associated chromatographic
peaks) in each sample. The chromatogram is extracted from the m/z - rt
region that includes all chromatographic peaks of a feature. By default,
this region is defined using the range of the chromatographic peaks' m/z
and retention times (with mzmin = min, mzmax = max, rtmin = min and
rtmax = max). For some features, and depending on the data, the m/z and
rt range can thus be relatively large. The boundaries of the m/z - rt
region can also be restricted by changing parameters mzmin, mzmax,
rtmin and rtmax to a different functions, such as median.
By default only chromatographic peaks associated with a feature are
included in the returned XChromatograms object. For object being an
XCMSnExp object parameter include allows also to return all
chromatographic peaks with their apex position within the selected
region (include = &quot;apex_within&quot;) or any chromatographic peak overlapping
the m/z and retention time range (include = &quot;any&quot;)."><title>Extract ion chromatograms for each feature — featureChromatograms • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract ion chromatograms for each feature — featureChromatograms"><meta property="og:description" content="Extract ion chromatograms for features in an XcmsExperiment or
XCMSnExp object. The function returns for each feature the
extracted ion chromatograms (along with all associated chromatographic
peaks) in each sample. The chromatogram is extracted from the m/z - rt
region that includes all chromatographic peaks of a feature. By default,
this region is defined using the range of the chromatographic peaks' m/z
and retention times (with mzmin = min, mzmax = max, rtmin = min and
rtmax = max). For some features, and depending on the data, the m/z and
rt range can thus be relatively large. The boundaries of the m/z - rt
region can also be restricted by changing parameters mzmin, mzmax,
rtmin and rtmax to a different functions, such as median.
By default only chromatographic peaks associated with a feature are
included in the returned XChromatograms object. For object being an
XCMSnExp object parameter include allows also to return all
chromatographic peaks with their apex position within the selected
region (include = &quot;apex_within&quot;) or any chromatographic peak overlapping
the m/z and retention time range (include = &quot;any&quot;)."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract ion chromatograms for each feature</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/XcmsExperiment.R" class="external-link"><code>R/XcmsExperiment.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-XCMSnExp.R" class="external-link"><code>R/methods-XCMSnExp.R</code></a></small>
      <div class="d-none name"><code>featureChromatograms.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract ion chromatograms for features in an <a href="XcmsExperiment.html">XcmsExperiment</a> or
<a href="XCMSnExp-class.html">XCMSnExp</a> object. The function returns for each feature the
extracted ion chromatograms (along with all associated chromatographic
peaks) in each sample. The chromatogram is extracted from the m/z - rt
region that includes <strong>all</strong> chromatographic peaks of a feature. By default,
this region is defined using the range of the chromatographic peaks' m/z
and retention times (with <code>mzmin = min</code>, <code>mzmax = max</code>, <code>rtmin = min</code> and
<code>rtmax = max</code>). For some features, and depending on the data, the m/z and
rt range can thus be relatively large. The boundaries of the m/z - rt
region can also be restricted by changing parameters <code>mzmin</code>, <code>mzmax</code>,
<code>rtmin</code> and <code>rtmax</code> to a different functions, such as <code>median</code>.</p>
<p>By default only chromatographic peaks associated with a feature are
included in the returned <a href="XChromatogram.html">XChromatograms</a> object. For <code>object</code> being an
<code>XCMSnExp</code> object parameter <code>include</code> allows also to return all
chromatographic peaks with their apex position within the selected
region (<code>include = "apex_within"</code>) or any chromatographic peak overlapping
the m/z and retention time range (<code>include = "any"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">featureChromatograms</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XcmsExperiment</span></span>
<span><span class="fu">featureChromatograms</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  expandRt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  expandMz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  aggregationFun <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="st">"XChromatograms"</span>,</span>
<span>  chunkSize <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  mzmin <span class="op">=</span> <span class="va">min</span>,</span>
<span>  mzmax <span class="op">=</span> <span class="va">max</span>,</span>
<span>  rtmin <span class="op">=</span> <span class="va">min</span>,</span>
<span>  rtmax <span class="op">=</span> <span class="va">max</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  progressbar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XCMSnExp</span></span>
<span><span class="fu">featureChromatograms</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  expandRt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  aggregationFun <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature_only"</span>, <span class="st">"apex_within"</span>, <span class="st">"any"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  filled <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html" class="external-link">fileNames</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"maxo"</span>, <span class="st">"into"</span><span class="op">)</span>,</span>
<span>  expandMz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>XcmsExperiment</code> or <code>XCMSnExp</code> object with grouped
chromatographic peaks.</p></dd>


<dt>...</dt>
<dd><p>optional arguments to be passed along to the <code><a href="chromatogram-method.html">chromatogram()</a></code>
function.</p></dd>


<dt>expandRt</dt>
<dd><p><code>numeric(1)</code> to expand the retention time range for each
chromatographic peak by a constant value on each side.</p></dd>


<dt>expandMz</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range for each chromatographic
peak by a constant value on each side. Be aware that by extending the
m/z range the extracted EIC might <strong>no longer</strong> represent the actual
identified chromatographic peak because intensities of potential
additional mass peaks within each spectra would be aggregated into the
final reported intensity value per spectrum (retention time).</p></dd>


<dt>aggregationFun</dt>
<dd><p><code>character(1)</code> specifying the name that should be
used to aggregate intensity values across the m/z value range for
the same retention time. The default <code>"max"</code> returns a base peak
chromatogram.</p></dd>


<dt>features</dt>
<dd><p><code>integer</code>, <code>character</code> or <code>logical</code> defining a subset of
features for which chromatograms should be returned. Can be the index
of the features in <code>featureDefinitions</code>, feature IDs (row names of
<code>featureDefinitions</code>) or a logical vector.</p></dd>


<dt>return.type</dt>
<dd><p><code>character(1)</code> defining how the result should be
returned. At present only <code>return.type = "XChromatograms"</code> is
supported and the results are thus returned as an <code><a href="XChromatogram.html">XChromatograms()</a></code>
object.</p></dd>


<dt>chunkSize</dt>
<dd><p>For <code>object</code> being an <code>XcmsExperiment</code>: <code>integer(1)</code>
defining the number of files from which the data should be loaded at
a time into memory. Defaults to <code>chunkSize = 2L</code>.</p></dd>


<dt>mzmin</dt>
<dd><p><code>function</code> defining how the lower boundary of the m/z region
from which the EIC is integrated should be defined. Defaults to
<code>mzmin = min</code> thus the smallest <code>"mzmin"</code> value for all chromatographic
peaks of a feature will be used.</p></dd>


<dt>mzmax</dt>
<dd><p><code>function</code> defining how the upper boundary of the m/z region
from which the EIC is integrated should be defined. Defaults to
<code>mzmax = max</code> thus the largest <code>"mzmax"</code> value for all chromatographic
peaks of a feature will be used.</p></dd>


<dt>rtmin</dt>
<dd><p><code>function</code> defining how the lower boundary of the rt region
from which the EIC is integrated should be defined. Defaults to
<code>rtmin = min</code> thus the smallest <code>"rtmin"</code> value for all chromatographic
peaks of a feature will be used.</p></dd>


<dt>rtmax</dt>
<dd><p><code>function</code> defining how the upper boundary of the rt region
from which the EIC is integrated should be defined. Defaults to
<code>rtmax = max</code> thus the largest <code>"rtmax"</code> value for all chromatographic
peaks of a feature will be used.</p></dd>


<dt>progressbar</dt>
<dd><p><code>logical(1)</code> defining whether a progress bar is shown.</p></dd>


<dt>BPPARAM</dt>
<dd><p>For <code>object</code> being an <code>XcmsExperiment</code>: parallel processing
setup. Defaults to <code>BPPARAM = bpparam()</code>. See <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam()</a></code> for more
information.</p></dd>


<dt>include</dt>
<dd><p>Only for <code>object</code> being an <code>XCMSnExp</code>: <code>character(1)</code>
defining which chromatographic peaks (and related feature definitions)
should be included in the returned <code><a href="XChromatogram.html">XChromatograms()</a></code>.
Defaults to <code>"feature_only"</code>; See description above for options and
details.</p></dd>


<dt>filled</dt>
<dd><p>Only for <code>object</code> being an <code>XCMSnExp</code>: <code>logical(1)</code> whether
filled-in peaks should be included in the result object. The default
is <code>filled = FALSE</code>, i.e. only detected peaks are reported.</p></dd>


<dt>n</dt>
<dd><p>Only for <code>object</code> being an <code>XCMSnExp</code>: <code>integer(1)</code> to optionally
specify the number of <em>top n</em> samples from which the EIC should be
extracted.</p></dd>


<dt>value</dt>
<dd><p>Only for <code>object</code> being an <code>XCMSnExp</code>: <code>character(1)</code>
specifying the column to be used to sort the samples. Can be either
<code>"maxo"</code> (the default) or <code>"into"</code> to use the maximal peak intensity
or the integrated peak area, respectively.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code><a href="XChromatogram.html">XChromatograms()</a></code> object. In future, depending on parameter
<code>return.type</code>, the data might be returned as a different object.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The EIC data of a feature is extracted from every sample using the same
m/z - rt area. The EIC in a sample does thus not exactly represent the
signal of the actually identified chromatographic peak in that sample.
The <code><a href="chromPeakChromatograms.html">chromPeakChromatograms()</a></code> function would allow to extract the actual
EIC of the chromatographic peak in a specific sample. See also examples
below.</p>
<p>Parameters <code>include</code>, <code>filled</code>, <code>n</code> and <code>value</code> are only supported
for <code>object</code> being an <code>XCMSnExp</code>.</p>
<p>When extracting EICs from only the top <code>n</code> samples it can happen that one
or more of the features specified with <code>features</code> are dropped because they
have no detected peak in the <em>top n</em> samples. The chance for this to happen
is smaller if <code>x</code> contains also filled-in peaks (with <code>fillChromPeaks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="filter-MChromatograms.html">filterColumnsKeepTop()</a></code> to filter the extracted EICs keeping only
the <em>top n</em> columns (samples) with the highest intensity.
<code><a href="chromPeakChromatograms.html">chromPeakChromatograms()</a></code> for a function to extract an EIC for each
chromatographic peak.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load a test data set with detected peaks</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadXcmsData.html">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Disable parallel processing for this example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform correspondence analysis</span></span></span>
<span class="r-in"><span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">faahko_sub</span>,</span></span>
<span class="r-in"><span>    param <span class="op">=</span> <span class="fu"><a href="groupChromPeaks.html">PeakDensityParam</a></span><span class="op">(</span>minFraction <span class="op">=</span> <span class="fl">0.8</span>, sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the feature definitions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mzmed mzmin mzmax    rtmed    rtmin    rtmax npeaks 1      peakidx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01 300.2 300.2 300.2 3387.143 3379.317 3390.271      4 3 35, 125,....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02 301.0 301.0 301.0 2787.766 2786.200 2792.459      3 3  10, 97, 198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03 326.2 326.2 326.2 3416.877 3415.311 3424.700      3 3 37, 128, 213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04 328.2 328.2 328.2 3626.581 3618.755 3631.274      3 3 64, 159, 231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05 329.2 329.2 329.2 3626.581 3618.755 3631.274      3 3 63, 156, 230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06 343.0 343.0 343.0 2684.479 2678.218 2686.042      3 3   6, 92, 195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT07 344.0 344.0 344.0 2682.914 2679.783 2686.042      3 3   3, 90, 193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT08 354.2 354.2 354.2 3614.061 3610.930 3621.884      3 3 56, 153, 228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT09 356.2 356.2 356.2 3830.025 3819.069 3833.153      3 3 78, 180, 241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT10 365.0 365.0 365.0 2684.479 2679.783 2686.042      3 3   7, 93, 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT11 438.3 438.3 438.3 4052.248 4047.552 4060.071      3 3 81, 186, 248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT12 496.2 496.2 496.2 3335.498 3316.719 3340.194      3 3 47, 143, 220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT13 496.2 496.2 496.2 3402.791 3384.012 3410.617      3 3 48, 144, 221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT14 508.2 508.2 508.2 3524.859 3515.468 3529.552      3 3 67, 163, 232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT15 509.2 509.2 509.2 3523.294 3512.338 3531.117      3 3 54, 160, 229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT16 522.2 522.2 522.2 3387.142 3344.888 3434.091      6 3 52, 53, ....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT17 523.2 523.2 523.2 3387.142 3344.888 3434.091      6 3 38, 39, ....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT18 524.2 524.2 524.2 3676.658 3598.410 3704.828      4 3 74, 75, ....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT19 525.2 525.2 525.2 3690.742 3662.574 3706.393      3 3 72, 173, 238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT20 532.2 532.2 532.2 3482.605 3476.344 3488.863      3 3 49, 137, 219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT21 536.2 536.2 536.2 3712.653 3703.262 3718.912      3 3 73, 174, 237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ms_level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT07        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT08        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT09        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT10        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT11        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT12        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT13        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT14        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT15        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT16        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT17        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT18        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT19        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT20        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT21        1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract ion chromatograms for the first 3 features. Parameter</span></span></span>
<span class="r-in"><span><span class="co">## `features` can be either the feature IDs or feature indices.</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu">featureChromatograms</span><span class="op">(</span><span class="va">xdata</span>,</span></span>
<span class="r-in"><span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">featureDefinitions</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the EIC for the first feature using different colors for each file.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="featureChromatograms-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The EICs for all 3 samples use the same m/z and retention time range,</span></span></span>
<span class="r-in"><span><span class="co">## which was defined using the `featureArea` function:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XcmsExperiment.html">featureArea</a></span><span class="op">(</span><span class="va">xdata</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    mzmin <span class="op">=</span> <span class="va">min</span>, mzmax <span class="op">=</span> <span class="va">max</span>, rtmin <span class="op">=</span> <span class="va">min</span>, rtmax <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mzmin mzmax    rtmin    rtmax</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01 300.2 300.2 3362.104 3413.746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02 301.0 301.0 2765.855 2820.630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03 326.2 326.2 3391.837 3449.740</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To extract the actual (exact) EICs for each chromatographic peak of</span></span></span>
<span class="r-in"><span><span class="co">## a feature in each sample, the `chromPeakChromatograms` function would</span></span></span>
<span class="r-in"><span><span class="co">## need to be used instead. Below we extract the EICs for all</span></span></span>
<span class="r-in"><span><span class="co">## chromatographic peaks of the first feature. We need to first get the</span></span></span>
<span class="r-in"><span><span class="co">## IDs of all chromatographic peaks assigned to the first feature:</span></span></span>
<span class="r-in"><span><span class="va">peak_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">peakidx</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can now pass these to the `chromPeakChromatograms` function with</span></span></span>
<span class="r-in"><span><span class="co">## parameter `peaks`:</span></span></span>
<span class="r-in"><span><span class="va">eic_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="chromPeakChromatograms.html">chromPeakChromatograms</a></span><span class="op">(</span><span class="va">xdata</span>, peaks <span class="op">=</span> <span class="va">peak_ids</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To plot these into a single plot we need to use the</span></span></span>
<span class="r-in"><span><span class="co">## `plotChromatogramsOverlay` function:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotChromatogramsOverlay.html">plotChromatogramsOverlay</a></span><span class="op">(</span><span class="va">eic_1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="featureChromatograms-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

