<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The do_groupChromPeaks_density function performs chromatographic peak
grouping based on the density (distribution) of peaks, found in different
samples, along the retention time axis in slices of overlapping mz ranges."><title>Core API function for peak density based chromatographic peak grouping — do_groupChromPeaks_density • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Core API function for peak density based chromatographic peak grouping — do_groupChromPeaks_density"><meta property="og:description" content="The do_groupChromPeaks_density function performs chromatographic peak
grouping based on the density (distribution) of peaks, found in different
samples, along the retention time axis in slices of overlapping mz ranges."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Core API function for peak density based chromatographic peak grouping</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/do_groupChromPeaks-functions.R" class="external-link"><code>R/do_groupChromPeaks-functions.R</code></a></small>
      <div class="d-none name"><code>do_groupChromPeaks_density.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>do_groupChromPeaks_density</code> function performs chromatographic peak
grouping based on the density (distribution) of peaks, found in different
samples, along the retention time axis in slices of overlapping mz ranges.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_groupChromPeaks_density</span><span class="op">(</span></span>
<span>  <span class="va">peaks</span>,</span>
<span>  <span class="va">sampleGroups</span>,</span>
<span>  bw <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  minFraction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  minSamples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  binSize <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  maxFeatures <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sleep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">peaks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>peaks</dt>
<dd><p>A <code>matrix</code> or <code>data.frame</code> with the mz values and
retention times of the identified chromatographic peaks in all samples of an
experiment. Required columns are <code>"mz"</code>, <code>"rt"</code> and
<code>"sample"</code>. The latter should contain <code>numeric</code> values representing
the index of the sample in which the peak was found.</p></dd>


<dt>sampleGroups</dt>
<dd><p>For <code>PeakDensityParam</code>: A vector of the same length than
samples defining the sample group assignments (i.e. which samples
belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p></dd>


<dt>bw</dt>
<dd><p>For <code>PeakDensityParam</code>: <code>numeric(1)</code> defining the bandwidth
(standard deviation ot the smoothing kernel) to be used. This argument
is passed to the [density() method.</p></dd>


<dt>minFraction</dt>
<dd><p>For <code>PeakDensityParam</code>: <code>numeric(1)</code> defining the minimum
fraction of samples in at least one sample group in which the peaks
have to be present to be considered as a peak group (feature).</p></dd>


<dt>minSamples</dt>
<dd><p>For <code>PeakDensityParam</code>: <code>numeric(1)</code> with the minimum
number of samples in at least one sample group in which the peaks have
to be detected to be considered a peak group (feature).</p></dd>


<dt>binSize</dt>
<dd><p>For <code>PeakDensityParam</code>: <code>numeric(1)</code> defining the size of the
overlapping slices in m/z dimension.</p></dd>


<dt>maxFeatures</dt>
<dd><p>For <code>PeakDensityParam</code>: <code>numeric(1)</code> with the maximum
number of peak groups to be identified in a single mz slice.</p></dd>


<dt>sleep</dt>
<dd><p><code>numeric(1)</code> defining the time to <em>sleep</em> between
iterations and plot the result from the current iteration.</p></dd>


<dt>index</dt>
<dd><p>An optional <code>integer</code> providing the indices of the peaks in the
original peak matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>data.frame</code>, each row representing a (mz-rt) feature (i.e. a peak group)
with columns:</p><ul><li><p><code>"mzmed"</code>: median of the peaks' apex mz values.</p></li>
<li><p><code>"mzmin"</code>: smallest mz value of all peaks' apex within the feature.</p></li>
<li><p><code>"mzmax"</code>:largest mz value of all peaks' apex within the feature.</p></li>
<li><p><code>"rtmed"</code>: the median of the peaks' retention times.</p></li>
<li><p><code>"rtmin"</code>: the smallest retention time of the peaks in the group.</p></li>
<li><p><code>"rtmax"</code>: the largest retention time of the peaks in the group.</p></li>
<li><p><code>"npeaks"</code>: the total number of peaks assigned to the feature.</p></li>
<li><p><code>"peakidx"</code>: a <code>list</code> with the indices of all peaks in a feature in the
<code>peaks</code> input matrix.</p></li>
</ul><p>Note that this number can be larger than the total number of samples, since
multiple peaks from the same sample could be assigned to a feature.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For overlapping slices along the mz dimension, the function
calculates the density distribution of identified peaks along the
retention time axis and groups peaks from the same or different samples
that are close to each other. See (Smith 2006) for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The default settings might not be appropriate for all LC/GC-MS setups,
especially the <code>bw</code> and <code>binSize</code> parameter should be adjusted
accordingly.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
Anal. Chem. 2006, 78:779-787.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other core peak grouping algorithms: 
<code><a href="do_groupChromPeaks_nearest.html">do_groupChromPeaks_nearest</a>()</code>,
<code><a href="do_groupPeaks_mzClust.html">do_groupPeaks_mzClust</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Colin Smith, Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load the test file</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadXcmsData.html">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Disable parallel processing for this example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the matrix with the identified peaks from the xcmsSet:</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform the peak grouping with default settings:</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">do_groupChromPeaks_density</span><span class="op">(</span><span class="va">pks</span>, sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The feature definitions:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mzmed mzmin mzmax    rtmed    rtmin    rtmax npeaks 1      peakidx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 279.0 279.0 279.0 2787.765 2787.765 2787.766      2 2      11, 199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 286.2 286.2 286.2 3254.904 3250.992 3258.815      2 2     115, 205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 300.2 300.2 300.2 3387.143 3379.317 3390.271      4 3 35, 125,....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 301.0 301.0 301.0 2787.766 2786.200 2792.459      3 3  10, 97, 198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 305.1 305.1 305.1 2994.338 2994.338 2994.339      2 2      15, 203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 305.1 305.1 305.1 2923.917 2923.916 2923.917      2 2      14, 202</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

