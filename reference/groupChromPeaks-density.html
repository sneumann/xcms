<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Peak grouping based on time dimension peak densities — groupChromPeaks-density • xcms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Peak grouping based on time dimension peak densities — groupChromPeaks-density"><meta property="og:description" content="This method performs performs correspondence (chromatographic
peak grouping) based on the density (distribution) of identified peaks
along the retention time axis within slices of overlapping mz ranges.
All peaks (from the same or from different samples) being close on the
retention time axis are grouped into a feature (peak group).
The PeakDensityParam class allows to specify all settings for the peak
grouping based on peak densities along the time dimension. Instances should
be created with the PeakDensityParam() constructor.
sampleGroups,sampleGroups&amp;lt;-: getter and setter
for the sampleGroups slot of the object. Its length should match
the number of samples in the experiment and it should not contain
NAs.
bw,bw&amp;lt;-: getter and setter for the bw slot
of the object.
minFraction,minFraction&amp;lt;-: getter and setter for
the minFraction slot of the object.
minSamples,minSamples&amp;lt;-: getter and setter for the
minSamples slot of the object.
binSize,binSize&amp;lt;-: getter and setter for the
binSize slot of the object.
maxFeatures,maxFeatures&amp;lt;-: getter and setter for
the maxFeatures slot of the object.
groupChromPeaks,XCMSnExp,PeakDensityParam:
performs correspondence (peak grouping within and across samples) within
in mz dimension overlapping slices of MS data based on the density
distribution of the identified chromatographic peaks in the slice along
the time axis.
The correspondence analysis can be performed on chromatographic peaks of
any MS level (if present and if chromatographic peak detection has been
performed for that MS level) defining features combining these peaks. The
MS level can be selected with the parameter msLevel. By default, calling
groupChromPeaks will remove any previous correspondence results. This can
be disabled with add = TRUE, which will add newly defined features to
already present feature definitions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.15.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak grouping based on time dimension peak densities</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/master/R/DataClasses.R"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/master/R/functions-Params.R"><code>R/functions-Params.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/master/R/methods-Params.R"><code>R/methods-Params.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>groupChromPeaks-density.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method performs performs correspondence (chromatographic
peak grouping) based on the density (distribution) of identified peaks
along the retention time axis within slices of overlapping mz ranges.
All peaks (from the same or from different samples) being close on the
retention time axis are grouped into a feature (<em>peak group</em>).</p>
<p>The <code>PeakDensityParam</code> class allows to specify all settings for the peak
grouping based on peak densities along the time dimension. Instances should
be created with the <code>PeakDensityParam()</code> constructor.</p>
<p><code>sampleGroups</code>,<code>sampleGroups&lt;-</code>: getter and setter
for the <code>sampleGroups</code> slot of the object. Its length should match
the number of samples in the experiment and it should not contain
<code>NA</code>s.</p>
<p><code>bw</code>,<code>bw&lt;-</code>: getter and setter for the <code>bw</code> slot
of the object.</p>
<p><code>minFraction</code>,<code>minFraction&lt;-</code>: getter and setter for
the <code>minFraction</code> slot of the object.</p>
<p><code>minSamples</code>,<code>minSamples&lt;-</code>: getter and setter for the
<code>minSamples</code> slot of the object.</p>
<p><code>binSize</code>,<code>binSize&lt;-</code>: getter and setter for the
<code>binSize</code> slot of the object.</p>
<p><code>maxFeatures</code>,<code>maxFeatures&lt;-</code>: getter and setter for
the <code>maxFeatures</code> slot of the object.</p>
<p><code>groupChromPeaks,XCMSnExp,PeakDensityParam</code>:
performs correspondence (peak grouping within and across samples) within
in mz dimension overlapping slices of MS data based on the density
distribution of the identified chromatographic peaks in the slice along
the time axis.</p>
<p>The correspondence analysis can be performed on chromatographic peaks of
any MS level (if present and if chromatographic peak detection has been
performed for that MS level) defining features combining these peaks. The
MS level can be selected with the parameter <code>msLevel</code>. By default, calling
<code>groupChromPeaks</code> will remove any previous correspondence results. This can
be disabled with <code>add = TRUE</code>, which will add newly defined features to
already present feature definitions.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">PeakDensityParam</span><span class="op">(</span>
  sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  bw <span class="op">=</span> <span class="fl">30</span>,
  minFraction <span class="op">=</span> <span class="fl">0.5</span>,
  minSamples <span class="op">=</span> <span class="fl">1</span>,
  binSize <span class="op">=</span> <span class="fl">0.25</span>,
  maxFeatures <span class="op">=</span> <span class="fl">50</span>
<span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">sampleGroups</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">sampleGroups</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">bw</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">bw</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">minFraction</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">minFraction</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">minSamples</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">minSamples</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu"><a href="findChromPeaks-matchedFilter.html">binSize</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu"><a href="findChromPeaks-matchedFilter.html">binSize</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">maxFeatures</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for PeakDensityParam</span>
<span class="fu">maxFeatures</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for XCMSnExp,PeakDensityParam</span>
<span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">param</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments"><colgroup><col class="name"><col class="desc"></colgroup><tr><th>sampleGroups</th>
      <td><p>A vector of the same length than samples defining the
sample group assignments (i.e. which samples belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p></td>
    </tr><tr><th>bw</th>
      <td><p><code>numeric(1)</code> defining the bandwidth (standard deviation ot the
smoothing kernel) to be used. This argument is passed to the
[density() method.</p></td>
    </tr><tr><th>minFraction</th>
      <td><p><code>numeric(1)</code> defining the minimum fraction of samples
in at least one sample group in which the peaks have to be present to be
considered as a peak group (feature).</p></td>
    </tr><tr><th>minSamples</th>
      <td><p><code>numeric(1)</code> with the minimum number of samples in at
least one sample group in which the peaks have to be detected to be
considered a peak group (feature).</p></td>
    </tr><tr><th>binSize</th>
      <td><p><code>numeric(1)</code> defining the size of the overlapping slices
in mz dimension.</p></td>
    </tr><tr><th>maxFeatures</th>
      <td><p><code>numeric(1)</code> with the maximum number of peak groups
to be identified in a single mz slice.</p></td>
    </tr><tr><th>object</th>
      <td><p>For <code>groupChromPeaks</code>: an <a href="XCMSnExp-class.html">XCMSnExp</a> object
containing the results from a previous peak detection analysis (see
<code><a href="chromatographic-peak-detection.html">findChromPeaks()</a></code>).</p><pre><code>For all other methods: a `PeakDensityParam` object.
</code></pre></td>
    </tr><tr><th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr><tr><th>param</th>
      <td><p>A <code>PeakDensityParam</code> object containing all settings for
the peak grouping algorithm.</p></td>
    </tr><tr><th>msLevel</th>
      <td><p><code>integer(1)</code> (default <code>msLevel = 1L</code>) defining the MS level
on which the correspondence should be performed. It is required that
chromatographic peaks of the respective MS level are present.</p></td>
    </tr><tr><th>add</th>
      <td><p><code>logical(1)</code> (default <code>add = FALSE</code>) allowing to perform an
additional round of correspondence (e.g. on a different MS level) and
add features to the already present feature definitions.</p></td>
    </tr></table><h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>PeakDensityParam</code> function returns a
<code>PeakDensityParam</code> class instance with all of the settings
specified for chromatographic peak alignment based on peak densities.
Note that argument <code>sampleGroups</code> is mandatory and should represent
either the sample grouping in the experiment. It's length has to match
the number of sample in the experiments.</p>
<p>For <code>groupChromPeaks</code>: a <a href="XCMSnExp-class.html">XCMSnExp</a> object with the
results of the correspondence analysis. The definition of the resulting
mz-rt features can be accessed with the <code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> method</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl><dt><code>sampleGroups,bw,minFraction,minSamples,binSize,maxFeatures</code></dt><dd><p>See
corresponding parameter above.</p></dd>

</dl><h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
<code>xcms</code> user interface. All of the settings to the algorithm
can be passed with a <code>PeakDensityParam</code> object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
Anal. Chem. 2006, 78:779-787.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index"><p>The <code><a href="do_groupChromPeaks_density.html">do_groupChromPeaks_density()</a></code> core API function and <code><a href="group.density.html">group.density()</a></code>
for the old user interface.</p>
<p><code><a href="plotChromPeakDensity.html">plotChromPeakDensity()</a></code> to plot peak densities and evaluate different
algorithm settings.</p>
<p><code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> and <code><a href="XCMSnExp-peak-grouping-results.html">featureValues()</a></code> for methods to access the
features (i.e. the peak grouping results).</p>
<p><a href="XCMSnExp-class.html">XCMSnExp</a> for the object containing the results of the correspondence.</p>
<p><code><a href="plotChromPeakDensity.html">plotChromPeakDensity()</a></code> for plotting chromatographic peak density with the
possibility to test different parameter settings.</p>
<p>Other peak grouping methods: 
<code><a href="groupChromPeaks-mzClust.html">groupChromPeaks-mzClust</a></code>,
<code><a href="groupChromPeaks-nearest.html">groupChromPeaks-nearest</a></code>,
<code><a href="groupChromPeaks.html">groupChromPeaks</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Colin Smith, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Create a PeakDensityParam object</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PeakDensityParam</span><span class="op">(</span>binSize <span class="op">=</span> <span class="fl">0.05</span>, sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Change hte minSamples slot</span></span>
<span class="r-in"><span class="fu">minSamples</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span class="r-in"><span class="va">p</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  PeakDensityParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampleGroups: [1] 1 1 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - bw: [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - minFraction: [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - minSamples: [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - binSize: [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - maxFeatures: [1] 50</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##############################</span></span>
<span class="r-in"><span class="co">## Chromatographic peak detection and grouping.</span></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"><span class="co">## Load a test data set with detected peaks</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Update the path to the files for the local system</span></span>
<span class="r-in"><span class="fu"><a href="dirname.html">dirname</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"cdf/KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Disable parallel processing for this example</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">faahko_sub</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
<span class="r-in"><span class="co">## The number of peaks identified per sample:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2   3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  87 100  61 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Performing the chromatographic peak grouping. Assigning all samples to</span></span>
<span class="r-in"><span class="co">## the same sample group.</span></span>
<span class="r-in"><span class="va">fdp</span> <span class="op">&lt;-</span> <span class="fu">PeakDensityParam</span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html">fileNames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">fdp</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing 2572 mz slices ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The definition of the features (peak groups):</span></span>
<span class="r-in"><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 47 rows and 10 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01     279.0     279.0     279.0   2787.77   2787.76   2787.77         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02     286.2     286.2     286.2   3254.90   3250.99   3258.82         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03     300.2     300.2     300.2   3387.14   3379.32   3390.27         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04     301.0     301.0     301.0   2787.77   2786.20   2792.46         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05     305.1     305.1     305.1   2994.34   2994.34   2994.34         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...        ...       ...       ...       ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT43    534.20     534.2     534.2   3580.41   3576.50   3584.33         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT44    536.20     536.2     536.2   3712.65   3703.26   3718.91         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT45    571.75     571.7     571.8   2918.44   2916.09   2920.78         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT46    579.10     579.1     579.1   2786.98   2786.20   2787.77         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT47    593.40     593.4     593.4   3707.18   3704.83   3709.52         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             X1         peakidx  ms_level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;numeric&gt;          &lt;list&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01         2          11,199         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02         2         115,205         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03         3  35,125,210,...         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04         3      10, 97,198         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05         2          15,203         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...        ...             ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT43         2          61,227         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT44         3      73,174,237         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT45         2         100,201         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT46         2           8,197         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT47         2         164,234         1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Using the featureValues method to extract a matrix with the</span></span>
<span class="r-in"><span class="co">## intensities of the features per sample.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-peak-grouping-results.html">featureValues</a></span><span class="op">(</span><span class="va">res</span>, value <span class="op">=</span> <span class="st">"into"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ko15.CDF ko16.CDF   ko18.CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT01 17140627.0       NA 16919266.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT02         NA  1264119   732016.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT03  4700903.2  5313736  5169558.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT04  3051847.8  1964444  2774885.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT05   847473.1       NA  1003750.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT06  1070389.9       NA  1983342.5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The process history:</span></span>
<span class="r-in"><span class="fu"><a href="XCMSnExp-class.html">processHistory</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak detection </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Mon Jun 15 06:30:55 2020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2,3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s) 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak grouping </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Sun Oct 10 18:53:46 2021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2,3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: PeakDensityParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s) 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

