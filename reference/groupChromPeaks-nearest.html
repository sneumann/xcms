<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Peak grouping based on proximity in the mz-rt space — groupChromPeaks-nearest • xcms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Peak grouping based on proximity in the mz-rt space — groupChromPeaks-nearest"><meta property="og:description" content="This method is inspired by the grouping algorithm of mzMine
(Katajamaa 2006) and performs correspondence based on proximity of peaks
in the space spanned by retention time and mz values.
The method creates first a master peak list consisting of all
chromatographic peaks from the sample in which most peaks were
identified, and starting from that, calculates distances to peaks from
the sample with the next most number of peaks. If peaks are closer than
the defined threshold they are grouped together.
The NearestPeaksParam class allows to specify all
settings for the peak grouping based on the nearest algorithm.
Instances should be created with the NearestPeaksParam constructor.
sampleGroups,sampleGroups&amp;lt;-: getter and setter
for the sampleGroups slot of the object.
mzVsRtBalance,mzVsRtBalance&amp;lt;-: getter and setter
for the mzVsRtBalance slot of the object.
absMz,absMz&amp;lt;-: getter and setter for the
absMz slot of the object.
absRt,absRt&amp;lt;-: getter and setter for the
absRt slot of the object.
kNN,kNN&amp;lt;-: getter and setter for the
kNN slot of the object.
groupChromPeaks,XCMSnExp,NearestPeaksParam:
performs peak grouping based on the proximity between chromatographic
peaks from different samples in the mz-rt range.
The correspondence analysis can be performed on chromatographic peaks of
any MS level (if present and if chromatographic peak detection has been
performed for that MS level) defining features combining these peaks. The
MS level can be selected with the parameter msLevel. By default, calling
groupChromPeaks will remove any previous correspondence results. This can
be disabled with add = TRUE, which will add newly defined features to
already present feature definitions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.17.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak grouping based on proximity in the mz-rt space</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/DataClasses.R" class="external-link"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-Params.R" class="external-link"><code>R/functions-Params.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-Params.R" class="external-link"><code>R/methods-Params.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>groupChromPeaks-nearest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method is inspired by the grouping algorithm of mzMine
(Katajamaa 2006) and performs correspondence based on proximity of peaks
in the space spanned by retention time and mz values.
The method creates first a <em>master peak list</em> consisting of all
chromatographic peaks from the sample in which most peaks were
identified, and starting from that, calculates distances to peaks from
the sample with the next most number of peaks. If peaks are closer than
the defined threshold they are grouped together.</p>
<p>The <code>NearestPeaksParam</code> class allows to specify all
settings for the peak grouping based on the <em>nearest</em> algorithm.
Instances should be created with the <code>NearestPeaksParam</code> constructor.</p>
<p><code>sampleGroups</code>,<code>sampleGroups&lt;-</code>: getter and setter
for the <code>sampleGroups</code> slot of the object.</p>
<p><code>mzVsRtBalance</code>,<code>mzVsRtBalance&lt;-</code>: getter and setter
for the <code>mzVsRtBalance</code> slot of the object.</p>
<p><code>absMz</code>,<code>absMz&lt;-</code>: getter and setter for the
<code>absMz</code> slot of the object.</p>
<p><code>absRt</code>,<code>absRt&lt;-</code>: getter and setter for the
<code>absRt</code> slot of the object.</p>
<p><code>kNN</code>,<code>kNN&lt;-</code>: getter and setter for the
<code>kNN</code> slot of the object.</p>
<p><code>groupChromPeaks,XCMSnExp,NearestPeaksParam</code>:
performs peak grouping based on the proximity between chromatographic
peaks from different samples in the mz-rt range.</p>
<p>The correspondence analysis can be performed on chromatographic peaks of
any MS level (if present and if chromatographic peak detection has been
performed for that MS level) defining features combining these peaks. The
MS level can be selected with the parameter <code>msLevel</code>. By default, calling
<code>groupChromPeaks</code> will remove any previous correspondence results. This can
be disabled with <code>add = TRUE</code>, which will add newly defined features to
already present feature definitions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">NearestPeaksParam</span><span class="op">(</span>
  sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  mzVsRtBalance <span class="op">=</span> <span class="fl">10</span>,
  absMz <span class="op">=</span> <span class="fl">0.2</span>,
  absRt <span class="op">=</span> <span class="fl">15</span>,
  kNN <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu"><a href="groupChromPeaks-density.html">sampleGroups</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu"><a href="groupChromPeaks-density.html">sampleGroups</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">mzVsRtBalance</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">mzVsRtBalance</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu"><a href="groupChromPeaks-mzClust.html">absMz</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu"><a href="groupChromPeaks-mzClust.html">absMz</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">absRt</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">absRt</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">kNN</span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for NearestPeaksParam</span>
<span class="fu">kNN</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for XCMSnExp,NearestPeaksParam</span>
<span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">param</span>, msLevel <span class="op">=</span> <span class="fl">1L</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sampleGroups</dt>
<dd><p>A vector of the same length than samples defining the
sample group assignments (i.e. which samples belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p></dd>
<dt>mzVsRtBalance</dt>
<dd><p><code>numeric(1)</code> representing the factor by which mz
values are multiplied before calculating the (euclician) distance between
two peaks.</p></dd>
<dt>absMz</dt>
<dd><p><code>numeric(1)</code> maximum tolerated distance for mz values.</p></dd>
<dt>absRt</dt>
<dd><p><code>numeric(1)</code> maximum tolerated distance for rt values.</p></dd>
<dt>kNN</dt>
<dd><p><code>numeric(1)</code> representing the number of nearest neighbors
to check.</p></dd>
<dt>object</dt>
<dd><p>For <code>groupChromPeaks</code>: an <a href="XCMSnExp-class.html">XCMSnExp</a> object containing the
results from a previous chromatographic peak detection
analysis (see <code><a href="chromatographic-peak-detection.html">findChromPeaks()</a></code>).</p><div class="sourceCode"><pre><code>For all other methods: a `NearestPeaksParam` object.
</code></pre></div></dd>
<dt>value</dt>
<dd><p>The value for the slot.</p></dd>
<dt>param</dt>
<dd><p>A <code>PeakDensityParam</code> object containing all settings for
the peak grouping algorithm.</p></dd>
<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level. Currently only MS level
1 is supported.</p></dd>
<dt>add</dt>
<dd><p><code>logical(1)</code> (default <code>add = FALSE</code>) allowing to perform an
additional round of correspondence (e.g. on a different MS level) and
add features to the already present feature definitions.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The <code>NearestPeaksParam</code> function returns a
<code>NearestPeaksParam</code> class instance with all of the settings
    specified for peak alignment based on peak proximity.
For <code>groupChromPeaks</code>: a <a href="XCMSnExp-class.html">XCMSnExp</a> object with the results of the peak
grouping/correspondence step (i.e. the mz-rt features). These can be
accessed with the <code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> method.</p>
    </div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>sampleGroups,mzVsRtBalance,absMz,absRt,kNN</code></dt>
<dd><p>See corresponding parameter
above.</p></dd>


</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>These methods and classes are part of the updated and modernized
<code>xcms</code> user interface. All of the settings to the algorithm
can be passed with a <code>NearestPeaksParam</code> object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Katajamaa M, Miettinen J, Oresic M: MZmine: Toolbox for
processing and visualization of mass spectrometry based molecular profile
data. Bioinformatics 2006, 22:634-636.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The <code><a href="do_groupChromPeaks_nearest.html">do_groupChromPeaks_nearest()</a></code> core API function.</p>
<p><code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> and <code><a href="XCMSnExp-peak-grouping-results.html">featureValues()</a></code> for methods to access
peak grouping results (i.e. the features).</p>
<p><a href="XCMSnExp-class.html">XCMSnExp</a> for the object containing the results of
the peak grouping.</p>
<p>Other peak grouping methods: 
<code><a href="groupChromPeaks-density.html">groupChromPeaks-density</a></code>,
<code><a href="groupChromPeaks-mzClust.html">groupChromPeaks-mzClust</a></code>,
<code><a href="groupChromPeaks.html">groupChromPeaks</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Create a NearestPeaksParam object</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">NearestPeaksParam</span><span class="op">(</span>kNN <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  NearestPeaksParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampleGroups: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzVsRtBalance: [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - absMz: [1] 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - absRt: [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - kNN: [1] 3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Load a test data set with detected peaks</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Update the path to the files for the local system</span></span>
<span class="r-in"><span class="fu"><a href="dirname.html">dirname</a></span><span class="op">(</span><span class="va">faahko_sub</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf/KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">faahko_sub</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Disable parallel processing for this example</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mz mzmin mzmax       rt    rtmin    rtmax       into       intb   maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 453.2 453.2 453.2 2506.073 2501.378 2527.982  1007409.0  1007380.8  38152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 302.0 302.0 302.0 2617.185 2595.275 2640.659   687146.6   671297.8  30552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 344.0 344.0 344.0 2679.783 2646.919 2709.517  5210015.9  5135916.9 152320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 430.1 430.1 430.1 2681.348 2639.094 2712.647  2395840.3  2299899.6  65752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 366.0 366.0 366.0 2679.783 2642.224 2718.907  3365174.0  3279468.3  79928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 343.0 343.0 343.0 2678.218 2637.529 2712.647 24147443.2 23703761.7 672064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 38151      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002    46      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003    68      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004    42      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005    49      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006    87      1</span>
<span class="r-in"><span class="co">## The number of peaks identified per sample:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2   3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  87 100  61 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Performing the peak grouping</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">NearestPeaksParam</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="groupChromPeaks.html">groupChromPeaks</a></span><span class="op">(</span><span class="va">res</span>, param <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Empty 'sampleGroups' in 'param', assuming all samples to be in the same group.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing sample number 1 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing sample number 3 ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The results from the peak grouping:</span></span>
<span class="r-in"><span class="fu"><a href="XCMSnExp-class.html">featureDefinitions</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 188 rows and 10 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT001     384.1     384.1     384.1   2603.10   2603.10   2603.10         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT002     533.3     533.3     533.3   2686.04   2686.04   2686.04         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT003     344.0     344.0     344.0   2682.91   2679.78   2686.04         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT004     366.0     366.0     366.0   2682.91   2679.78   2686.04         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT005     343.0     343.0     343.0   2684.48   2678.22   2686.04         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...         ...       ...       ...       ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT184     283.2     283.2     283.2   3873.84   3873.84   3873.84         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT185     536.0     536.0     536.0   3927.05   3927.05   3927.05         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT186     411.3     411.3     411.3   3934.88   3934.88   3934.88         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT187     426.2     426.2     426.2   3794.03   3794.03   3794.03         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT188     384.2     384.2     384.2   3986.52   3986.52   3986.52         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              X1     peakidx  ms_level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt;      &lt;list&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT001         1          88         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT002         1          89         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT003         3   3, 90,193         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT004         2        5,91         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT005         3   6, 92,195         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...         ...         ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT184         1         242         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT185         1         244         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT186         1         245         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT187         1         246         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT188         1         247         1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Using the featureValues method to extract a matrix with the intensities of</span></span>
<span class="r-in"><span class="co">## the features per sample.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-peak-grouping-results.html">featureValues</a></span><span class="op">(</span><span class="va">res</span>, value <span class="op">=</span> <span class="st">"into"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ko15.CDF   ko16.CDF ko18.CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT001       NA   274906.3       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT002       NA    70456.3       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT003  5210016  5700652.0  5255689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT004  3365174  3448376.1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT005 24147443 26229546.1 23821647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FT006 14975761 15565868.0 12388547</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The process history:</span></span>
<span class="r-in"><span class="fu"><a href="XCMSnExp-class.html">processHistory</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak detection </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Mon Jun 15 06:30:55 2020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2,3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: CentWaveParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s) 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "XProcessHistory"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  type: Peak grouping </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  date: Thu Apr 21 20:17:43 2022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  info:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fileIndex: 1,2,3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter class: NearestPeaksParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MS level(s) 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

