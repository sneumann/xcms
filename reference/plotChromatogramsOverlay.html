<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="plotOverlay draws chromatographic peak data from multiple (different)
extracted ion chromatograms (EICs) into the same plot. This allows to
directly compare the peak shape of these EICs in the same sample. In
contrast to the plot function for MChromatograms() object, which draws
the data from the same EIC across multiple samples in the same plot, this
function draws the different EICs from the same sample into the same plot.
If plotChromatogramsOverlay is called on a XChromatograms object any
present chromatographic peaks will also be highlighted/drawn depending on the
parameters peakType, peakCol, peakBg and peakPch (see also help on
the plot function for XChromatogram() object for details)."><title>Plot multiple chromatograms into the same plot — plotChromatogramsOverlay • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot multiple chromatograms into the same plot — plotChromatogramsOverlay"><meta property="og:description" content="plotOverlay draws chromatographic peak data from multiple (different)
extracted ion chromatograms (EICs) into the same plot. This allows to
directly compare the peak shape of these EICs in the same sample. In
contrast to the plot function for MChromatograms() object, which draws
the data from the same EIC across multiple samples in the same plot, this
function draws the different EICs from the same sample into the same plot.
If plotChromatogramsOverlay is called on a XChromatograms object any
present chromatographic peaks will also be highlighted/drawn depending on the
parameters peakType, peakCol, peakBg and peakPch (see also help on
the plot function for XChromatogram() object for details)."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot multiple chromatograms into the same plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-MChromatograms.R" class="external-link"><code>R/methods-MChromatograms.R</code></a></small>
      <div class="d-none name"><code>plotChromatogramsOverlay.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotOverlay</code> draws chromatographic peak data from multiple (different)
extracted ion chromatograms (EICs) into the same plot. This allows to
directly compare the peak shape of these EICs in the same sample. In
contrast to the <code>plot</code> function for <code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> object, which draws
the data from the same EIC across multiple samples in the same plot, this
function draws the different EICs from the same sample into the same plot.</p>
<p>If <code>plotChromatogramsOverlay</code> is called on a <code>XChromatograms</code> object any
present chromatographic peaks will also be highlighted/drawn depending on the
parameters <code>peakType</code>, <code>peakCol</code>, <code>peakBg</code> and <code>peakPch</code> (see also help on
the <code>plot</code> function for <code><a href="XChromatogram.html">XChromatogram()</a></code> object for details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for MChromatograms</span></span>
<span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"#00000060"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"rtime"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stacked <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  transform <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XChromatograms</span></span>
<span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"#00000060"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"rtime"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  peakType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"polygon"</span>, <span class="st">"point"</span>, <span class="st">"rectangle"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  peakBg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  peakCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  peakPch <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stacked <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  transform <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code><a href="https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html" class="external-link">MChromatograms()</a></code> or <code><a href="XChromatogram.html">XChromatograms()</a></code> object.</p></dd>


<dt>col</dt>
<dd><p>definition of the color in which the chromatograms should be
drawn. Can be of length 1 or equal to <code>nrow(object)</code> to plot each
overlayed chromatogram in a different color.</p></dd>


<dt>type</dt>
<dd><p><code>character(1)</code> defing the type of the plot. By default
(<code>type = "l"</code>) each chromatogram is drawn as a line.</p></dd>


<dt>main</dt>
<dd><p>optional title of the plot. If not defined, the range of m/z
values is used.</p></dd>


<dt>xlab</dt>
<dd><p><code>character(1)</code> defining the x-axis label.</p></dd>


<dt>ylab</dt>
<dd><p><code>character(1)</code> defining the y-axis label.</p></dd>


<dt>xlim</dt>
<dd><p>optional <code>numeric(2)</code> defining the x-axis limits.</p></dd>


<dt>ylim</dt>
<dd><p>optional <code>numeric(2)</code> defining the y-axis limits.</p></dd>


<dt>stacked</dt>
<dd><p><code>numeric(1)</code> defining the part (proportion) of the y-axis to
use to <em>stack</em> EICs depending on their m/z values. If <code>stacked = 0</code> (the
default) no stacking is performed. With <code>stacked = 1</code> half of the y-axis
is used for stacking and half for the intensity y-axis (i.e. the ratio
between stacking and intensity y-axis is 1:1). Note that if <code>stacking</code>
is different from 0 no y-axis and label are drawn.</p></dd>


<dt>transform</dt>
<dd><p><code>function</code> to transform the intensity values before
plotting. Defaults to <code>transform = identity</code> which plots the data as it
is. With <code>transform = log10</code> intensity values would be log10 transformed
before plotting.</p></dd>


<dt>...</dt>
<dd><p>optional arguments to be passed to the plotting functions (see
help on the base R <code>plot</code> function.</p></dd>


<dt>peakType</dt>
<dd><p>if <code>object</code> is a <code>XChromatograms</code> object: how chromatographic
peaks should be drawn: <code>peakType = "polygon"</code> (the default): label the
full chromatographic peak area, <code>peakType = "rectangle"</code>: indicate the
chromatographic peak by a rectangle and <code>peakType  = "point"</code>: label the
chromatographic peaks' apex position with a point.</p></dd>


<dt>peakBg</dt>
<dd><p>if <code>object</code> is a <code>XChromatograms</code> object: definition of
background color(s) for each chromatographic peak. Has to be either of
length 1 or equal to the number of peaks in <code>object</code>. If not specified,
the peak will be drawn in the color defined by <code>col</code>.</p></dd>


<dt>peakCol</dt>
<dd><p>if <code>object</code> is a <code>XChromatograms</code> object: definition of
color(s) for each chromatographic peak. Has to be either of length 1 or
equal to the number of peaks in <code>object</code>. If not specified, the peak will
be drawn in the color defined by <code>col</code>.</p></dd>


<dt>peakPch</dt>
<dd><p>if <code>object</code> is a <code>XChromatograms</code> object: <em>point character</em> to
be used to label the apex position of the chromatographic peak if
<code>peakType = "point"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>silently returns a <code>list</code> (length equal to <code>ncol(object)</code> of
<code>numeric</code> (length equal to <code>nrow(object)</code>) with the y position of
each EIC.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load preprocessed data and extract EICs for some features.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadXcmsData.html">loadXcmsData</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Update the path to the files for the local system</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dirname.html">dirname</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf"</span>, <span class="st">"KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf"</span>, <span class="st">"WT"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (classes, fdef, mtable) {    methods &lt;- .findInheritedMethods(classes, fdef, mtable)    if (length(methods) == 1L)         return(methods[[1L]])    else if (length(methods) == 0L) {        cnames &lt;- paste0("\"", vapply(classes, as.character,             ""), "\"", collapse = ", ")        stop(gettextf("unable to find an inherited method for function %s for signature %s",             sQuote(fdef@generic), sQuote(cnames)), domain = NA)    }    else stop("Internal error in finding inherited methods; didn't return a unique method",         domain = NA)})(list(structure("XcmsExperiment", package = "xcms")), new("standardGeneric",     .Data = function (object, ...)     standardGeneric("path"), generic = structure("path", package = "BiocGenerics"),     package = "BiocGenerics", group = list(), valueClass = character(0),     signature = "object", default = NULL, skeleton = (function (object,         ...)     stop(gettextf("invalid call in method dispatch to '%s' (no default method)",         "path"), domain = NA))(object, ...)), &lt;environment&gt;):</span> unable to find an inherited method for function ‘path’ for signature ‘"XcmsExperiment"’</span>
<span class="r-in"><span><span class="co">## Subset to the first 3 files.</span></span></span>
<span class="r-in"><span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/MSnExp-class.html" class="external-link">filterFile</a></span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, keepFeatures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define features for which to extract EICs</span></span></span>
<span class="r-in"><span><span class="va">fts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FT097"</span>, <span class="st">"FT163"</span>, <span class="st">"FT165"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="featureChromatograms.html">featureChromatograms</a></span><span class="op">(</span><span class="va">xdata</span>, features <span class="op">=</span> <span class="va">fts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot the overlay of EICs in the first sample</span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define a different color for each feature (row in chrs). By default, also</span></span></span>
<span class="r-in"><span><span class="co">## all chromatographic peaks of a feature is labeled in the same color.</span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, we can define a color for each individual chromatographic</span></span></span>
<span class="r-in"><span><span class="co">## peak and provide this with the `peakBg` and `peakCol` parameters.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mz mzmin mzmax       rt    rtmin    rtmax     into     intb  maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP2973 354.1357 354.1 354.2 2789.781 2755.258 2826.270 299005.1       NA  9700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP0312 413.1000 413.1 413.1 3637.671 3614.978 3665.850 879851.5 852195.3 30920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP0089 414.2000 414.2 414.2 3066.457 3038.628 3089.311 234308.5 218923.4  9669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        sn sample row column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP2973 NA      1   1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP0312 34      1   2      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP0089 15      1   3      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use a color for each of the two identified peaks in that sample</span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    peakBg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffff0020"</span>, <span class="st">"#00ffff20"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plotting the data in all samples.</span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Creating a "stacked" EIC plot: the EICs are placed along the y-axis</span></span></span>
<span class="r-in"><span><span class="co">## relative to their m/z value. With `stacked = 1` the y-axis is split in</span></span></span>
<span class="r-in"><span><span class="co">## half, the lower half being used for the stacking of the EICs, the upper</span></span></span>
<span class="r-in"><span><span class="co">## half being used for the *original* intensity axis.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, stacked <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## add horizontal lines for the m/z values of each EIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">res</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"grey"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note that this type of visualization is different than the conventional</span></span></span>
<span class="r-in"><span><span class="co">## plot function for chromatographic data, which will draw the EICs for</span></span></span>
<span class="r-in"><span><span class="co">## multiple samples into the same plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Converting the object to a MChromatograms without detected peaks</span></span></span>
<span class="r-in"><span><span class="va">chrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">chrs</span>, <span class="st">"MChromatograms"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotChromatogramsOverlay</span><span class="op">(</span><span class="va">chrs</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000040"</span>, <span class="st">"#00ff0040"</span>, <span class="st">"#0000ff40"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plotChromatogramsOverlay-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

