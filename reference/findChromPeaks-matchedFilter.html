<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The matchedFilter algorithm identifies peaks in the
    chromatographic time domain as described in [Smith 2006]. The intensity
    values are binned by cutting The LC/MS data into slices (bins) of a mass
    unit (binSize m/z) wide. Within each bin the maximal intensity is
    selected. The chromatographic peak detection is then performed in each
    bin by extending it based on the steps parameter to generate
    slices comprising bins current_bin - steps +1 to
    current_bin + steps - 1. Each of these slices is then filtered
    with matched filtration using a second-derative Gaussian as the model
    peak shape. After filtration peaks are detected using a signal-to-ratio
    cut-off. For more details and illustrations see [Smith 2006].
The MatchedFilterParam class allows to specify all
    settings for a chromatographic peak detection using the matchedFilter
    method. Instances should be created with the MatchedFilterParam
    constructor.
The findChromPeaks,OnDiskMSnExp,MatchedFilterParam
    method performs peak detection using the matchedFilter algorithm
    on all samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
binSize,binSize&amp;lt;-: getter and setter for the
    binSize slot of the object.
impute,impute&amp;lt;-: getter and setter for the
    impute slot of the object.
baseValue,baseValue&amp;lt;-: getter and setter for the
    baseValue slot of the object.
distance,distance&amp;lt;-: getter and setter for the
    distance slot of the object.
fwhm,fwhm&amp;lt;-: getter and setter for the
    fwhm slot of the object.
sigma,sigma&amp;lt;-: getter and setter for the
    sigma slot of the object.
max,max&amp;lt;-: getter and setter for the
     max slot of the object.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
steps,steps&amp;lt;-: getter and setter for the
    steps slot of the object.
mzdiff,mzdiff&amp;lt;-: getter and setter for the
     mzdiff slot of the object.
index,index&amp;lt;-: getter and setter for the
    index slot of the object."><title>Peak detection in the chromatographic time domain — findChromPeaks-matchedFilter • xcms</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Peak detection in the chromatographic time domain — findChromPeaks-matchedFilter"><meta property="og:description" content="The matchedFilter algorithm identifies peaks in the
    chromatographic time domain as described in [Smith 2006]. The intensity
    values are binned by cutting The LC/MS data into slices (bins) of a mass
    unit (binSize m/z) wide. Within each bin the maximal intensity is
    selected. The chromatographic peak detection is then performed in each
    bin by extending it based on the steps parameter to generate
    slices comprising bins current_bin - steps +1 to
    current_bin + steps - 1. Each of these slices is then filtered
    with matched filtration using a second-derative Gaussian as the model
    peak shape. After filtration peaks are detected using a signal-to-ratio
    cut-off. For more details and illustrations see [Smith 2006].
The MatchedFilterParam class allows to specify all
    settings for a chromatographic peak detection using the matchedFilter
    method. Instances should be created with the MatchedFilterParam
    constructor.
The findChromPeaks,OnDiskMSnExp,MatchedFilterParam
    method performs peak detection using the matchedFilter algorithm
    on all samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
binSize,binSize&amp;lt;-: getter and setter for the
    binSize slot of the object.
impute,impute&amp;lt;-: getter and setter for the
    impute slot of the object.
baseValue,baseValue&amp;lt;-: getter and setter for the
    baseValue slot of the object.
distance,distance&amp;lt;-: getter and setter for the
    distance slot of the object.
fwhm,fwhm&amp;lt;-: getter and setter for the
    fwhm slot of the object.
sigma,sigma&amp;lt;-: getter and setter for the
    sigma slot of the object.
max,max&amp;lt;-: getter and setter for the
     max slot of the object.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
steps,steps&amp;lt;-: getter and setter for the
    steps slot of the object.
mzdiff,mzdiff&amp;lt;-: getter and setter for the
     mzdiff slot of the object.
index,index&amp;lt;-: getter and setter for the
    index slot of the object."><meta property="og:image" content="https://sneumann.github.io/xcms/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/xcms.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    <a class="dropdown-item" href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    <a class="dropdown-item" href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sneumann/xcms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Peak detection in the chromatographic time domain</h1>
      <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/DataClasses.R" class="external-link"><code>R/DataClasses.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-Params.R" class="external-link"><code>R/functions-Params.R</code></a>, <a href="https://github.com/sneumann/xcms/blob/HEAD/R/methods-OnDiskMSnExp.R" class="external-link"><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>findChromPeaks-matchedFilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <em>matchedFilter</em> algorithm identifies peaks in the
    chromatographic time domain as described in [Smith 2006]. The intensity
    values are binned by cutting The LC/MS data into slices (bins) of a mass
    unit (<code>binSize</code> m/z) wide. Within each bin the maximal intensity is
    selected. The chromatographic peak detection is then performed in each
    bin by extending it based on the <code>steps</code> parameter to generate
    slices comprising bins <code>current_bin - steps +1</code> to
    <code>current_bin + steps - 1</code>. Each of these slices is then filtered
    with matched filtration using a second-derative Gaussian as the model
    peak shape. After filtration peaks are detected using a signal-to-ratio
    cut-off. For more details and illustrations see [Smith 2006].</p>
<p>The <code>MatchedFilterParam</code> class allows to specify all
    settings for a chromatographic peak detection using the matchedFilter
    method. Instances should be created with the <code>MatchedFilterParam</code>
    constructor.</p>
<p>The <code>findChromPeaks,OnDiskMSnExp,MatchedFilterParam</code>
    method performs peak detection using the <em>matchedFilter</em> algorithm
    on all samples from an <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> object.
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.</p>
<p><code>binSize</code>,<code>binSize&lt;-</code>: getter and setter for the
    <code>binSize</code> slot of the object.</p>
<p><code>impute</code>,<code>impute&lt;-</code>: getter and setter for the
    <code>impute</code> slot of the object.</p>
<p><code>baseValue</code>,<code>baseValue&lt;-</code>: getter and setter for the
    <code>baseValue</code> slot of the object.</p>
<p><code>distance</code>,<code>distance&lt;-</code>: getter and setter for the
    <code>distance</code> slot of the object.</p>
<p><code>fwhm</code>,<code>fwhm&lt;-</code>: getter and setter for the
    <code>fwhm</code> slot of the object.</p>
<p><code>sigma</code>,<code>sigma&lt;-</code>: getter and setter for the
    <code>sigma</code> slot of the object.</p>
<p><code>max</code>,<code>max&lt;-</code>: getter and setter for the
     <code>max</code> slot of the object.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>steps</code>,<code>steps&lt;-</code>: getter and setter for the
    <code>steps</code> slot of the object.</p>
<p><code>mzdiff</code>,<code>mzdiff&lt;-</code>: getter and setter for the
     <code>mzdiff</code> slot of the object.</p>
<p><code>index</code>,<code>index&lt;-</code>: getter and setter for the
    <code>index</code> slot of the object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MatchedFilterParam</span><span class="op">(</span></span>
<span>  binSize <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  impute <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  baseValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fwhm <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">fwhm</span><span class="op">/</span><span class="fl">2.3548</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  snthresh <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mzdiff <span class="op">=</span> <span class="fl">0.8</span> <span class="op">-</span> <span class="va">binSize</span> <span class="op">*</span> <span class="va">steps</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OnDiskMSnExp,MatchedFilterParam</span></span>
<span><span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return.type <span class="op">=</span> <span class="st">"XCMSnExp"</span>,</span>
<span>  msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">binSize</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">binSize</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">impute</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">impute</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">baseValue</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">baseValue</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">distance</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">distance</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">fwhm</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">fwhm</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">sigma</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">sigma</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">steps</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">steps</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">mzdiff</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu"><a href="findChromPeaks-centWave.html">mzdiff</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">index</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MatchedFilterParam</span></span>
<span><span class="fu">index</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>binSize</dt>
<dd><p><code>numeric(1)</code> specifying the width of the
bins/slices in m/z dimension.</p></dd>


<dt>impute</dt>
<dd><p>Character string specifying the method to be used for missing
value imputation. Allowed values are <code>"none"</code> (no linear
interpolation), <code>"lin"</code> (linear interpolation), <code>"linbase"</code>
(linear interpolation within a certain bin-neighborhood) and
<code>"intlin"</code>. See <code><a href="imputeLinInterpol.html">imputeLinInterpol</a></code> for more details.</p></dd>


<dt>baseValue</dt>
<dd><p>The base value to which empty elements should be set. This
is only considered for <code>method = "linbase"</code> and corresponds to the
<code>profBinLinBase</code>'s <code>baselevel</code> argument.</p></dd>


<dt>distance</dt>
<dd><p>For <code>method = "linbase"</code>: number of non-empty
neighboring element of an empty element that should be considered for
linear interpolation. See details section for more information.</p></dd>


<dt>fwhm</dt>
<dd><p><code>numeric(1)</code> specifying the full width at half maximum
of matched filtration gaussian model peak. Only used to calculate the
actual sigma, see below.</p></dd>


<dt>sigma</dt>
<dd><p><code>numeric(1)</code> specifying the standard deviation (width)
of the matched filtration model peak.</p></dd>


<dt>max</dt>
<dd><p><code>numeric(1)</code> representing the maximum number of peaks
that are expected/will be identified per slice.</p></dd>


<dt>snthresh</dt>
<dd><p><code>numeric(1)</code> defining the signal to noise cutoff
to be used in the chromatographic peak detection step.</p></dd>


<dt>steps</dt>
<dd><p><code>numeric(1)</code> defining the number of bins to be
merged before filtration (i.e. the number of neighboring bins that will
be joined to the slice in which filtration and peak detection will be
performed).</p></dd>


<dt>mzdiff</dt>
<dd><p><code>numeric(1)</code> defining the minimum difference
in m/z for peaks with overlapping retention times</p></dd>


<dt>index</dt>
<dd><p><code>logical(1)</code> specifying whether indicies should be
returned instead of values for m/z and retention times.</p></dd>


<dt>object</dt>
<dd><p>For <code>findChromPeaks</code>: an
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></dd>


<dt>param</dt>
<dd><p>An <code>MatchedFilterParam</code> object containing all settings for
the matchedFilter algorithm.</p></dd>


<dt>BPPARAM</dt>
<dd><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></dd>


<dt>return.type</dt>
<dd><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></dd>


<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></dd>


<dt>...</dt>
<dd><p>ignored.</p></dd>


<dt>value</dt>
<dd><p>The value for the slot.</p></dd>


<dt>x</dt>
<dd><p>For <code>max</code>: a <code>MatchedFilterParam</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>MatchedFilterParam</code> function returns a</p>
<p></p>
<p><code>MatchedFilterParam</code> class instance with all of the settings
    specified for chromatographic detection by the <em>matchedFilter</em></p>


<p>method.</p>


<p>For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an</p>
<p></p>
<p><code><a href="XCMSnExp-class.html">XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href="xcmsSet-class.html">xcmsSet</a></code> object
    with the results of the peak detection.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The intensities are binned by the provided m/z values within each
    spectrum (scan). Binning is performed such that the bins are centered
    around the m/z values (i.e. the first bin includes all m/z values between
    <code>min(mz) - bin_size/2</code> and <code>min(mz) + bin_size/2</code>).</p>
<p>For more details on binning and missing value imputation see
    <code><a href="binYonX.html">binYonX</a></code> and <code><a href="imputeLinInterpol.html">imputeLinInterpol</a></code> methods.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></code> method from the <code>BiocParallel</code>
    package.</p>
    </div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>
    

<dl><dt><code>binSize,impute,baseValue,distance,fwhm,sigma,max,snthresh,steps,mzdiff,index</code></dt>
<dd><p>See corresponding parameter above. Slots values should exclusively
be accessed <em>via</em> the corresponding getter and setter methods listed
above.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href="findPeaks-methods.html">findPeaks</a></code> methods. It supports chromatographic peak
    detection on
    <code><a href="https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html" class="external-link">OnDiskMSnExp</a></code> objects (defined in the
    <code>MSnbase</code> package). All of the settings to the matchedFilter
    algorithm can be passed with a <code>MatchedFilterParam</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
<em>Anal. Chem.</em> 2006, 78:779-787.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The <code><a href="do_findChromPeaks_matchedFilter.html">do_findChromPeaks_matchedFilter</a></code> core API function
and <code><a href="findPeaks.matchedFilter-xcmsRaw-method.html">findPeaks.matchedFilter</a></code> for the old user interface.</p>
<p><code><a href="peaksWithMatchedFilter.html">peaksWithMatchedFilter</a></code> for functions to perform matchedFilter
peak detection in purely chromatographic data.</p>
<p><code><a href="XCMSnExp-class.html">XCMSnExp</a></code> for the object containing the results of
    the chromatographic peak detection.</p>
<p>Other peak detection methods: 
<code><a href="findChromPeaks-centWaveWithPredIsoROIs.html">findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href="findChromPeaks-centWave.html">findChromPeaks-centWave</a></code>,
<code><a href="findChromPeaks-massifquant.html">findChromPeaks-massifquant</a></code>,
<code><a href="findChromPeaks.html">findChromPeaks</a>()</code>,
<code><a href="findPeaks-MSW.html">findPeaks-MSW</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Colin A Smith, Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a MatchedFilterParam object. Note that we use a unnecessarily large</span></span></span>
<span class="r-in"><span><span class="co">## binSize parameter to reduce the run-time of the example.</span></span></span>
<span class="r-in"><span><span class="va">mfp</span> <span class="op">&lt;-</span> <span class="fu">MatchedFilterParam</span><span class="op">(</span>binSize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Change snthresh parameter</span></span></span>
<span class="r-in"><span><span class="fu"><a href="findChromPeaks-centWave.html">snthresh</a></span><span class="op">(</span><span class="va">mfp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">mfp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class:  MatchedFilterParam </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - binSize: [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - impute: [1] "none"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - baseValue: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - fwhm: [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sigma: [1] 12.73994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - max: [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - snthresh: [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - steps: [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - mzdiff: [1] -9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - index: [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform the peak detection using matchecFilter on the files from the</span></span></span>
<span class="r-in"><span><span class="co">## faahKO package. Files are read using the readMSData from the MSnbase</span></span></span>
<span class="r-in"><span><span class="co">## package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lgatto.github.io/MSnbase" class="external-link">MSnbase</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf/KO"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span><span class="va">fls</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span>
<span class="r-in"><span><span class="co">## Perform the chromatographic peak detection using the settings defined</span></span></span>
<span class="r-in"><span><span class="co">## above. Note that we are also disabling parallel processing in this</span></span></span>
<span class="r-in"><span><span class="co">## example by registering a "SerialParam"</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="findChromPeaks.html">findChromPeaks</a></span><span class="op">(</span><span class="va">raw_data</span>, param <span class="op">=</span> <span class="va">mfp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="XCMSnExp-class.html">chromPeaks</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             mz mzmin mzmax       rt    rtmin    rtmax      into    intf  maxo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3580020 84280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3577971 84280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510 49728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510 49728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005 244.1000 244.1 244.1 2828.453 2814.369 2842.538  598990.3 1145078 31312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 249.1591 249.1 249.2 3659.444 3643.794 3678.223 1435000.7 2367467 49040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            maxf i       sn sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP001 194233.12 1 63.28090      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP002 194213.46 1 66.00099      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP003  96022.23 1 25.42409      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP004  96022.23 1 25.42643      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP005  64181.64 2 16.99513      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP006 104291.09 1 36.83500      1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colin A. Smith, Ralf Tautenhahn, Steffen Neumann, Paul Benton, Christopher Conley, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

