% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Spectra.R, R/Spectra-methods.R
\docType{methods}
\name{Spectra}
\alias{Spectra}
\alias{Spectra-class}
\alias{show,Spectra-method}
\alias{mz,Spectra-method}
\alias{intensity,Spectra-method}
\alias{rtime,Spectra-method}
\alias{precursorMz,Spectra-method}
\alias{precursorCharge,Spectra-method}
\alias{precScanNum,Spectra-method}
\alias{precursorIntensity,Spectra-method}
\alias{acquisitionNum,Spectra-method}
\alias{scanIndex,Spectra-method}
\alias{peaksCount,Spectra,ANY-method}
\alias{msLevel,Spectra-method}
\alias{tic,Spectra-method}
\alias{ionCount,Spectra-method}
\alias{collisionEnergy,Spectra-method}
\alias{fromFile,Spectra-method}
\alias{polarity,Spectra-method}
\alias{smoothed,Spectra-method}
\alias{isEmpty,Spectra-method}
\alias{centroided,Spectra-method}
\alias{isCentroided,Spectra-method}
\alias{writeMgfData,Spectra-method}
\title{List of Spectrum objects along with annotations}
\usage{
Spectra(..., elementMetadata = NULL)

\S4method{mz}{Spectra}(object)

\S4method{intensity}{Spectra}(object)

\S4method{rtime}{Spectra}(object)

\S4method{precursorMz}{Spectra}(object)

\S4method{precursorCharge}{Spectra}(object)

\S4method{precScanNum}{Spectra}(object)

\S4method{precursorIntensity}{Spectra}(object)

\S4method{acquisitionNum}{Spectra}(object)

\S4method{scanIndex}{Spectra}(object)

\S4method{peaksCount}{Spectra,ANY}(object)

\S4method{msLevel}{Spectra}(object)

\S4method{tic}{Spectra}(object)

\S4method{ionCount}{Spectra}(object)

\S4method{collisionEnergy}{Spectra}(object)

\S4method{fromFile}{Spectra}(object)

\S4method{polarity}{Spectra}(object)

\S4method{smoothed}{Spectra}(object)

\S4method{isEmpty}{Spectra}(x)

\S4method{centroided}{Spectra}(object)

\S4method{isCentroided}{Spectra}(object)

\S4method{writeMgfData}{Spectra}(object, con = "spectra.mgf",
  COM = NULL, TITLE = NULL)
}
\arguments{
\item{...}{For \code{Spectra}: \linkS4class{Spectrum} object(s) or a \code{list} of
\linkS4class{Spectrum} objects.}

\item{elementMetadata}{For \code{Spectra}: \link{DataFrame} with optional information
that should be added as metadata information (\code{mcols}) to the object.
The number of rows has to match the number of \linkS4class{Spectrum} objects,
each row is expected to represent additional metadata information for
one spectrum.}

\item{object}{For all functions: a \code{Spectra} object.}

\item{x}{For all functions: a \code{Spectra} object.}

\item{con}{For \code{writeMgfData}: \code{character(1)} defining the file name of
the MGF file.}

\item{COM}{For \code{writeMgfData}: optional \code{character(1)} providing a comment
to be added to the file.}

\item{TITLE}{For \code{writeMgfData}: optional \code{character(1)} defining the title
for the MGF file.}
}
\description{
\code{Spectra} objects allow to collect one or more \linkS4class{Spectrum} object(s)
(\linkS4class{Spectrum1} or \linkS4class{Spectrum2}) in a \code{list}-like structure with
the possibility to add arbitrary annotations to each individual
\code{Spectrum} object. These can be accessed/set with the \code{\link[=mcols]{mcols()}} method.

Functions to access the individual spectra's attributes are available
(listed below).

\code{writeMgfData} exports a \code{Spectra} object to a file in MGF format. All
metadata columns present in \code{mcols} are exported as additional fields with
the capitalized column names used as field names (see examples below).
}
\details{
\code{Spectra} inherits all methods from the \link{SimpleList} class of the
\code{S4Vectors} package. This includes \code{lapply} and other data manipulation
and subsetting operations.
}
\section{Constructor}{


New \link{Spectra} can be created with the \code{Spectra(...)} function
where \code{...} can either be a single \linkS4class{Spectrum} object or a \code{list} of
\code{Spectrum} objects (\linkS4class{Spectrum1} and/or \linkS4class{Spectrum2}).
}

\section{Accessing spectrum attributes}{


These methods allow to access the attributes and values of the individual
\code{Spectrum} (\linkS4class{Spectrum1} or \linkS4class{Spectrum2}) objects within the list.
\itemize{
\item \code{mz} return the m/z values of each spectrum as a \code{list} of \code{numeric}
vectors.
\item \code{intensity} return the intensity values of each spectrum as a \code{list} of
\code{numeric} vectors.
\item \code{rtime} return the retention time of each spectrum as a \code{numeric} vector
with length equal to the length of \code{object}.
\item \code{precursorMz}, \code{precursorCharge}, \code{precursorIntensity}, \code{precScanNum}
return precursor m/z values, charge, intensity and scan number for each
spectrum as a \code{numeric} (or \code{integer}) vector with length equal to the
length of \code{object}. Note that for \linkS4class{Spectrum1} objects \code{NA} will be
returned.
\item \code{acquisitionNum} and \code{scanIndex} return the acquisition number of each
spectrum and its scan index as an \code{integer} vector with the same length
than \code{object}.
\item \code{ionCount} and \code{tic} return the ion count and total ion current of each
spectrum.
\item \code{peaksCount} returns the number of peaks for each spectrum as a \code{integer}
vector.
\item \code{msLevel} returns the MS level of each spectrum.
\item \code{collisionEnergy} returns the collision energy for each spectrum or \code{NA}
for \linkS4class{Spectrum1} objects.
\item \code{polarity} returns the spectra's polarity.
\item \code{fromFile} returns the index from the (e.g. mzML) file the spectra where
from. This applies only for spectra read using the \code{\link[=readMSData]{readMSData()}} function.
\item \code{smoothed} whether spectra have been smoothed (i.e. processed with the
\code{\link[=smooth]{smooth()}} method. Returns a \code{logical} of length equal to the
number of spectra.
\item \code{isEmpty} returns \code{TRUE} for spectra without peak data.
\item \code{centroided}, \code{isCentroided} returns for each spectrum whether it contains
\emph{centroided} data. While \code{centroided} returns the internal attribute of
each spectrum, \code{isCentroided} tries to guess whether spectra are
centroided from the actual peak data.
}
}

\examples{

## Create from Spectrum objects
sp1 <- new("Spectrum1", mz = c(1, 2, 4), intensity = c(4, 5, 2))
sp2 <- new("Spectrum2", mz = c(1, 2, 3, 4), intensity = c(5, 3, 2, 5),
    precursorMz = 2)

spl <- Spectra(sp1, sp2)
spl
spl[[1]]

## Add also metadata columns
mcols(spl)$id <- c("a", "b")
mcols(spl)

## Create a Spectra with metadata
spl <- Spectra(sp1, sp2, elementMetadata = DataFrame(id = c("a", "b")))

mcols(spl)
mcols(spl)$id

## Extract the mz values for the individual spectra
mz(spl)

## Extract the intensity values for the individual spectra
intensity(spl)

## Extract the retention time values for the individual spectra
rtime(spl)

## Extract the precursor m/z of each spectrum.
precursorMz(spl)

## Extract the precursor charge of each spectrum.
precursorCharge(spl)

## Extract the precursor scan number for each spectrum.
precScanNum(spl)

## Extract the precursor intensity of each spectrum.
precursorIntensity(spl)

## Extract the acquisition number of each spectrum.
acquisitionNum(spl)

## Extract the scan index of each spectrum.
scanIndex(spl)

## Get the number of peaks per spectrum.
peaksCount(spl)

## Get the MS level of each spectrum.
msLevel(spl)

## Get the total ion current for each spectrum.
tic(spl)

## Get the total ion current for each spectrum.
ionCount(spl)

## Extract the collision energy for spectrum.
collisionEnergy(spl)

## Extract the file index for the spectrum.
fromFile(spl)

## Get the polarity for each spectrum.
polarity(spl)

## Whether spectra are smoothed (i.e. processed with the `MSnbase::smooth`
## function.
smoothed(spl)

## Are spectra empty (i.e. contain no peak data)?
isEmpty(spl)

## Do the spectra contain centroided data?
centroided(spl)

## Do the spectra contain centroided data? Whether spectra are centroided
## is estimated from the peak data.
isCentroided(spl)

## Export the spectrum list to a MGF file. Values in metadata columns are
## exported as additional field for each spectrum.
tmpf <- tempfile()
writeMgfData(spl, tmpf)

## Evaluate the written output. The ID of each spectrum (defined in the
## "id" metadata column) is exported as field "ID".
readLines(tmpf)

## Set mcols to NULL to avoid export of additional data fields.
mcols(spl) <- NULL
file.remove(tmpf)

writeMgfData(spl, tmpf)
readLines(tmpf)
}
\author{
Johannes Rainer
}
